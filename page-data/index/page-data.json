{"componentChunkName":"component---theme-src-templates-posts-tsx","path":"/","result":{"pageContext":{"posts":[{"id":"39aa38f5-4dad-51bc-8751-8eb1dba4dcd9","headings":[{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3}],"frontmatter":{"title":"移动端适配方案","path":"/css-adaptation","tags":["CSS"],"excerpt":"目前所知的三种移动端适配方案：1.viewport, 2.动态rem, 3.vw方案","created":"2021-10-24 21:04","createdPretty":"24 October, 2021","updated":"2021-10-25 21:09","updatedPretty":"24 October, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgAB/9oADAMBAAIQAxAAAAHMQ2DG06z/xAAaEAEAAwADAAAAAAAAAAAAAAABAAIRAxIT/9oACAEBAAEFAugzyqLxXGrHV1J//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8BR//EABURAQEAAAAAAAAAAAAAAAAAAAAS/9oACAECAQE/AVP/xAAaEAACAgMAAAAAAAAAAAAAAAAAARARITEy/9oACAEBAAY/AtuObhZKP//EABsQAQADAQADAAAAAAAAAAAAAAEAETEhcYGx/9oACAEBAAE/IeL4RDtR0ElS9hFunt98QLOCslQDhP/aAAwDAQACAAMAAAAQEz//xAAWEQEBAQAAAAAAAAAAAAAAAAABADH/2gAIAQMBAT8QMkt//8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAgEBPxBcYZy//8QAGxABAQEAAwEBAAAAAAAAAAAAAREAITFh0fD/2gAIAQEAAT8QX3xQUP51ikFFbpxJKKInjjK8oV5yi7oPY++6DEgKV3//2Q==","aspectRatio":1.5060240963855422,"src":"/static/6c3a32bd864e06026a5a3e8a94846a4b/ba9ae/header.jpg","srcSet":"/static/6c3a32bd864e06026a5a3e8a94846a4b/86d0f/header.jpg 125w,\n/static/6c3a32bd864e06026a5a3e8a94846a4b/520da/header.jpg 250w,\n/static/6c3a32bd864e06026a5a3e8a94846a4b/ba9ae/header.jpg 500w,\n/static/6c3a32bd864e06026a5a3e8a94846a4b/72227/header.jpg 750w,\n/static/6c3a32bd864e06026a5a3e8a94846a4b/5c39c/header.jpg 1000w,\n/static/6c3a32bd864e06026a5a3e8a94846a4b/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<p>设计师交付给前端开发一张宽度为 750px 的视觉稿，设计稿上元素的尺寸、颜色、位置等已做过标注，要求工程师工在适配不同屏幕尺寸的设备时采用<code class=\"language-text\">等比缩放</code>的方案。</p>\n<h2 id=\"viewport-方案\" style=\"position:relative;\"><a href=\"#viewport-%E6%96%B9%E6%A1%88\" aria-label=\"viewport 方案 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>viewport 方案</h2>\n<h3 id=\"原理\" style=\"position:relative;\"><a href=\"#%E5%8E%9F%E7%90%86\" aria-label=\"原理 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>原理</h3>\n<p>在写 HTML、CSS 设计稿进行还原时不关注屏幕尺寸的差异，而是直接按设计稿的标志来开发。比如有设计稿里的文字 font-size=30px,CSSk 里就设置文字 font-size=30px</p>\n<p>页面开发好后，在 HTML 的 head 标签里加入 <code class=\"language-text\">&lt;meta name=&quot;viewport&quot; content=&quot;width={设计稿宽度}, initial-scale={屏幕逻辑像素宽度/设计稿宽度}&quot; &gt; 。</code></p>\n<p>举个例子。假设设计师交付的设计稿宽度是 750px，设计稿上一个标题字号标注的是 32px 、margin 是 20px。我们以标注的大小来写 CSS。之后需要通过 JavaScript 计算获取屏幕的宽度（假设需要适配逻辑像素宽度是 428px 的屏幕），在 HTML 的 head 里添加 <meta name=\"viewport\" content=\"width=750px, initial-scale=0.57\" > 即可（428/759 = 0.57）。</p>\n<p>这段代码的意思是：设置布局视口(layout viewport)的宽度为 750px（此时页面一般会超出屏幕），再缩放页面（initial-scale）使其恰好撑满屏幕。</p>\n<h3 id=\"适配代码\" style=\"position:relative;\"><a href=\"#%E9%80%82%E9%85%8D%E4%BB%A3%E7%A0%81\" aria-label=\"适配代码 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>适配代码</h3>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n      <span class=\"token keyword\">const</span> <span class=\"token constant\">WIDTH</span> <span class=\"token operator\">=</span> <span class=\"token number\">750</span>\n      <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">mobileAdapter</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> scale <span class=\"token operator\">=</span> screen<span class=\"token punctuation\">.</span>width <span class=\"token operator\">/</span> <span class=\"token constant\">WIDTH</span>\n        <span class=\"token keyword\">let</span> content <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">width=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">WIDTH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, initial-scale=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>scale<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, maximum-scale=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>scale<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, minimum-scale=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>scale<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token keyword\">let</span> meta <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"meta[name=viewport]\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>meta<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          meta <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"meta\"</span><span class=\"token punctuation\">)</span>\n          meta<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"viewport\"</span><span class=\"token punctuation\">)</span>\n          document<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>meta<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        meta<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"content\"</span><span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">mobileAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      window<span class=\"token punctuation\">.</span>onorientationchange <span class=\"token operator\">=</span> mobileAdapter\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token style-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token style language-css\"><span class=\"token property\">border</span><span class=\"token punctuation\">:</span>2px solid black<span class=\"token punctuation\">;</span><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 500px<span class=\"token punctuation\">;</span><span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 20px<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span>\n      hello pipihua!\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h3 id=\"优点与缺点\" style=\"position:relative;\"><a href=\"#%E4%BC%98%E7%82%B9%E4%B8%8E%E7%BC%BA%E7%82%B9\" aria-label=\"优点与缺点 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>优点与缺点</h3>\n<ul>\n<li>优点：开发流程很简单，工程师只需根据设计稿标注还原页面，不需要额外计算。适配范围广。</li>\n<li>缺点：页面整体放大缩小，对于不想缩放的元素无法控制。比如边框在大屏手机下显得很粗，在小屏手机下显得很细（下图所示）。</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3f37eaa3c00cf25ed4c0f844fb84bb79/80e3c/iphone6.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3KFB/8QAFRABAQAAAAAAAAAAAAAAAAAAARD/2gAIAQEAAQUCb//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABcQAQEBAQAAAAAAAAAAAAAAAAEAETH/2gAIAQEAAT8h6ICy/9oADAMBAAIAAwAAABCAD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABgQAQEBAQEAAAAAAAAAAAAAAAEAESFR/9oACAEBAAE/EAHCQOm2PL//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"iphone6\"\n        title=\"iphone6\"\n        src=\"/static/3f37eaa3c00cf25ed4c0f844fb84bb79/80e3c/iphone6.jpg\"\n        srcset=\"/static/3f37eaa3c00cf25ed4c0f844fb84bb79/f93b5/iphone6.jpg 300w,\n/static/3f37eaa3c00cf25ed4c0f844fb84bb79/b4294/iphone6.jpg 600w,\n/static/3f37eaa3c00cf25ed4c0f844fb84bb79/80e3c/iphone6.jpg 720w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 693px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/75e060bfe9cfe3a98271ce596c66b05f/fd3c9/ipad.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3aAH/8QAFhABAQEAAAAAAAAAAAAAAAAAEQAQ/9oACAEBAAEFAiM//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFRABAQAAAAAAAAAAAAAAAAAAABH/2gAIAQEAAT8hIR//2gAMAwEAAgADAAAAEIAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRABAQEBAQEAAAAAAAAAAAAAAREAcSEx/9oACAEBAAE/EIWq8xT2vci/N//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ipad\"\n        title=\"ipad\"\n        src=\"/static/75e060bfe9cfe3a98271ce596c66b05f/fd3c9/ipad.jpg\"\n        srcset=\"/static/75e060bfe9cfe3a98271ce596c66b05f/f93b5/ipad.jpg 300w,\n/static/75e060bfe9cfe3a98271ce596c66b05f/b4294/ipad.jpg 600w,\n/static/75e060bfe9cfe3a98271ce596c66b05f/fd3c9/ipad.jpg 693w\"\n        sizes=\"(max-width: 693px) 100vw, 693px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>我们更需要一种既能整体缩放，又能个性化控制某些元素不缩放的方案。</p>\n<h2 id=\"rem-方案\" style=\"position:relative;\"><a href=\"#rem-%E6%96%B9%E6%A1%88\" aria-label=\"rem 方案 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>rem 方案</h2>\n<h3 id=\"原理-1\" style=\"position:relative;\"><a href=\"#%E5%8E%9F%E7%90%86-1\" aria-label=\"原理 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>原理</h3>\n<p>在使用单位控制页面元素大小时，可以使用固定单位 px，也可以使用相对单位 rem。2rem 等于 html 标签 font-size 的 2 倍。基于这个原理，对于需要适配屏幕等比缩放的元素可以选用 rem 作为单位，对于不需要等比缩放的元素依旧使用 px 作为单位。只要调整 html 标签的 font-size，就能让所有使用 rem 单位的元素跟随着发生变化，而使用 px 单位的元素不受影响。问题的关键在于如何根据屏幕尺寸跳转 html 标签的 font-size。</p>\n<p>举个实际的例子。设计师交付的设计稿宽度是 750px，设计稿上一个 div 的标注尺寸是 375px（宽度是设计稿宽度的一半）。我们可以</p>\n<p>设置 html 的 font-size 为 100*屏幕宽度/设计稿宽度\n在写 CSS 时设置 div 的宽度是 3.75rem （计算时用设计稿标注值除以 100），边框宽度为 1px\n假设用户在逻辑像素宽度是 375px 的设备上打开页面，则 html 的 font-size 是 100 * 375/750 = 50px，div 的宽度是 3.75rem ，即 187.5px 正好是屏幕宽度的一半。</p>\n<p>假设用户在逻辑像素宽度是 428px 的设备上打开页面，则 html 的 font-size 是 100 * 428/750 = 57.07px，div 的宽度是 3.75rem ，即 214px 正好是屏幕宽度的一半。</p>\n<p>为什么要用 100 来乘以屏幕宽度/设计稿宽度？其实 100 只是随便选取的一个值，我们也可以随便其他任意值比如 50。如果选 100，设计稿中某个元素标注的尺寸是 375px，我们可以很快速的计算出 3.75rem。如果 html 的 font-size 设置为 50*屏幕宽度/设计稿宽度，那么 div 的宽度就应该是 7.5rem 了。换算起来就没那么直观了。</p>\n<h3 id=\"适配代码-1\" style=\"position:relative;\"><a href=\"#%E9%80%82%E9%85%8D%E4%BB%A3%E7%A0%81-1\" aria-label=\"适配代码 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>适配代码</h3>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span>\n      <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, \n    initial-scale=1, maximum-scale=1, minimum-scale=1<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n      <span class=\"token keyword\">const</span> <span class=\"token constant\">WIDTH</span> <span class=\"token operator\">=</span> <span class=\"token number\">750</span> <span class=\"token comment\">//如果是尺寸的设计稿在这里修改</span>\n      <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">setView</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//设置html标签的fontSize</span>\n        document<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>fontSize <span class=\"token operator\">=</span>\n          <span class=\"token punctuation\">(</span><span class=\"token number\">100</span> <span class=\"token operator\">*</span> screen<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token constant\">WIDTH</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"px\"</span>\n      <span class=\"token punctuation\">}</span>\n      window<span class=\"token punctuation\">.</span>onorientationchange <span class=\"token operator\">=</span> setView\n      <span class=\"token function\">setView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n      <span class=\"token selector\">div</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 3.75rem<span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 需要随屏幕等比缩放，使用rem单位，比如设计稿中标注的32px这里写成0.32rem */</span>\n        <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> 1px solid #ccc<span class=\"token punctuation\">;</span> <span class=\"token comment\">/*不需要缩放的部分用px*/</span>\n      <span class=\"token punctuation\">}</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>hello pipihua!<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h3 id=\"优缺点\" style=\"position:relative;\"><a href=\"#%E4%BC%98%E7%BC%BA%E7%82%B9\" aria-label=\"优缺点 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>优缺点</h3>\n<ul>\n<li>优点：动态 Rem 方案既能实现页面级整体缩放，又能个性化控制某些元素不缩放</li>\n<li>缺点：需要 JavaScript 实现动态 Rem 方案</li>\n</ul>\n<h2 id=\"vw-方案\" style=\"position:relative;\"><a href=\"#vw-%E6%96%B9%E6%A1%88\" aria-label=\"vw 方案 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>vw 方案</h2>\n<h3 id=\"原理-2\" style=\"position:relative;\"><a href=\"#%E5%8E%9F%E7%90%86-2\" aria-label=\"原理 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>原理</h3>\n<p>vw 是相对单位，1vw 表示屏幕宽度的 1%。基于此，我们可以把所有需要适配屏幕大小等比缩放的元素都使用 vw 做为单位。不需要缩放的元素使用 px 做单位。</p>\n<p>举个例子。设计师交付的设计稿宽度是 750px，设计稿上一个标题的 fontSize 标注尺寸是 32px。(32/750)*100% = 4.27% ，换句话说这个标题的字号占屏幕宽度的占比是 4.27%，不管任何屏幕都是如此。4.27% 即 4.27vw。</p>\n<p>对于任何需要等比缩放的元素，在写 CSS 设置样式时直接换算成 vw 即可，尺寸 = 100vw*设计稿标注大小/设计稿宽度。</p>\n<h3 id=\"适配代码-2\" style=\"position:relative;\"><a href=\"#%E9%80%82%E9%85%8D%E4%BB%A3%E7%A0%81-2\" aria-label=\"适配代码 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>适配代码</h3>\n<p>假设设计稿尺寸是 750px，页面有一个按钮，按钮文字标注大小 28px，按钮高度标注为 48px，宽度为 120px，边框为 1px 不缩放。</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n      <span class=\"token selector\">.button</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 16vw<span class=\"token punctuation\">;</span> <span class=\"token comment\">/*  100vw*120/750  */</span>\n        <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 3.73vw<span class=\"token punctuation\">;</span> <span class=\"token comment\">/*  100vw*28/750  */</span>\n        <span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> 6.4vw<span class=\"token punctuation\">;</span> <span class=\"token comment\">/*  100vw*48/750  */</span>\n        <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> 1px solid #000<span class=\"token punctuation\">;</span> <span class=\"token comment\">/*不需要缩放的部分用px*/</span>\n        <span class=\"token property\">text-align</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>hello pipihua!<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>在写样式时会发现，虽然不用写 JS 做适配，但标注尺寸换算为 vw 又麻烦又不直观。</p>\n<p>我们可以在 CSS 里使用 calc 来换算换，只不过需要注意新语法的兼容性。</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">:root</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">--ratio</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>100vw / 750<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.button</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>100vw * 28 / 750<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 可以直接用calc */</span>\n  <span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>100vw * 48 / 750<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">calc</span><span class=\"token punctuation\">(</span>120 * <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--ratio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">/* 也可以用calc配合var使用，IE不支持var */</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> 1px solid #000<span class=\"token punctuation\">;</span> <span class=\"token comment\">/*不需要缩放的部分用px*/</span>\n  <span class=\"token property\">text-align</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>在正式的项目里，我们也可以用 SCSS，把换算交给预处理器</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token keyword\">@function</span> <span class=\"token function\">px2vw</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$px</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">@return</span> <span class=\"token variable\">$px</span> <span class=\"token operator\">*</span> 100vw <span class=\"token operator\">/</span> 750<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.button </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">px2vw</span><span class=\"token punctuation\">(</span>120<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">px2vw</span><span class=\"token punctuation\">(</span>28<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> <span class=\"token function\">px2vw</span><span class=\"token punctuation\">(</span>48<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> 1px solid #000<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">text-align</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"总结\" style=\"position:relative;\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-label=\"总结 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>总结</h2>\n<h3 id=\"viewport-缩放方案\" style=\"position:relative;\"><a href=\"#viewport-%E7%BC%A9%E6%94%BE%E6%96%B9%E6%A1%88\" aria-label=\"viewport 缩放方案 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>viewport 缩放方案</h3>\n<ul>\n<li>\n<p>优点</p>\n<ol>\n<li>适配原理简单</li>\n<li>直接使用设计稿标注无需换算</li>\n</ol>\n</li>\n<li>\n<p>缺点</p>\n<ol>\n<li>需要使用 JS</li>\n<li>方案死板只能实现页面级别整体缩放</li>\n</ol>\n</li>\n</ul>\n<h3 id=\"动态-rem-方案\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%80%81-rem-%E6%96%B9%E6%A1%88\" aria-label=\"动态 rem 方案 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动态 REM 方案</h3>\n<ul>\n<li>\n<p>优点</p>\n<ol>\n<li>设计稿标注的 px 换算到 CSS 的 rem 计算简单</li>\n<li>方案灵活技能实现整体缩放又能实现局部不缩放</li>\n</ol>\n</li>\n<li>\n<p>缺点</p>\n<ol>\n<li>适配原理稍复杂</li>\n<li>方案死板只能实现页面级别整体缩放</li>\n</ol>\n</li>\n</ul>\n<h3 id=\"vw-方案-1\" style=\"position:relative;\"><a href=\"#vw-%E6%96%B9%E6%A1%88-1\" aria-label=\"vw 方案 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>vw 方案</h3>\n<ul>\n<li>\n<p>优点</p>\n<ol>\n<li>适配原理简单</li>\n<li>不需要 JS 即可适配</li>\n<li>方案灵活技能实现整体缩放又能实现局部不缩放</li>\n</ol>\n</li>\n<li>\n<p>缺点</p>\n<ol>\n<li>设计稿标注的 px 换算到 CSS 的 vw 计算复杂</li>\n</ol>\n</li>\n</ul>"},{"id":"1caa43a7-3996-5c93-8fa0-951db70af541","headings":[{"depth":2},{"depth":2}],"frontmatter":{"title":"css尺寸之百分比%","path":"/css-percent","tags":["CSS"],"excerpt":"css尺寸之百分比%","created":"2021-08-22 21:12","createdPretty":"22 August, 2021","updated":"2021-08-22 21:12","updatedPretty":"22 August, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABQACBP/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdEtFh90x//EABsQAAMAAgMAAAAAAAAAAAAAAAABAgMSERMx/9oACAEBAAEFAumcJfrMtaO3yapn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHBAAAQQDAQAAAAAAAAAAAAAAAQACECERInGR/9oACAEBAAY/AmusnKPY19V3H//EABoQAQACAwEAAAAAAAAAAAAAAAEAESExsVH/2gAIAQEAAT8hXIqp5G6HaK25gBSl5ciLtNjJP//aAAwDAQACAAMAAAAQFC//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxAn/8QAHBABAQACAwEBAAAAAAAAAAAAAREAQSExUZGx/9oACAEBAAE/EJtVAYrqA3DiCFPTneV1v1xiu5pKe8ur6YhYdlHP3vOmKao/pn//2Q==","aspectRatio":1.5060240963855422,"src":"/static/2eb9627ce88c46384ca09cd541c51931/ba9ae/header.jpg","srcSet":"/static/2eb9627ce88c46384ca09cd541c51931/86d0f/header.jpg 125w,\n/static/2eb9627ce88c46384ca09cd541c51931/520da/header.jpg 250w,\n/static/2eb9627ce88c46384ca09cd541c51931/ba9ae/header.jpg 500w,\n/static/2eb9627ce88c46384ca09cd541c51931/72227/header.jpg 750w,\n/static/2eb9627ce88c46384ca09cd541c51931/5c39c/header.jpg 1000w,\n/static/2eb9627ce88c46384ca09cd541c51931/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"css-中可以取百分比的属性\" style=\"position:relative;\"><a href=\"#css-%E4%B8%AD%E5%8F%AF%E4%BB%A5%E5%8F%96%E7%99%BE%E5%88%86%E6%AF%94%E7%9A%84%E5%B1%9E%E6%80%A7\" aria-label=\"css 中可以取百分比的属性 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSS 中可以取百分比的属性</h2>\n<ul>\n<li>定位：top, right, bottom, left</li>\n<li>盒模型：width,height, margin,padding</li>\n<li>背景：background-position, background-size</li>\n<li>文本：text-indent</li>\n<li>字体：font-size</li>\n</ul>\n<h2 id=\"百分比是如何计算的\" style=\"position:relative;\"><a href=\"#%E7%99%BE%E5%88%86%E6%AF%94%E6%98%AF%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97%E7%9A%84\" aria-label=\"百分比是如何计算的 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>百分比是如何计算的</h2>\n<blockquote>\n<p>百分比的计算是相对一个基数的，这个基数与当前元素的包含块有关。</p>\n</blockquote>\n<ul>\n<li>基于包含块的宽度来计算的属性：margin, padding, width, max-width,min-width, left, right, text-indent.</li>\n<li>基于包含块的高度来计算的属性：top，bottom，height，max-height，min-height</li>\n<li>基于当前字体大小来计算的属性：line-height</li>\n<li>基于 line-height 来计算的属性：vertical-align</li>\n<li>\n<p>基于元素本身的宽高：</p>\n<ul>\n<li>background-position：背景图像的位置，分别设置水平方向和垂直方向上的两个值，如果使用百分比，那么百分比值会同时应用于元素和图像。例如 50% 50% 会把图片的（50%, 50%）这一点与框的（50%, 50%）处对齐，相当于设置了 center center。同理 0% 0% 相当于 left top，100% 100% 相当于 right bottom</li>\n<li>background-size:100% 100%; 但此值只能应用在块元素上，所设置百分值将使用背景图片大小根据所在元素的宽度和高度的百分比来计算</li>\n<li>顺便说一说 background-size 的另外两个自适应属性：「cover」 会在保持背景图宽高比的状态下填满块的宽和高，「contain」 会在保持背景图的宽高比的状态下尽量填满块的宽或高</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span>\n  <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n    height<span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n    width<span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n    backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span>\n    position<span class=\"token operator\">:</span> <span class=\"token string\">\"relative\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n<span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span>\n    <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n\t  backgroundColor<span class=\"token operator\">:</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">,</span>\n\t  position<span class=\"token operator\">:</span> <span class=\"token string\">\"absolute\"</span><span class=\"token punctuation\">,</span>\n\n      height<span class=\"token operator\">:</span> <span class=\"token string\">\"10%\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 20</span>\n      width<span class=\"token operator\">:</span> <span class=\"token string\">\"10%\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 10</span>\n      top<span class=\"token operator\">:</span> <span class=\"token string\">\"50%\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 100</span>\n      left<span class=\"token operator\">:</span> <span class=\"token string\">\"50%\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 50</span>\n      margin<span class=\"token operator\">:</span> <span class=\"token string\">\"10%\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 10</span>\n      padding<span class=\"token operator\">:</span> <span class=\"token string\">\"10%\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 10,</span>\n\t  backgroundSize<span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token operator\">%</span> <span class=\"token number\">100</span><span class=\"token operator\">%</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//10 20</span>\n      transform<span class=\"token operator\">:</span> <span class=\"token string\">\"translate(-50%,-50%)\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// -15,-20</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n  <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>translate 的值并不是仅仅根据 width 和 height 来进行计算的，还要取决于 border 和 padding 的值。比如这里的 transform:translate(-50%,-50%)，则是基于 padding+width+border 的 50%和高度的 (原理同上)50%进行平移。原因是需要基于元素的左上角进行平移。</p>"},{"id":"e01a5c92-5da7-5c56-9caa-bde6e093cd5e","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"V8的垃圾回收机制和内存限制","path":"/garbage-collection","tags":["JavaScript"],"excerpt":"V8的垃圾回收机制，新生代Scavenge算法，老生代Mark-Sweep & Mark-Compact","created":"2021-08-08 16:33","createdPretty":"08 August, 2021","updated":"2021-08-08 16:33","updatedPretty":"08 August, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUBAwT/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAAB0QqsiWAqD//EABwQAAEEAwEAAAAAAAAAAAAAAAEAAhEUBBIhMf/aAAgBAQABBQK2YtlHMW3GiU73/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8Bqv/EABcQAQEBAQAAAAAAAAAAAAAAAAAyEDH/2gAIAQEABj8ClCd6/8QAGxABAAMAAwEAAAAAAAAAAAAAAQARIUFRgZH/2gAIAQEAAT8hdVfsH6exB0SzqmAJbkn/2gAMAwEAAgADAAAAEGQ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8QtT//xAAdEAEAAgEFAQAAAAAAAAAAAAABABExIUFRYeHw/9oACAEBAAE/EKUW8HmJF6nzaVO12+QHMTcjARDNC5jNQdOZ/9k=","aspectRatio":1.6666666666666667,"src":"/static/a5e3de6178f36e96f4396812c635df6c/ba9ae/header.jpg","srcSet":"/static/a5e3de6178f36e96f4396812c635df6c/86d0f/header.jpg 125w,\n/static/a5e3de6178f36e96f4396812c635df6c/520da/header.jpg 250w,\n/static/a5e3de6178f36e96f4396812c635df6c/ba9ae/header.jpg 500w,\n/static/a5e3de6178f36e96f4396812c635df6c/72227/header.jpg 750w,\n/static/a5e3de6178f36e96f4396812c635df6c/5c39c/header.jpg 1000w,\n/static/a5e3de6178f36e96f4396812c635df6c/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"v8-的内存限制\" style=\"position:relative;\"><a href=\"#v8-%E7%9A%84%E5%86%85%E5%AD%98%E9%99%90%E5%88%B6\" aria-label=\"v8 的内存限制 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>V8 的内存限制</h2>\n<p>在一般的后端开发语言中都是没有内存限制的，由于基于 v8 最初是为浏览器设计的，64 位下的 1.4GB 和 32 位下的 0.7GB 的限制值用起来是绰绰有余的，导致 Nodejs 在开发的过程中只能在该限制下运行，这将会导致 Nodejs 无法直接操作大内存对象，比如无法将一个 2GB 的文件读入内存中进行字符串分析处理，即使物理内存有 32 个 G。</p>\n<h2 id=\"v8-内存限制的原因\" style=\"position:relative;\"><a href=\"#v8-%E5%86%85%E5%AD%98%E9%99%90%E5%88%B6%E7%9A%84%E5%8E%9F%E5%9B%A0\" aria-label=\"v8 内存限制的原因 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>V8 内存限制的原因</h2>\n<ol>\n<li>表面原因是浏览器对 1.4GB 和 0.7GB 的使用绰绰有余</li>\n<li>深层原因是 v8 的垃圾回收机制的限制。按照官方说法，以 1.5GB 的垃圾回收堆内存为例，v8 做一次小的垃圾回收需要 50ms 以上，做一次非增量式的垃圾回收甚至需要 1s 以上。因为 js 的执行是单线程的，在垃圾回收时会暂停 js 的执行，导致应用的性能和响应能力直线下降。（垃圾回收是在特定的时候执行的）</li>\n</ol>\n<p>当然，Nodejs 在启动的时候也可以通过传递参数来调整内存限制的大小，实例如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">node <span class=\"token operator\">--</span>max<span class=\"token operator\">-</span>old<span class=\"token operator\">-</span>space<span class=\"token operator\">-</span>size<span class=\"token operator\">=</span><span class=\"token number\">1700</span> test<span class=\"token punctuation\">.</span>js <span class=\"token comment\">// 老生代内存空间大小。单位为MB</span>\nnode <span class=\"token operator\">--</span>max<span class=\"token operator\">-</span><span class=\"token keyword\">new</span><span class=\"token operator\">-</span>space<span class=\"token operator\">-</span>size<span class=\"token operator\">=</span><span class=\"token number\">1024</span> test<span class=\"token punctuation\">.</span>js <span class=\"token comment\">// 新生代内存空间大小。单位为MB</span></code></pre></div>\n<h2 id=\"v8-的垃圾回收机制\" style=\"position:relative;\"><a href=\"#v8-%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6\" aria-label=\"v8 的垃圾回收机制 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>V8 的垃圾回收机制</h2>\n<h3 id=\"v8-的内存分代\" style=\"position:relative;\"><a href=\"#v8-%E7%9A%84%E5%86%85%E5%AD%98%E5%88%86%E4%BB%A3\" aria-label=\"v8 的内存分代 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>V8 的内存分代</h3>\n<p>在 v8 中内存分为新生代和老生代两代。新生代中的对象为存活时间较短的对象，老生代中的对象为存活时间较长或常驻内存的对象。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f9af4b6ad825e60d24ae99e349c223b5/0c02e/1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3AUH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFhAAAwAAAAAAAAAAAAAAAAAAABBB/9oACAEBAAE/ISr/2gAMAwEAAgADAAAAEHPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxAAAgEFAAAAAAAAAAAAAAAAAAERITFBUZH/2gAIAQEAAT8QV1RDjBCjS4f/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1.jpg\"\n        title=\"1.jpg\"\n        src=\"/static/f9af4b6ad825e60d24ae99e349c223b5/e5166/1.jpg\"\n        srcset=\"/static/f9af4b6ad825e60d24ae99e349c223b5/f93b5/1.jpg 300w,\n/static/f9af4b6ad825e60d24ae99e349c223b5/b4294/1.jpg 600w,\n/static/f9af4b6ad825e60d24ae99e349c223b5/e5166/1.jpg 1200w,\n/static/f9af4b6ad825e60d24ae99e349c223b5/0c02e/1.jpg 1206w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"scavenge（清道夫）算法\" style=\"position:relative;\"><a href=\"#scavenge%EF%BC%88%E6%B8%85%E9%81%93%E5%A4%AB%EF%BC%89%E7%AE%97%E6%B3%95\" aria-label=\"scavenge（清道夫）算法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scavenge（清道夫）算法</h3>\n<p>新生代中的对象主要通过 Scavenge 算法进行垃圾回收，它将堆内存一分为二，每一部分空间称为 semispace。在这两个 semispace 空间中，只有一个处于使用状态，另一个处于闲置状态。处于使用状态的 simispace 空间称为 From 空间，处于闲置状态的空间称为 To 空间。当开始从 From 空间进行垃圾回收时，会将存活对象复制到 To 空间中，非存活对象的空间将会被释放。完成复制后 From 空间和 To 空间角色互换。（相当于漏斗一样，无限过滤）</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1098px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/755d326b9602da68ef97791931a259d3/46d48/2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3KAH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFRABAQAAAAAAAAAAAAAAAAAAABH/2gAIAQEAAT8hVX//2gAMAwEAAgADAAAAEIAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAMAAwAAAAAAAAAAAAAAAQARIUFhgf/aAAgBAQABPxBVTXqUTRfZbhSf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2.jpg\"\n        title=\"2.jpg\"\n        src=\"/static/755d326b9602da68ef97791931a259d3/46d48/2.jpg\"\n        srcset=\"/static/755d326b9602da68ef97791931a259d3/f93b5/2.jpg 300w,\n/static/755d326b9602da68ef97791931a259d3/b4294/2.jpg 600w,\n/static/755d326b9602da68ef97791931a259d3/46d48/2.jpg 1098w\"\n        sizes=\"(max-width: 1098px) 100vw, 1098px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Scavenge 算法的缺点是只能使用堆内存的一半，是典型的空间换时间的算法，所以无法大规模应用到所有的垃圾回收中。但可以发现，Scavenge 非常适合应用在新生代中，因为新生代中对象的生命周期较短，恰恰适合这个算法。</p>\n<h3 id=\"晋升\" style=\"position:relative;\"><a href=\"#%E6%99%8B%E5%8D%87\" aria-label=\"晋升 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>晋升</h3>\n<p>对象从新生代移动到老生代的过程称为晋升，晋升的条件主要有两个。</p>\n<ol>\n<li>对象是否经历过 Scavenge 回收</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1058px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7e61cd7f0b6665e93451d0e2e239f2f4/3e9cd/3.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdylQhh//8QAFhAAAwAAAAAAAAAAAAAAAAAAEBEg/9oACAEBAAEFAg4//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRAAAgMBAAAAAAAAAAAAAAAAABEBEDFB/9oACAEBAAE/IZTHSdOV/9oADAMBAAIAAwAAABDgD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAAICAgMAAAAAAAAAAAAAAAERACEQMUFRkf/aAAgBAQABPxBjI1uoRHBidQvEFg8f/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3.jpg\"\n        title=\"3.jpg\"\n        src=\"/static/7e61cd7f0b6665e93451d0e2e239f2f4/3e9cd/3.jpg\"\n        srcset=\"/static/7e61cd7f0b6665e93451d0e2e239f2f4/f93b5/3.jpg 300w,\n/static/7e61cd7f0b6665e93451d0e2e239f2f4/b4294/3.jpg 600w,\n/static/7e61cd7f0b6665e93451d0e2e239f2f4/3e9cd/3.jpg 1058w\"\n        sizes=\"(max-width: 1058px) 100vw, 1058px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>2.To 空间的内存占比是否超过 25%</p>\n<blockquote>\n<p>设置 25%这个限制原因是当这里 Scavenge 算法完成后，这个 To 空间将变成 From 空间接下来的内存分配将在这个空间中进行。如果占比过高，会影响后续的内存分配。</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1058px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f20d021621b998b9150ca3d2b5b71f89/3e9cd/4.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdylQhh//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAEREDH/2gAIAQEAAT8hcpSj7v8A/9oADAMBAAIAAwAAABDgD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAAMAAwEBAAAAAAAAAAAAAAABESFRkUGB/9oACAEBAAE/EKX3BPlfwnTG4FlKkWkf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4.jpg\"\n        title=\"4.jpg\"\n        src=\"/static/f20d021621b998b9150ca3d2b5b71f89/3e9cd/4.jpg\"\n        srcset=\"/static/f20d021621b998b9150ca3d2b5b71f89/f93b5/4.jpg 300w,\n/static/f20d021621b998b9150ca3d2b5b71f89/b4294/4.jpg 600w,\n/static/f20d021621b998b9150ca3d2b5b71f89/3e9cd/4.jpg 1058w\"\n        sizes=\"(max-width: 1058px) 100vw, 1058px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"mark-sweep\" style=\"position:relative;\"><a href=\"#mark-sweep\" aria-label=\"mark sweep permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mark-Sweep</h2>\n<p>对于老生代中的对象，由于存活时间较长，再采用 Scavenge 的方式会有两个问题：</p>\n<ol>\n<li>存活对象过多，复制存活对象向的效率将会很低（筛选不掉很多非存活对象，浪费时间）</li>\n<li>浪费一半的内存空间</li>\n</ol>\n<p>Mark-Sweep 是标记清除的意思，它分为标记和清除两个阶段。在标记阶段遍历堆中所有对象，并标记存活的对象，在随后的清除过程中只清除没有标记的对象。\n可以看出，Scavenge 只复制活着的对象，Mark-Sweep 只清除死亡的对象。由于活对象在新生代中占比少，死对象在老生代中的占比少，这就是两种方式各自高效 的原因。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8a149046a4dd82710cc03d53d0311ecc/801ec/5.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3AQH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFhAAAwAAAAAAAAAAAAAAAAAAAAEQ/9oACAEBAAE/IYz/2gAMAwEAAgADAAAAEHPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxAAAgIDAQAAAAAAAAAAAAAAABEBQSExUZH/2gAIAQEAAT8Qcut8HLrwlk//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5.jpg\"\n        title=\"5.jpg\"\n        src=\"/static/8a149046a4dd82710cc03d53d0311ecc/e5166/5.jpg\"\n        srcset=\"/static/8a149046a4dd82710cc03d53d0311ecc/f93b5/5.jpg 300w,\n/static/8a149046a4dd82710cc03d53d0311ecc/b4294/5.jpg 600w,\n/static/8a149046a4dd82710cc03d53d0311ecc/e5166/5.jpg 1200w,\n/static/8a149046a4dd82710cc03d53d0311ecc/801ec/5.jpg 1442w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"缺点\" style=\"position:relative;\"><a href=\"#%E7%BC%BA%E7%82%B9\" aria-label=\"缺点 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>缺点</h3>\n<p>清除后的内存空间会出现不连续的现象，这种不连续的内存称为“内存碎片”。内存碎片会对后续的内存分配造成问题，因为有可能新生代中晋升的对象需要的内存较大，但是老生代中没有可直接分配的内存大小，对于这种需要分配一个大对象的况，这时所有的”碎片空间“都无法完成此次分配，就会提前触发垃圾回收，而这次回收是不必要的。</p>\n<h2 id=\"mark-compact\" style=\"position:relative;\"><a href=\"#mark-compact\" aria-label=\"mark compact permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mark-Compact</h2>\n<p>Mark-Compact 是标记整理的意思。它和 Mark-Sweep 的区别是，在标记对象死亡后，在整理的过程中，将或者的对象往一端移动，移动完成后直接清理掉边界外的内存。（也就是清理以下的空洞内存）</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 740px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d42a6818c60ad05b31f58c68be688d3f/07f3a/6.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAG2AD//xAAWEAADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQEAAQUCKv/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABgQAAMBAQAAAAAAAAAAAAAAAAARYTFR/9oACAEBAAE/IXBOGw//2gAMAwEAAgADAAAAEPPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAICAwAAAAAAAAAAAAAAAQARIXExQcH/2gAIAQEAAT8QSPBz7Gwa6xHuGhP/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6.jpg\"\n        title=\"6.jpg\"\n        src=\"/static/d42a6818c60ad05b31f58c68be688d3f/07f3a/6.jpg\"\n        srcset=\"/static/d42a6818c60ad05b31f58c68be688d3f/f93b5/6.jpg 300w,\n/static/d42a6818c60ad05b31f58c68be688d3f/b4294/6.jpg 600w,\n/static/d42a6818c60ad05b31f58c68be688d3f/07f3a/6.jpg 740w\"\n        sizes=\"(max-width: 740px) 100vw, 740px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>v8 主要使用 Mark-Sweep,在空间不足以从新生代中晋升的对象分配时才使用 Mark-Compact</p>\n</blockquote>\n<h2 id=\"增量标记\" style=\"position:relative;\"><a href=\"#%E5%A2%9E%E9%87%8F%E6%A0%87%E8%AE%B0\" aria-label=\"增量标记 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>增量标记</h2>\n<p>在执行三种垃圾回收算法时都需要将 js 主线程的应用逻辑停顿下来，待执行完垃圾回收之后再恢复执行应用逻辑。这种行为称为“全停顿”。对于新生代默认得较小，且其中存活的对象较少，即使全停顿也影响不大。但对于 v8 对老生代的配置较大，而且存活对象较多，“全停顿”造成的后果是非常可怕的，需要设法改善。</p>\n<blockquote>\n<p>增量标记就是拆分为许多小步前进，每做完一步，就让 js 的应用逻辑执行一小会儿。两者互相交替执行。</p>\n</blockquote>\n<p>v8 后续要引进了“延迟清理“，”增量式整理“，”并行标记“，”并行清除“等,进一步地减少垃圾回收对主线程的影响，为应用提升更多的性能。</p>\n<h2 id=\"高效使用内存\" style=\"position:relative;\"><a href=\"#%E9%AB%98%E6%95%88%E4%BD%BF%E7%94%A8%E5%86%85%E5%AD%98\" aria-label=\"高效使用内存 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>高效使用内存</h2>\n<p>在正常的 js 执行中，无法立即回收的内存有”闭包”和“全局变量”引用这两种情况。由于 v8 的内存限制，要十分小心此类变量是否无限制的添加，因为他会导致老生代中的对象增多。所以建议如下：</p>\n<ol>\n<li>尽可能少的使用全局变量</li>\n<li>手动清除定时器</li>\n<li>少用闭包</li>\n<li>清除 DOM 引用</li>\n<li>弱引用，如 ES6 中的<code class=\"language-text\">WeakMap</code>和<code class=\"language-text\">WeakSet</code>就是为了解决内存泄漏的问题而诞生的</li>\n</ol>"},{"id":"ac168b12-3574-542d-9b87-92337219bdb8","headings":[{"depth":2},{"depth":2},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":2},{"depth":3},{"depth":2},{"depth":3},{"depth":2}],"frontmatter":{"title":"JavaScript多种继承方式以及优缺点","path":"/js-inherit","tags":["JavaScript"],"excerpt":"1.new 运算符究竟都干了些什么？<br/>2.原型链继承<br/>3.构造函数继承<br/>4.组合继承<br/>5.原型式继承<br/>6.寄生式继承<br/>7.寄生组合式继承","created":"2021-08-08 13:55","createdPretty":"08 August, 2021","updated":"2021-08-08 13:55","updatedPretty":"08 August, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBf/EABcBAAMBAAAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAdqdFWLAF//EABYQAAMAAAAAAAAAAAAAAAAAAAAgQv/aAAgBAQABBQItP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABISD/2gAIAQEABj8CI5n/xAAaEAACAwEBAAAAAAAAAAAAAAABERAhMQCh/9oACAEBAAE/ITnMkLUsSixeex//2gAMAwEAAgADAAAAEAff/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAEDAQE/EByf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAICAwAAAAAAAAAAAAAAARFRABAhMdH/2gAIAQEAAT8QUJowUii9TSSJZiqPEQgdr1//2Q==","aspectRatio":1.5060240963855422,"src":"/static/5edace265c464c8ea9ebc9b9077a226e/ba9ae/header.jpg","srcSet":"/static/5edace265c464c8ea9ebc9b9077a226e/86d0f/header.jpg 125w,\n/static/5edace265c464c8ea9ebc9b9077a226e/520da/header.jpg 250w,\n/static/5edace265c464c8ea9ebc9b9077a226e/ba9ae/header.jpg 500w,\n/static/5edace265c464c8ea9ebc9b9077a226e/72227/header.jpg 750w,\n/static/5edace265c464c8ea9ebc9b9077a226e/5c39c/header.jpg 1000w,\n/static/5edace265c464c8ea9ebc9b9077a226e/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"new-运算符究竟都干了些什么？\" style=\"position:relative;\"><a href=\"#new-%E8%BF%90%E7%AE%97%E7%AC%A6%E7%A9%B6%E7%AB%9F%E9%83%BD%E5%B9%B2%E4%BA%86%E4%BA%9B%E4%BB%80%E4%B9%88%EF%BC%9F\" aria-label=\"new 运算符究竟都干了些什么？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>new 运算符究竟都干了些什么？</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 以下继承会用到该父对象</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Animal</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"defaultName\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>types <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"pig\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> animal <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Animal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>new 简单来说就是用来创建对象实例的，当创建对象实例的时候，它会做以下操作</p>\n<ol>\n<li>创建一个空的 JavaScript 对象（<code class=\"language-text\">即{}</code>）</li>\n<li>为步骤一新创建的对象添加属性<code class=\"language-text\">__proto__</code>，将该属性指向构造函数的原型对象<code class=\"language-text\">prototype</code></li>\n<li>将步骤一创建的对象作为构造函数的<code class=\"language-text\">this</code>上下文</li>\n<li>如果该函数没有返回对象，则返回<code class=\"language-text\">this</code>（一般情况下，构造函数不返回值，但是用户可以选择主动返回对象，来覆盖正常的对象创建步骤）</li>\n</ol>\n<blockquote>\n<p>如果你没有使用 new 运算符， 构造函数会像其他的常规函数一样被调用， 并不会创建一个对象。在这种情况下， this 的指向也是不一样的。</p>\n</blockquote>\n<p>所以，创建一个用户自定义对象只需要以下两步</p>\n<ol>\n<li>通过编写函数来定义对象类型</li>\n<li>通过<code class=\"language-text\">new</code>来创建对象实例</li>\n</ol>\n<h2 id=\"1-原型链继承\" style=\"position:relative;\"><a href=\"#1-%E5%8E%9F%E5%9E%8B%E9%93%BE%E7%BB%A7%E6%89%BF\" aria-label=\"1 原型链继承 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 原型链继承</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token class-name\">Animal</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">getName</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Cat</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Animal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> cat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>cat<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// defaultName</span></code></pre></div>\n<h3 id=\"缺点\" style=\"position:relative;\"><a href=\"#%E7%BC%BA%E7%82%B9\" aria-label=\"缺点 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>缺点</h3>\n<ol>\n<li>引用类型的属性被所有实例共享，举个例子：</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token class-name\">Animal</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">getTypes</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>types\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Cat</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Animal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> whiteCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nwhiteCat<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cat\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> blackCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>whiteCat<span class=\"token punctuation\">.</span><span class=\"token function\">getTypes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// ['pig','cat']</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>blackCat<span class=\"token punctuation\">.</span><span class=\"token function\">getTypes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// ['pig','cat']</span></code></pre></div>\n<ol start=\"2\">\n<li>\n<p>在创建 Cat 的实例时，不能向 Animal 传参</p>\n<ul>\n<li>导致<code class=\"language-text\">console.log(cat.getName())</code>一直显示的是 defaultName</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"2-借用构造函数经典继承\" style=\"position:relative;\"><a href=\"#2-%E5%80%9F%E7%94%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%BB%8F%E5%85%B8%E7%BB%A7%E6%89%BF\" aria-label=\"2 借用构造函数经典继承 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 借用构造函数(经典继承)</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">Animal</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> whiteCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nwhiteCat<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cat\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> blackCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>whiteCat<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">)</span> <span class=\"token comment\">// ['pig','cat']</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>blackCat<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">)</span> <span class=\"token comment\">// ['pig']</span></code></pre></div>\n<h3 id=\"优点\" style=\"position:relative;\"><a href=\"#%E4%BC%98%E7%82%B9\" aria-label=\"优点 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>优点</h3>\n<ol>\n<li>避免了引用类型的属性被所有实例共享</li>\n<li>可以在 Cat 中向 Animal 传参,举个例子</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">Animal</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> whiteCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">)</span>\nwhiteCat<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cat\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> blackCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"black\"</span><span class=\"token punctuation\">)</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>whiteCat<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token comment\">// white</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>blackCat<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token comment\">// black</span></code></pre></div>\n<h3 id=\"缺点-1\" style=\"position:relative;\"><a href=\"#%E7%BC%BA%E7%82%B9-1\" aria-label=\"缺点 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>缺点</h3>\n<p>方法都在构造函数中定义，每次创建实例都会创建一遍方法。</p>\n<h2 id=\"3-组合继承\" style=\"position:relative;\"><a href=\"#3-%E7%BB%84%E5%90%88%E7%BB%A7%E6%89%BF\" aria-label=\"3 组合继承 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 组合继承</h2>\n<p>原型链继承和经典继承双剑合璧。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token class-name\">Animal</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">getName</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">,</span> age</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">Animal</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> age\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Cat</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Animal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token class-name\">Cat</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>constructor <span class=\"token operator\">=</span> Cat\n\n<span class=\"token keyword\">const</span> whiteCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\nwhiteCat<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cat\"</span><span class=\"token punctuation\">)</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>whiteCat<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">)</span> <span class=\"token comment\">// ['pig','cat']</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>whiteCat<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// white</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>whiteCat<span class=\"token punctuation\">.</span>age<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 4</span>\n\n<span class=\"token keyword\">const</span> blackCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"black\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>blackCat<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">)</span> <span class=\"token comment\">// ['pig']</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>blackCat<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// black</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>blackCat<span class=\"token punctuation\">.</span>age<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 5</span></code></pre></div>\n<h3 id=\"优点-1\" style=\"position:relative;\"><a href=\"#%E4%BC%98%E7%82%B9-1\" aria-label=\"优点 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>优点</h3>\n<p>融合原型链继承和构造函数的优点，是 JavaScript 中最常用的继承模式。</p>\n<ol>\n<li>原型链<code class=\"language-text\">共享</code>的特性，不用每次都创建一个方法</li>\n<li>构造函数<code class=\"language-text\">封闭</code>的特性，每个构造函数中的属性都是独立的</li>\n</ol>\n<h2 id=\"4-原型式继承\" style=\"position:relative;\"><a href=\"#4-%E5%8E%9F%E5%9E%8B%E5%BC%8F%E7%BB%A7%E6%89%BF\" aria-label=\"4 原型式继承 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 原型式继承</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">createObj</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token class-name\">F</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> o\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">F</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>就是 ES5 Object.create 的模拟实现，将传入的对象作为创建的对象的原型。</p>\n<h3 id=\"缺点-2\" style=\"position:relative;\"><a href=\"#%E7%BC%BA%E7%82%B9-2\" aria-label=\"缺点 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>缺点</h3>\n<p>包含引用类型的属性值始终都会共享相应的值，这点跟原型链继承一样。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> person <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token string\">\"kevin\"</span><span class=\"token punctuation\">,</span>\n  friends<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"daisy\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"kelly\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> person1 <span class=\"token operator\">=</span> <span class=\"token function\">createObj</span><span class=\"token punctuation\">(</span>person<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> person2 <span class=\"token operator\">=</span> <span class=\"token function\">createObj</span><span class=\"token punctuation\">(</span>person<span class=\"token punctuation\">)</span>\n\nperson1<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"person1\"</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>person2<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token comment\">// kevin</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>person1<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token comment\">// person1</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>person<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span> <span class=\"token comment\">// kevin</span>\n\nperson1<span class=\"token punctuation\">.</span>friends<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"taylor\"</span><span class=\"token punctuation\">)</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>person1<span class=\"token punctuation\">.</span>friends<span class=\"token punctuation\">)</span> <span class=\"token comment\">// [\"daisy\", \"kelly\", \"taylor\"]</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>person2<span class=\"token punctuation\">.</span>friends<span class=\"token punctuation\">)</span> <span class=\"token comment\">// [\"daisy\", \"kelly\", \"taylor\"]</span></code></pre></div>\n<blockquote>\n<p>注意：修改 person1.name 的值，person2.name 的值并未发生改变，并不是因为 person1 和 person2 有独立的 name 值，而是因为 person1.name = 'person1'，给 person1 添加了 name 值，并非修改了原型上的 name 值</p>\n</blockquote>\n<h2 id=\"5-寄生式继承\" style=\"position:relative;\"><a href=\"#5-%E5%AF%84%E7%94%9F%E5%BC%8F%E7%BB%A7%E6%89%BF\" aria-label=\"5 寄生式继承 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 寄生式继承</h2>\n<p>创建一个仅用于封装继承过程的函数，该函数在内部以某种形式来做增强对象，最后返回对象。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">createObj</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> cloneObj <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span>\n  cloneObj<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">sayName</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"hi\"</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> cloneObj\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"缺点-3\" style=\"position:relative;\"><a href=\"#%E7%BC%BA%E7%82%B9-3\" aria-label=\"缺点 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>缺点</h3>\n<p>跟经典构造函数模式一样，每次创建对象都会创建一遍方法。</p>\n<h2 id=\"6-寄生组合式继承\" style=\"position:relative;\"><a href=\"#6-%E5%AF%84%E7%94%9F%E7%BB%84%E5%90%88%E5%BC%8F%E7%BB%A7%E6%89%BF\" aria-label=\"6 寄生组合式继承 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 寄生组合式继承</h2>\n<p>为了方便大家阅读，在这里重复一下组合继承的代码：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">Animal</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"defaultName\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>types <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"pig\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Animal</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">getName</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">,</span> age</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">Animal</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> age\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Cat</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Animal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token class-name\">Cat</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>constructor <span class=\"token operator\">=</span> Cat\n\n<span class=\"token keyword\">const</span> whiteCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Cat</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">)</span> <span class=\"token comment\">// Cat {name:'defaultName',types:['pig'],constructor: [Function: Cat]}</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>whiteCat<span class=\"token punctuation\">)</span> <span class=\"token comment\">// Cat { name: 'white', types: [ 'pig' ], age: 4 }</span></code></pre></div>\n<p>组合继承最大的缺点是会调用两次父构造函数。</p>\n<p>一次是设置子类型实例的原型的时候：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token class-name\">Cat</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Animal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>一次在创建子类型实例的时候：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> whiteCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>回想下 new 的模拟实现，其实在这句中，我们又会调用了一次 Parent 构造函数。：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">Animal</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p>所以，在这个例子中，如果我们打印 whiteCat 对象，我们会发现 Cat.prototype 和 whiteCat 都有一个属性为 types，属性值为['pig']。</p>\n</blockquote>\n<p>那么我们该如何精益求精，避免这一次重复调用呢？<br>\n如果我们不使用 Child.prototype = new Parent() ，而是间接的让 Child.prototype 访问到 Parent.prototype 呢？<br></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">Animal</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"defaultName\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>types <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"pig\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Animal</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">getName</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">,</span> age</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">Animal</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> age\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 关键的三步</span>\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">F</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">F</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> <span class=\"token class-name\">Animal</span><span class=\"token punctuation\">.</span>prototype\n\n<span class=\"token class-name\">Cat</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">F</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> whiteCat <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Cat</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">)</span> <span class=\"token comment\">// Animal {}</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>whiteCat<span class=\"token punctuation\">)</span> <span class=\"token comment\">// Animal { name: 'white', types: [ 'pig' ], age: 4 }</span></code></pre></div>\n<p>最后我们封装一下这个继承方法：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">createObj</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">o</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token constant\">F</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token class-name\">F</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> o\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">F</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">prototype</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">Child_Class<span class=\"token punctuation\">,</span> Parent_Class</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> cloneObj <span class=\"token operator\">=</span> <span class=\"token function\">createObj</span><span class=\"token punctuation\">(</span>Parent_Class<span class=\"token punctuation\">)</span>\n  <span class=\"token class-name\">Child_Class</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> cloneObj\n  <span class=\"token class-name\">Child_Class</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>constructor <span class=\"token operator\">=</span> Child_Class\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 当我们使用的时候：</span>\n<span class=\"token function\">prototype</span><span class=\"token punctuation\">(</span>Child<span class=\"token punctuation\">,</span> Parent<span class=\"token punctuation\">)</span></code></pre></div>\n<p>引用《JavaScript 高级程序设计》中对寄生组合式继承的夸赞就是：</p>\n<blockquote>\n<p>这种方式的高效率体现它只调用了一次 Animal 构造函数，并且因此避免了在 Cat.prototype 上面创建不必要的、多余的属性。与此同时，原型链还能保持不变；因此，还能够正常使用 instanceof 和 isPrototypeOf。开发人员普遍认为寄生组合式继承是引用类型最理想的继承范式。</p>\n</blockquote>"},{"id":"5fe592fe-fa3a-5495-9fe5-3acd5f33e7fd","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2}],"frontmatter":{"title":"四种方式实现在导出word中添加「图表」","path":"/export-word","tags":["Golang"],"excerpt":"1. React前端通过echarts的获取图表的dataUrl实现<br/>2. Nodejs通过无头浏览器截图实现<br/>3. Nodejs结合Canvas和Echarts实现<br/>4. Golang通过模板渲染修改word元数据实现","created":"2021-06-27 17:20","createdPretty":"27 June, 2021","updated":"2021-07-04 17:45","updatedPretty":"27 June, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHYnrWjQJf/xAAZEAACAwEAAAAAAAAAAAAAAAAAAgEDERL/2gAIAQEAAQUCduVrvWxjNITJP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABURAQEAAAAAAAAAAAAAAAAAABAh/9oACAECAQE/AYf/xAAYEAACAwAAAAAAAAAAAAAAAAABEAARQf/aAAgBAQAGPwImUHi//8QAGhABAQEBAAMAAAAAAAAAAAAAAQARIWGBsf/aAAgBAQABPyEHdc82ak9xOCcxu58Rf//aAAwDAQACAAMAAAAQ/wDv/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAR/9oACAEDAQE/EIV//8QAFhEBAQEAAAAAAAAAAAAAAAAAAREQ/9oACAECAQE/EBiJn//EABoQAQEBAAMBAAAAAAAAAAAAAAERACFBUTH/2gAIAQEAAT8QFcLYR5jLZFqX5u3Ni5lxdCXARpDyYIcy28b/2Q==","aspectRatio":1.4204545454545454,"src":"/static/8a183bafd708e36b95af93205201bb79/ba9ae/header.jpg","srcSet":"/static/8a183bafd708e36b95af93205201bb79/86d0f/header.jpg 125w,\n/static/8a183bafd708e36b95af93205201bb79/520da/header.jpg 250w,\n/static/8a183bafd708e36b95af93205201bb79/ba9ae/header.jpg 500w,\n/static/8a183bafd708e36b95af93205201bb79/72227/header.jpg 750w,\n/static/8a183bafd708e36b95af93205201bb79/5c39c/header.jpg 1000w,\n/static/8a183bafd708e36b95af93205201bb79/e2de3/header.jpg 1280w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<p>为什么要说说如何在 word 中插入「图表」呢？因为前端熟知的第三方库<a href=\"https://github.com/dolanmiu/docx\">Docx</a>不支持插入「图表」！！！</p>\n<blockquote>\n<p><a href=\"https://github.com/dolanmiu/docx\">Docx</a>这个库提供了优雅的声明式 API，让我们可以使用 JS/TS 轻松生成 <b>「.docx」</b> 文件。此外，它还同时支持 Node.js 和浏览器。</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b81e28982d6b411b8706f9136c30e06b/222f7/docx-chart.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3aAD/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGBAAAgMAAAAAAAAAAAAAAAAAAAEQETH/2gAIAQEAAT8hWxR//9oADAMBAAIAAwAAABDwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABcQAAMBAAAAAAAAAAAAAAAAAAABEVH/2gAIAQEAAT8QQREYf//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"不信你们康康这里\"\n        title=\"不信你们康康这里\"\n        src=\"/static/b81e28982d6b411b8706f9136c30e06b/e5166/docx-chart.jpg\"\n        srcset=\"/static/b81e28982d6b411b8706f9136c30e06b/f93b5/docx-chart.jpg 300w,\n/static/b81e28982d6b411b8706f9136c30e06b/b4294/docx-chart.jpg 600w,\n/static/b81e28982d6b411b8706f9136c30e06b/e5166/docx-chart.jpg 1200w,\n/static/b81e28982d6b411b8706f9136c30e06b/d9c39/docx-chart.jpg 1800w,\n/static/b81e28982d6b411b8706f9136c30e06b/222f7/docx-chart.jpg 1870w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>为了解决这个问题，我想通过这篇文章聊一聊，希望大家不仅能实现前后端导出 word 功能，还能实现在导出的 word 中插入「图表」！本文主讲如何在导出的 word 中插入「图表」,经过漫长的技术实现，分步从前端到后端，从问题衍生到技术优化。主体分为以下四个部分</p>\n<ol>\n<li>React 通过<a href=\"https://github.com/apache/echarts\">echarts</a>的 API<a href=\"https://echarts.apache.org/zh/api.html#echartsInstance.getDataURL\">getDataURL</a>实现</li>\n<li>Node.js 通过<a href=\"https://github.com/puppeteer/puppeteer\">puppeteer</a>headless 浏览器快照功能实现</li>\n<li>Node.js 通过<a href=\"https://github.com/Automattic/node-canvas\">canvas</a>实现（推荐）</li>\n<li>Golang 通过模板渲染<a href=\"https://golang.org/pkg/text/template/\">text/template</a>实现 word 导出和插入「图表」功能(强烈推荐)</li>\n</ol>\n<h2 id=\"docx-的常用-api\" style=\"position:relative;\"><a href=\"#docx-%E7%9A%84%E5%B8%B8%E7%94%A8-api\" aria-label=\"docx 的常用 api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docx 的常用 api</h2>\n<p><a href=\"https://github.com/dolanmiu/docx\" target=\"_blank\">Docx</a> 这个库为开发者提供了许多类，用于创建 Word 中的对应元素，这里我们简单介绍几个常见的类：</p>\n<ul>\n<li><a href=\"https://docx.js.org/#/usage/document\" target=\"_blank\">Document</a>：用于创建新的 Word 文档；</li>\n<li><a href=\"https://docx.js.org/#/usage/sections\" target=\"_blank\">Sections</a>：用于创建区块，一个区块包括一个或多个段落；</li>\n<li><a href=\"https://docx.js.org/#/usage/paragraph\" target=\"_blank\">Paragraph</a>：用于创建新的段落；</li>\n<li><a href=\"https://docx.js.org/#/usage/text\" target=\"_blank\">Text Run</a>：用于创建文本，支持设置加粗、斜体和下划线样式；</li>\n<li><a href=\"https://docx.js.org/#/usage/images\" target=\"_blank\">Image Run</a>：用于创建图片，支持浮动和内联的定位；</li>\n<li><a href=\"https://docx.js.org/#/usage/tables\" target=\"_blank\">Tables</a>：用于创建表格，支持设置表格每一行和每个表格单元的内容。</li>\n</ul>\n<h2 id=\"react-通过-echarts-的-getdataurl-实现\" style=\"position:relative;\"><a href=\"#react-%E9%80%9A%E8%BF%87-echarts-%E7%9A%84-getdataurl-%E5%AE%9E%E7%8E%B0\" aria-label=\"react 通过 echarts 的 getdataurl 实现 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React 通过 echarts 的 getDataURL 实现</h2>\n<p>Docx 不能插入「图表」，值得庆幸的是图片还是可以插入的。 Image Run 可以通过 Data URL 和 buffer 插入图片，于是我联想到了 echarts 的「getDataURL」能够获取到图表的 Data Url。按照下面的方法就能实现「图表」图片的 Data URL 生成了。</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">/**\n * @description:通过echarts的实例api生成图表Data URL\n * @param {option} echarts图表的option配置\n * @return {string} Data URL\n */</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getChartDataURL</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">option <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span>\n  container<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> <span class=\"token string\">\"container\"</span>\n  container<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">\"none\"</span>\n  container<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> <span class=\"token string\">\"500px\"</span>\n  container<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token string\">\"500px\"</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> instance <span class=\"token operator\">=</span> echarts<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 绘制图表</span>\n  <span class=\"token comment\">// 刚开始绘制不出来图表的原因如下：</span>\n  <span class=\"token comment\">// 如果有动画效果的话，生成的图片会是在有动画效果出来以前的样子，就是说数据还没渲染上去，因此导出的图片没有数据。</span>\n  <span class=\"token comment\">// https://blog.csdn.net/qq_35239421/article/details/106526147</span>\n  instance<span class=\"token punctuation\">.</span><span class=\"token function\">setOption</span><span class=\"token punctuation\">(</span>option<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> dataUrl <span class=\"token operator\">=</span> instance<span class=\"token punctuation\">.</span><span class=\"token function\">getDataURL</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">\"png\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> dataUrl\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p><a href=\"https://github.com/pipihua666/export-word/tree/master/export-frontend\">完整项目参考代码戳这里</a>，代码可直接运行查看，下同！</p>\n</blockquote>\n<h2 id=\"nodejs-通过-puppeteer-headless-浏览器快照功能实现\" style=\"position:relative;\"><a href=\"#nodejs-%E9%80%9A%E8%BF%87-puppeteer-headless-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%BF%AB%E7%85%A7%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0\" aria-label=\"nodejs 通过 puppeteer headless 浏览器快照功能实现 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Node.js 通过 puppeteer headless 浏览器快照功能实现</h2>\n<p>echarts 只能在浏览器使用（当然你也可以使用在后端封装好的 echarts 库，我没有这样去实现，可在评论区给出你们实现的链接哈！），该怎么办啊！后端还有 headless 浏览器呢。通过 puppeteer 的快照功能实现如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/** * 生成echarts图片 *\n * @param {*} option echarts 选项 *\n *  @returns 图片buffer\n * */</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getEchartsChart</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">option <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 启动浏览器</span>\n  <span class=\"token keyword\">const</span> browser <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> puppeteer<span class=\"token punctuation\">.</span><span class=\"token function\">launch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    args<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"--no-sandbox\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 创建空白页面</span>\n  <span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">newPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 定义网页模板</span>\n    <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;!DOCTYPE html>\n    &lt;html lang=\"en\">\n      &lt;head>\n        &lt;meta charset=\"UTF-8\">\n        &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n        &lt;title>chart&lt;/title>\n      &lt;/head>\n      &lt;body>\n          &lt;div id=\"container\" style=\"width: 500px;height:500px;\" />\n      &lt;/body>\n    &lt;/html></span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token comment\">// 设置网页源码</span>\n    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">setContent</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// 添加script标签和属性</span>\n    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">addScriptTag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      path<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>\n        __dirname<span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"./node_modules/echarts/dist/echarts.min.js\"</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// 网页中执行js代码</span>\n    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">option</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> myChart <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>echarts<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"container\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      myChart<span class=\"token punctuation\">.</span><span class=\"token function\">setOption</span><span class=\"token punctuation\">(</span>option<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> option<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// 网页中获取id为container的元素</span>\n    <span class=\"token keyword\">let</span> elem <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#container\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// 截图元素快照</span>\n    <span class=\"token keyword\">let</span> buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> elem<span class=\"token punctuation\">.</span><span class=\"token function\">screenshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      type<span class=\"token operator\">:</span> <span class=\"token string\">\"png\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">// path: path.resolve(__dirname, './123.png') // 快照的生成路径</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> buffer\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">render echarts chart error: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>err<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 关闭网页</span>\n    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// 关闭浏览器</span>\n    <span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p><a href=\"https://github.com/pipihua666/export-word/tree/master/export-node\">完整项目参考代码戳这里</a></p>\n</blockquote>\n<h2 id=\"nodejs-通过-canvas-实现\" style=\"position:relative;\"><a href=\"#nodejs-%E9%80%9A%E8%BF%87-canvas-%E5%AE%9E%E7%8E%B0\" aria-label=\"nodejs 通过 canvas 实现 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Node.js 通过 canvas 实现</h2>\n<p>每次都要通过 headless 浏览器去获取图表的快照，一个请求对应一个 headless 浏览器，这样既不高效，又非常耗费性能。通过独立的 canvas 库设置为 echarts 的容器就能很好的优化了，实现方式如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"canvas\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> echarts <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"echarts\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fs\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** * 生成echarts图片 *\n * @param {*} option echarts 选项 *\n *  @returns 图片buffer\n * */</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getBufferByCanvas</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">option <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//创建一个canvas实例</span>\n  <span class=\"token keyword\">let</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">//将canvas实例设置为echarts容器</span>\n  echarts<span class=\"token punctuation\">.</span><span class=\"token function\">setCanvasCreator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> ctx<span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">//使用canvas实例为容器创建echarts实例</span>\n  <span class=\"token keyword\">let</span> chart <span class=\"token operator\">=</span> echarts<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">//设置图标实例配置项</span>\n  chart<span class=\"token punctuation\">.</span><span class=\"token function\">setOption</span><span class=\"token punctuation\">(</span>option<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> chart<span class=\"token punctuation\">.</span><span class=\"token function\">getDom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p><a href=\"https://github.com/pipihua666/export-word/tree/master/export-node\">完整项目参考代码戳这里</a></p>\n</blockquote>\n<h2 id=\"golang-通过模板渲染-实现-word-导出和插入「图表」功能\" style=\"position:relative;\"><a href=\"#golang-%E9%80%9A%E8%BF%87%E6%A8%A1%E6%9D%BF%E6%B8%B2%E6%9F%93-%E5%AE%9E%E7%8E%B0-word-%E5%AF%BC%E5%87%BA%E5%92%8C%E6%8F%92%E5%85%A5%E3%80%8C%E5%9B%BE%E8%A1%A8%E3%80%8D%E5%8A%9F%E8%83%BD\" aria-label=\"golang 通过模板渲染 实现 word 导出和插入「图表」功能 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Golang 通过模板渲染 实现 word 导出和插入「图表」功能</h2>\n<ul>\n<li>为什么要用 Go 呢？因为我们项目后端就用的 Go，Node.js 同样也能这样实现导出和插入图表。还有一个原因是：Go 是真的快啊！</li>\n<li>每次插入「图表」感觉都是插入的图片，这样导出的 word 意义在哪儿？图表只能看，不能修改和交互（→_→）。好了，我看到了你鄙视的小眼神，接下来的模板渲染方法帮你解决这些所有的疑问。</li>\n</ul>\n<h3 id=\"「docx」的特性\" style=\"position:relative;\"><a href=\"#%E3%80%8Cdocx%E3%80%8D%E7%9A%84%E7%89%B9%E6%80%A7\" aria-label=\"「docx」的特性 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>「.docx」的特性</h3>\n<p>.docx 的 word 文档其实就是一个 zip 压缩包(xml 文件的集合)，我们通过把<code class=\"language-text\">example.docx</code>重命名为<code class=\"language-text\">example.zip</code>，然后解压出来，你就可以看到如下文件：\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/520910ef39ae6f0dc077699031195661/6a068/1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAcQJIL//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAXEAEAAwAAAAAAAAAAAAAAAAABABAR/9oACAEBAAE/IcgDX//aAAwDAQACAAMAAAAQB8//xAAWEQADAAAAAAAAAAAAAAAAAAABEDH/2gAIAQMBAT8QMX//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAxgf/aAAgBAQABPxCKqD5rgmUvDf/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1\"\n        title=\"1\"\n        src=\"/static/520910ef39ae6f0dc077699031195661/6a068/1.jpg\"\n        srcset=\"/static/520910ef39ae6f0dc077699031195661/f93b5/1.jpg 300w,\n/static/520910ef39ae6f0dc077699031195661/b4294/1.jpg 600w,\n/static/520910ef39ae6f0dc077699031195661/6a068/1.jpg 960w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><code class=\"language-text\">[Content_Types].xml</code>：该文件用于定义里面每一个 XML 文件的内容类型；</li>\n<li><code class=\"language-text\">_rels</code>：该目录下一般会有一个 「.rels」 后缀的文件，它里面保存了这个目录下各个 Part 之间的关系。<code class=\"language-text\">_rels</code> 目录不止一个，它实际上是有层级的;</li>\n<li><code class=\"language-text\">docProps</code>：该目录下的 XML 文件用于保存 docx 文件的属性；</li>\n<li><code class=\"language-text\">word</code>：该目录下包含了 Word 文档中的内容、字体、样式或主题等信息。</li>\n</ul>\n<p><code class=\"language-text\">word</code>文件夹是我们需要关注并修改为我们的模板文件，可以看到文件夹目录如下：\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 900px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5f4f520042c79dd92bcfe9b06d685cf8/8e1fc/2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAcQFEj//xAAXEAADAQAAAAAAAAAAAAAAAAAAARAx/9oACAEBAAEFAo9jP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAAIDAQAAAAAAAAAAAAAAAAABESExQf/aAAgBAQABPyESvCOBdFqEs//aAAwDAQACAAMAAAAQEM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAfEAEAAgAGAwAAAAAAAAAAAAABABEQITFBUWGBkbH/2gAIAQEAAT8Qq7s9wkFKz27gC0HGAfNf1grVZ//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2\"\n        title=\"2\"\n        src=\"/static/5f4f520042c79dd92bcfe9b06d685cf8/8e1fc/2.jpg\"\n        srcset=\"/static/5f4f520042c79dd92bcfe9b06d685cf8/f93b5/2.jpg 300w,\n/static/5f4f520042c79dd92bcfe9b06d685cf8/b4294/2.jpg 600w,\n/static/5f4f520042c79dd92bcfe9b06d685cf8/8e1fc/2.jpg 900w\"\n        sizes=\"(max-width: 900px) 100vw, 900px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><code class=\"language-text\">charts</code>是图表集合</li>\n<li><code class=\"language-text\">document.xml</code>是整个文档的 xml 显示</li>\n</ul>\n<h3 id=\"模板渲染实现-word-导出\" style=\"position:relative;\"><a href=\"#%E6%A8%A1%E6%9D%BF%E6%B8%B2%E6%9F%93%E5%AE%9E%E7%8E%B0-word-%E5%AF%BC%E5%87%BA\" aria-label=\"模板渲染实现 word 导出 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>模板渲染实现 word 导出</h3>\n<p>我们以下面的 word 文档为例\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3585595c8fbfd869dfc6cfbddd5ebcc6/c0b59/6.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB3GSJbQKP/8QAFhABAQEAAAAAAAAAAAAAAAAAEQEQ/9oACAEBAAEFAtq1z//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/AYf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGn/8QAGBAAAgMAAAAAAAAAAAAAAAAAABAhUYH/2gAIAQEABj8CcUav/8QAHRABAAEEAwEAAAAAAAAAAAAAAREAECFBMVFhcf/aAAgBAQABPyEIXHLqs+2hblp9oNeoRb//2gAMAwEAAgADAAAAELTP/8QAFhEAAwAAAAAAAAAAAAAAAAAAARBh/9oACAEDAQE/EBS//8QAFhEAAwAAAAAAAAAAAAAAAAAAARBh/9oACAECAQE/EDC//8QAHBAAAgMBAAMAAAAAAAAAAAAAAREAIUExEHGB/9oACAEBAAE/ECmjRRQEsT3BzfsETJwJotEU7KHKfj//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"6\"\n        title=\"6\"\n        src=\"/static/3585595c8fbfd869dfc6cfbddd5ebcc6/e5166/6.jpg\"\n        srcset=\"/static/3585595c8fbfd869dfc6cfbddd5ebcc6/f93b5/6.jpg 300w,\n/static/3585595c8fbfd869dfc6cfbddd5ebcc6/b4294/6.jpg 600w,\n/static/3585595c8fbfd869dfc6cfbddd5ebcc6/e5166/6.jpg 1200w,\n/static/3585595c8fbfd869dfc6cfbddd5ebcc6/c0b59/6.jpg 1438w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li>一个请求创建一个<code class=\"language-text\">结果模板文件夹</code>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/952574047e011022cb2845f14188dc50/a66e6/3.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAADABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABwwTB/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAERMf/aAAgBAQABPyEig9P/2gAMAwEAAgADAAAAEPff/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAx/9oACAEDAQE/EDSdv//EABYRAAMAAAAAAAAAAAAAAAAAAAEQMf/aAAgBAgEBPxAxf//EABcQAQEBAQAAAAAAAAAAAAAAAAEhABH/2gAIAQEAAT8QaPbcoIYcjf/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3\"\n        title=\"3\"\n        src=\"/static/952574047e011022cb2845f14188dc50/e5166/3.jpg\"\n        srcset=\"/static/952574047e011022cb2845f14188dc50/f93b5/3.jpg 300w,\n/static/952574047e011022cb2845f14188dc50/b4294/3.jpg 600w,\n/static/952574047e011022cb2845f14188dc50/e5166/3.jpg 1200w,\n/static/952574047e011022cb2845f14188dc50/a66e6/3.jpg 1356w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></li>\n<li>把<code class=\"language-text\">源模板文件夹</code>中需要插入数据的地方修改为相应的<code class=\"language-text\">模板语法</code>，在 Go 中就是这样的模板语法<code class=\"language-text\">{{.Title}}</code>，通过把<code class=\"language-text\">源模板文件夹</code>结合数据<b>渲染</b>出最终的文件替换<code class=\"language-text\">结果模板文件夹</code>中的同名文件。比如这里的<code class=\"language-text\">/word/charts/chart1.xml</code>文件（其他 xml 文件同理）</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>cat</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>strRef</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>f</span><span class=\"token punctuation\">></span></span>Sheet1!$A$2:$A$5<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>f</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>strCache</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>ptCount</span> <span class=\"token attr-name\">val</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{{.ChartData | len | print}}<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n            {{/* 遍历数据ChartData: []Chart{{\"小明\", 100}, {\"小花\", 88}, {\"小红\", 66}} */}}\n            {{range $index, $element := .ChartData}}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>pt</span> <span class=\"token attr-name\">idx</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{{$index | print}}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                {{ /* name */}}\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>v</span><span class=\"token punctuation\">></span></span>{{$element.Key}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>v</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>pt</span><span class=\"token punctuation\">></span></span>\n            {{end}}\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>strCache</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>strRef</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>cat</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>val</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>numRef</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>f</span><span class=\"token punctuation\">></span></span>Sheet1!$B$2:$B$5<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>f</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>numCache</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>formatCode</span><span class=\"token punctuation\">></span></span>General<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>formatCode</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>ptCount</span> <span class=\"token attr-name\">val</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{{.ChartData | len | print}}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n            {{range $index, $element := .ChartData}}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>pt</span> <span class=\"token attr-name\">idx</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{{$index | print}}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                {{/* value */}}\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">c:</span>v</span><span class=\"token punctuation\">></span></span>{{$element.Value}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>v</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>pt</span><span class=\"token punctuation\">></span></span>\n            {{end}}\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>numCache</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>numRef</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">c:</span>val</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ol start=\"3\">\n<li>最后把<code class=\"language-text\">结果模板文件夹</code>的集合压缩为 zip 包，然后重命名为.docx 这就是一个根据数据生成的 word 文档啦！可以直接返回给前端了。最终渲染的 word 文档如下\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7ae124d2765508f2b806b00b4af0b0af/63c98/5.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB3LCZXkFH/8QAGhAAAQUBAAAAAAAAAAAAAAAAAQACESAhMf/aAAgBAQABBQLaQ4Ic/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8BCf/EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/AVn/xAAXEAADAQAAAAAAAAAAAAAAAAACECCh/9oACAEBAAY/AoPF/8QAGxAAAwACAwAAAAAAAAAAAAAAAAERITEQQbH/2gAIAQEAAT8hwbnoq+K6sCqLbYqLvs//2gAMAwEAAgADAAAAEJ/P/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERQf/aAAgBAwEBPxCzUv/EABcRAQADAAAAAAAAAAAAAAAAAAABEUH/2gAIAQIBAT8QoxD/xAAeEAEAAgEEAwAAAAAAAAAAAAABABEhMUFRoWFxgf/aAAgBAQABPxCmiIu66Nowyg+CBy3EAGjq2YhGZcu2adT0GfU//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5\"\n        title=\"5\"\n        src=\"/static/7ae124d2765508f2b806b00b4af0b0af/e5166/5.jpg\"\n        srcset=\"/static/7ae124d2765508f2b806b00b4af0b0af/f93b5/5.jpg 300w,\n/static/7ae124d2765508f2b806b00b4af0b0af/b4294/5.jpg 600w,\n/static/7ae124d2765508f2b806b00b4af0b0af/e5166/5.jpg 1200w,\n/static/7ae124d2765508f2b806b00b4af0b0af/63c98/5.jpg 1392w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></li>\n</ol>\n<h3 id=\"优缺点\" style=\"position:relative;\"><a href=\"#%E4%BC%98%E7%BC%BA%E7%82%B9\" aria-label=\"优缺点 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点：</p>\n<ul>\n<li>这里的图表就可以交互和修改了！</li>\n<li>性能也很好，没有依赖其他第三方库。</li>\n<li>可以根据相应的 xml 修改 word 样式(当然 Docx 也可以)</li>\n</ul>\n</li>\n<li>缺点：每个请求都要生成一个解压后的模板文件夹，如果请求过多，文件夹占用的内存较大。</li>\n</ul>\n<blockquote>\n<p><a href=\"https://github.com/pipihua666/export-word/tree/master/export-node\">完整项目参考代码戳这里</a></p>\n</blockquote>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://juejin.cn/post/6850037262445445134#heading-1\">在前端如何玩转 Word 文档</a></li>\n<li><a href=\"http://xuxiaoyang.site/2019/03/25/node-echarts/\">node+echarts 实现服务器端渲染可视化图表</a></li>\n</ul>"},{"id":"bf8f5b68-84d3-57af-82c0-1cf366136372","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"广度优先算法","path":"/bfa","tags":["ALG"],"excerpt":"1. 使用队列建立图模型 <br />2.js实现使用广度优先算法解决实际问题","created":"2021-06-21T00:00:00.000Z","createdPretty":"21 June, 2021","updated":"2021-06-24 22:34","updatedPretty":"21 June, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHRaZ0CcP/EABcQAQEBAQAAAAAAAAAAAAAAAAEAAhD/2gAIAQEAAQUCDiWdM6Z1f//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAAQMQH/2gAIAQEABj8CV1w//8QAGhAAAgMBAQAAAAAAAAAAAAAAAAERITFRwf/aAAgBAQABPyFfWQ41lnkZiNTgswf/2gAMAwEAAgADAAAAEHTf/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8QiP/EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EKr/xAAaEAEBAQADAQAAAAAAAAAAAAABEQBBUWGR/9oACAEBAAE/EJKAPCZsGXhj2CmJm3sDUd+G/9k=","aspectRatio":1.5060240963855422,"src":"/static/cc972802710b0b1e33aba1c0bc2ae052/ba9ae/header.jpg","srcSet":"/static/cc972802710b0b1e33aba1c0bc2ae052/86d0f/header.jpg 125w,\n/static/cc972802710b0b1e33aba1c0bc2ae052/520da/header.jpg 250w,\n/static/cc972802710b0b1e33aba1c0bc2ae052/ba9ae/header.jpg 500w,\n/static/cc972802710b0b1e33aba1c0bc2ae052/72227/header.jpg 750w,\n/static/cc972802710b0b1e33aba1c0bc2ae052/5c39c/header.jpg 1000w,\n/static/cc972802710b0b1e33aba1c0bc2ae052/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"深度和广度优先算法\" style=\"position:relative;\"><a href=\"#%E6%B7%B1%E5%BA%A6%E5%92%8C%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E7%AE%97%E6%B3%95\" aria-label=\"深度和广度优先算法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>深度和广度优先算法</h2>\n<ol>\n<li>深度优先算法：使用栈实现，思想是一条路走到底，然后转过头再走另外的路</li>\n<li>广度优先算法：使用队列实现，思想是先遍历邻居，再遍历邻居的邻居，依次类推...</li>\n</ol>\n<h2 id=\"图是什么？\" style=\"position:relative;\"><a href=\"#%E5%9B%BE%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F\" aria-label=\"图是什么？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>图是什么？</h2>\n<p>图由节点和边组成，一个节点可能和众多节点相连，这个相邻的节点称为邻居。</p>\n<h2 id=\"广度优先算法解决的问题\" style=\"position:relative;\"><a href=\"#%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E7%AE%97%E6%B3%95%E8%A7%A3%E5%86%B3%E7%9A%84%E9%97%AE%E9%A2%98\" aria-label=\"广度优先算法解决的问题 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>广度优先算法解决的问题</h2>\n<ol>\n<li>从 A 节点触发，有前往 B 节点的路径吗？</li>\n<li>从 A 节点触发，到 B 节点的最短路径。</li>\n</ol>\n<h2 id=\"查找你的关系网中是否会有芒果商\" style=\"position:relative;\"><a href=\"#%E6%9F%A5%E6%89%BE%E4%BD%A0%E7%9A%84%E5%85%B3%E7%B3%BB%E7%BD%91%E4%B8%AD%E6%98%AF%E5%90%A6%E4%BC%9A%E6%9C%89%E8%8A%92%E6%9E%9C%E5%95%86\" aria-label=\"查找你的关系网中是否会有芒果商 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>查找你的关系网中是否会有芒果商</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b9190053f25f6352fc3102059f6e8e30/1d5ac/question.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3lAH/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABPyFf/9oADAMBAAIAAwAAABDAz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQACAwEAAAAAAAAAAAAAAAEAERAxQVH/2gAIAQEAAT8QvyN9hqJALx//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"question\"\n        title=\"question\"\n        src=\"/static/b9190053f25f6352fc3102059f6e8e30/e5166/question.jpg\"\n        srcset=\"/static/b9190053f25f6352fc3102059f6e8e30/f93b5/question.jpg 300w,\n/static/b9190053f25f6352fc3102059f6e8e30/b4294/question.jpg 600w,\n/static/b9190053f25f6352fc3102059f6e8e30/e5166/question.jpg 1200w,\n/static/b9190053f25f6352fc3102059f6e8e30/1d5ac/question.jpg 1424w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>js 使用广度优先算法进行芒果商的查找</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 通过散列表映射关系网</span>\n<span class=\"token keyword\">const</span> hasMango <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\">string</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> network <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    小明<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"小红\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"小芳\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    小红<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"小明\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"小东\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    小芳<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"小明\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"小爱\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    小东<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"小红\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"小晓\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"小波\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    小爱<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"小芳\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"小晓\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    小晓<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"小东\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"小爱\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> queue <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token comment\">// 需要检查的人</span>\n  <span class=\"token keyword\">const</span> isChecked <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token comment\">// 检查完的人</span>\n  queue<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"小明\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>queue<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> people <span class=\"token operator\">=</span> queue<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 抽一个人出来</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>isChecked<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>people<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>people<span class=\"token punctuation\">.</span>job <span class=\"token operator\">===</span> <span class=\"token string\">\"芒果商\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> people\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 如果这个人不是芒果商，把这个人推入检查队列，并把他的狐朋狗友加入queue队列</span>\n        isChecked<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>people<span class=\"token punctuation\">)</span>\n        queue<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>network<span class=\"token punctuation\">[</span>people<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string\">\"\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>"},{"id":"a2ae6f42-bfc1-5a85-9042-9663e1331f60","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"快速排序的js实现","path":"/quick-sort","tags":["ALG"],"excerpt":"快速排序的js实现及其应用，再说说js的sort方法吧","created":"2021-06-16T00:00:00.000Z","createdPretty":"16 June, 2021","updated":"2021-06-16T00:00:00.000Z","updatedPretty":"16 June, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgADBP/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB5TgtFCT/xAAZEAADAAMAAAAAAAAAAAAAAAAAAQIQEhP/2gAIAQEAAQUC6UVdUNZ2P//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAAgIUGh/9oACAEBAAY/AqJxf//EABgQAQEBAQEAAAAAAAAAAAAAAAEAESFh/9oACAEBAAE/IT2wgcEdxDntqs6b21f/2gAMAwEAAgADAAAAELP/AP/EABYRAQEBAAAAAAAAAAAAAAAAAAEAMf/aAAgBAwEBPxAQ22//xAAXEQEBAQEAAAAAAAAAAAAAAAABACEx/9oACAECAQE/EEXkZf/EABoQAAIDAQEAAAAAAAAAAAAAAAERACExQYH/2gAIAQEAAT8QFR8FkWGx8QvZBTXDQlNcnaHBcBBYyf/Z","aspectRatio":1.5060240963855422,"src":"/static/39b62a4c971eb9873ef9797217eff527/ba9ae/header.jpg","srcSet":"/static/39b62a4c971eb9873ef9797217eff527/86d0f/header.jpg 125w,\n/static/39b62a4c971eb9873ef9797217eff527/520da/header.jpg 250w,\n/static/39b62a4c971eb9873ef9797217eff527/ba9ae/header.jpg 500w,\n/static/39b62a4c971eb9873ef9797217eff527/72227/header.jpg 750w,\n/static/39b62a4c971eb9873ef9797217eff527/5c39c/header.jpg 1000w,\n/static/39b62a4c971eb9873ef9797217eff527/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"分而治之-dc\" style=\"position:relative;\"><a href=\"#%E5%88%86%E8%80%8C%E6%B2%BB%E4%B9%8B-dc\" aria-label=\"分而治之 dc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>分而治之 D&#x26;C</h2>\n<blockquote>\n<p>并非可用于解决问题的算法，而是一种解决问题的思路</p>\n</blockquote>\n<ol>\n<li>找出简单的基线条件；</li>\n<li>确定如何缩小问题的规模，使其符合基线条件</li>\n</ol>\n<h2 id=\"快速排序\" style=\"position:relative;\"><a href=\"#%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F\" aria-label=\"快速排序 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>快速排序</h2>\n<blockquote>\n<p>思想是：在长度>=2 的数组中随机取出一个数组项 A，把 A 大的项放在右边，比 A 小的项放在左边，依次类推。</p>\n</blockquote>\n<p>代码实现：</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">quickSort</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>arr<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> arr <span class=\"token comment\">// 基线条件，为空或者长度为1的数组是有序的，不用再排序</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> lessArr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token comment\">// 比基线值小的项</span>\n  <span class=\"token keyword\">const</span> moreArr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token comment\">// 比基线值大的项</span>\n  <span class=\"token keyword\">const</span> pivot <span class=\"token operator\">=</span> arr<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 选择基准值(随机)</span>\n  arr<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>item <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item <span class=\"token operator\">>=</span> pivot<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      moreArr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      lessArr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token function\">quickSort</span><span class=\"token punctuation\">(</span>lessArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> pivot<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token function\">quickSort</span><span class=\"token punctuation\">(</span>moreArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"js-的-sort-方法\" style=\"position:relative;\"><a href=\"#js-%E7%9A%84-sort-%E6%96%B9%E6%B3%95\" aria-label=\"js 的 sort 方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JS 的 sort 方法</h2>\n<blockquote>\n<p>V8 引擎 sort 函数只给出了两种排序 InsertionSort 和 QuickSort，数组长度小于等于 22 的用插入排序 InsertionSort，比 22 大的数组则使用快速排序 QuickSort。源码中这样写道：</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Quicksort is used for arrays which length > 22</span>\n<span class=\"token comment\">// Arrays which length > 1000 guarantee GetThirdIndex is executed</span></code></pre></div>\n<p><a href=\"https://github.com/v8/v8/blob/dc712da548c7fb433caed56af9a021d964952728/test/mjsunit/array-sort.js\">源码链接</a></p>\n<h2 id=\"小结\" style=\"position:relative;\"><a href=\"#%E5%B0%8F%E7%BB%93\" aria-label=\"小结 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>小结</h2>\n<ul>\n<li>使用 D&#x26;C 处理列表的时候，基线条件很可能是空数组或只包含一个元素的数组</li>\n<li>实现快速排序时，请随机选择用作基准值的元素。快速排序的平均运行事件 <code class=\"language-text\">O(nlogn)</code></li>\n<li>大 O 表示法中的常量有时候事关重大，这就是快排比归并排序快的原因所在</li>\n<li>比较简单查找和二分查找时，常量几乎无关紧要，因为列表很长时，<code class=\"language-text\">O(logn)</code>要比<code class=\"language-text\">O(n)</code>快得多</li>\n</ul>"},{"id":"a2a727d5-7017-51e6-a29f-15c594f1fb72","headings":[{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"Hooks核心05","path":"/nginx-hooks5","tags":["React"],"excerpt":"hooks的最佳实践与概念,包括：创建自定义 hooks,React 中的状态管理,React 中的原生事件","created":"2021-06-10 22:45","createdPretty":"10 June, 2021","updated":"2021-06-20 16:59","updatedPretty":"10 June, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAACAP/aAAwDAQACEAMQAAABXuN5uoRBX//EABkQAQEBAQEBAAAAAAAAAAAAAAECACESE//aAAgBAQABBQJdFGK59ad75CJ//8QAFxEBAAMAAAAAAAAAAAAAAAAAAAEREv/aAAgBAwEBPwGoZf/EABYRAAMAAAAAAAAAAAAAAAAAAAABEv/aAAgBAgEBPwGmWj//xAAbEAABBAMAAAAAAAAAAAAAAAAAATEyoQIQkf/aAAgBAQAGPwKCkbGTpjprP//EABoQAAIDAQEAAAAAAAAAAAAAAAERACExEFH/2gAIAQEAAT8hbZR6xGqLjRxseQFZBGlLDgx//9oADAMBAAIAAwAAABDoz//EABYRAQEBAAAAAAAAAAAAAAAAAAEAYf/aAAgBAwEBPxAgWX//xAAXEQEBAQEAAAAAAAAAAAAAAAABABEh/9oACAECAQE/EHLsk4rf/8QAGxABAQEBAQADAAAAAAAAAAAAAREAIWExcfD/2gAIAQEAAT8QNhlx5hwhSDLENET9frIpjLxT4fc5dRx4S5xeocRv/9k=","aspectRatio":1.5060240963855422,"src":"/static/689e34cb8281ab9093a3b5ef10c6731b/ba9ae/header.jpg","srcSet":"/static/689e34cb8281ab9093a3b5ef10c6731b/86d0f/header.jpg 125w,\n/static/689e34cb8281ab9093a3b5ef10c6731b/520da/header.jpg 250w,\n/static/689e34cb8281ab9093a3b5ef10c6731b/ba9ae/header.jpg 500w,\n/static/689e34cb8281ab9093a3b5ef10c6731b/72227/header.jpg 750w,\n/static/689e34cb8281ab9093a3b5ef10c6731b/5c39c/header.jpg 1000w,\n/static/689e34cb8281ab9093a3b5ef10c6731b/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"创建自定义-hooks\" style=\"position:relative;\"><a href=\"#%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89-hooks\" aria-label=\"创建自定义 hooks permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>创建自定义 hooks</h2>\n<p><b>声明名字以 use 开头的函数</b>，比如 useCounter，这个函数在形式上和普通的 js 函数没有任何区别，你可以传递任意参数给这个 hook，也可以返回任何值。但是要注意，hooks 和普通函数的区别是自定义 hooks 一定要用到其他的 hooks。</p>\n<ol>\n<li>名字一定是以 use 开头的函数，这样 react 才能够知道这个函数是一个 hooks</li>\n<li>函数内部一定调用了其他的 hooks，可以是内置的 hooks，也可以是其他自定义 hooks。这样能够让组件刷新，或者去产生副作用。</li>\n</ol>\n<p>四个典型的使用场景：</p>\n<ol>\n<li>抽取业务逻辑；</li>\n<li>封装通用逻辑；</li>\n<li>监听浏览器状态；</li>\n<li>拆分复杂组件。</li>\n</ol>\n<blockquote>\n<p>要经常撕开哪些逻辑应该封装到一个独立的 hook，保证每个 hook 的短小精悍，从而让代码更加清晰，易于理解和维护。</p>\n</blockquote>\n<h2 id=\"react-中的状态管理\" style=\"position:relative;\"><a href=\"#react-%E4%B8%AD%E7%9A%84%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86\" aria-label=\"react 中的状态管理 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React 中的状态管理</h2>\n<blockquote>\n<p>react 中的 ui 完全是通过状态驱动的。所以在任何时候，整个应用程序的状态数据就完全决定了当前 ui 上得展现。毫不夸张地说，react 的开发其实就是>复杂应用状态的管理和开发。因此，需要你思考，<b>该怎么去用最优、最合理的方式，去管理你的应用程序的状态。</b><br/></p>\n</blockquote>\n<p>以下两个原则可以帮助我们避免复杂的状态管理逻辑，简化应用程序的开发。</p>\n<ol>\n<li>状态最小化原则，也就是说要避免冗余的状态；</li>\n<li>唯一数据源原则，避免中间状态。</li>\n</ol>\n<blockquote>\n<p>所以在任何时候想要定义新状态时，都要问问自己：<b>这个状态有必要吗？是否能通过计算得到？是否是一个中间状态？</b></p>\n</blockquote>\n<h2 id=\"react-中的原生事件\" style=\"position:relative;\"><a href=\"#react-%E4%B8%AD%E7%9A%84%E5%8E%9F%E7%94%9F%E4%BA%8B%E4%BB%B6\" aria-label=\"react 中的原生事件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React 中的原生事件</h2>\n<p>React17 之前所有的事件都是绑定在 document 上，而从 react17 开始绑定在整个 App 的根节点上，<b>这主要为了以后页面上可能存在的多版本 React 的考虑。</b><br />\n具体来说，React 这样做得原因主要有两个。</p>\n<ol>\n<li>虚拟 Dom render 的时候，dom 很可能还没有真实的 render 到页面上，所以无法绑定事件。</li>\n<li>React 可以屏蔽底层事件的细节，避免浏览器的兼容性问题。同时，对于 React Native 这种不是通过浏览器 render 的运行时，也能提供一致的 API。</li>\n</ol>\n<p>为什么事件绑定在某个根节点上，也能触发实际 dom 节点的事件？</p>\n<blockquote>\n<p>因为浏览器的事件冒泡模型，根节点可以通过事件的 srcElement 属性知道哪个节点发出的事件，这样 React 就可以收集所有的事件，然后再以一直的 API 暴露出来。</p>\n</blockquote>"},{"id":"767d842d-d821-5da3-ba7a-a83d1040af38","headings":[{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":2}],"frontmatter":{"title":"Hooks核心04","path":"/nginx-hooks4","tags":["React"],"excerpt":"进一步认识Hooks：如果正确理解函数组件的生命周期","created":"2021-06-08 23:27","createdPretty":"08 June, 2021","updated":"2021-06-08 23:27","updatedPretty":"08 June, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAABjmW2iseN/8QAGRABAQEBAQEAAAAAAAAAAAAAAQIDAAQU/9oACAEBAAEFAoyaDOmjxapWtvG9yfVff//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/Aar/xAAcEAACAQUBAAAAAAAAAAAAAAAAARESIUFCgeH/2gAIAQEABj8CuUpSzVdIk8MH/8QAGhABAAIDAQAAAAAAAAAAAAAAAQARIUFxUf/aAAgBAQABPyFmChJZn4kuDwYpsPMSoCHBKtKf/9oADAMBAAIAAwAAABCoD//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/EIf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxAp/8QAHhABAQABBAMBAAAAAAAAAAAAAREAMUFRkSFxgaH/2gAIAQEAAT8QQQoV2ySO1Gz3xgBVeUnQ4WsjSY+85M+DzFfzAALDdJes/9k=","aspectRatio":1.4367816091954022,"src":"/static/d5b9838617fd49995727c5592f50b92b/ba9ae/header.jpg","srcSet":"/static/d5b9838617fd49995727c5592f50b92b/86d0f/header.jpg 125w,\n/static/d5b9838617fd49995727c5592f50b92b/520da/header.jpg 250w,\n/static/d5b9838617fd49995727c5592f50b92b/ba9ae/header.jpg 500w,\n/static/d5b9838617fd49995727c5592f50b92b/72227/header.jpg 750w,\n/static/d5b9838617fd49995727c5592f50b92b/5c39c/header.jpg 1000w,\n/static/d5b9838617fd49995727c5592f50b92b/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"忘掉-class-组件的声明周期\" style=\"position:relative;\"><a href=\"#%E5%BF%98%E6%8E%89-class-%E7%BB%84%E4%BB%B6%E7%9A%84%E5%A3%B0%E6%98%8E%E5%91%A8%E6%9C%9F\" aria-label=\"忘掉 class 组件的声明周期 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>忘掉 class 组件的声明周期</h2>\n<blockquote>\n<p>在函数组件中你要思考的方式永远是:<b>当某个状态发生变化时，我要做什么</b>，而不再是在 class 组件中的某个生命周期方法中我要做什么。</p>\n</blockquote>\n<h2 id=\"重新思考组件的生命周期\" style=\"position:relative;\"><a href=\"#%E9%87%8D%E6%96%B0%E6%80%9D%E8%80%83%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F\" aria-label=\"重新思考组件的生命周期 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>重新思考组件的生命周期</h2>\n<h3 id=\"构造函数\" style=\"position:relative;\"><a href=\"#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0\" aria-label=\"构造函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>构造函数</h3>\n<blockquote>\n<p>在 class 中有个方法叫<code class=\"language-text\">constructor</code>，也就是构造函数，在里面我们会做一些初始化的事情，其实就是<b>在其他代码执行之前的一次性初始工作</b>。</p>\n</blockquote>\n<p>我们可以在函数组件中使用<code class=\"language-text\">useRef</code>来实现一个 useSinleton 这样的一次性执行某段代码的自定义 hook，代码如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useRef <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">useSinleton</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 使用called ref来标记callback是否被执行过</span>\n  <span class=\"token keyword\">const</span> called <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 如果执行过，则直接返回</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>called<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span>\n  <span class=\"token comment\">// 第一次调用直接执行</span>\n  <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 标记执行过</span>\n  called<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>那么我们就可以这样去使用：</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> useSinleton <span class=\"token keyword\">from</span> <span class=\"token string\">'./useSinleton'</span>\n<span class=\"token keyword\">function</span> <span class=\"token function-variable function\">Mydemo</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 使用自定义hook</span>\n    <span class=\"token function\">useSinleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"这段代码只执行一次！\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">My demo</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"三种常用的生命周期方法\" style=\"position:relative;\"><a href=\"#%E4%B8%89%E7%A7%8D%E5%B8%B8%E7%94%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%96%B9%E6%B3%95\" aria-label=\"三种常用的生命周期方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>三种常用的生命周期方法</h3>\n<blockquote>\n<ul>\n<li>在类组件中,<code class=\"language-text\">componentDidMount</code>,<code class=\"language-text\">componentWillUnmout</code>,<code class=\"language-text\">componentDidUpdate</code>最为常用<br></li>\n<li>在函数组件中，这三者可以统一到 useEffect 这个 hook,正如 useEffect 这个字面函数，其作用就是触发副作用，即在组件每次 render 之后去执行。</li>\n</ul>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 等价componentDidMount,componentDidUpdate</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 等价componentWillUnmout</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>deps<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><b>可以看到,useEffect 接收的 callback 参数，可以返回一个用于清理资源的函数，从而在下一次同样的 useEffect 被执行之前被调用</b></p>\n<ol>\n<li>useEffect(callback)，这个 hook 接收 callback，只有在依赖项发生变化时才被执行。而 <code class=\"language-text\">componentDidUpdate</code> 则一定会执行。</li>\n<li>callback 返回的函数（一般用于清理工作）在下一次依赖项发生变化时以及组件销毁<b>「之前」</b>执行，而 <code class=\"language-text\">componentWillUnmout</code> 只有在组件销毁时执行。</li>\n</ol>\n<h2 id=\"思考：useeffect-如果实现只有在组件销毁时或组件挂载完成时才执行\" style=\"position:relative;\"><a href=\"#%E6%80%9D%E8%80%83%EF%BC%9Auseeffect-%E5%A6%82%E6%9E%9C%E5%AE%9E%E7%8E%B0%E5%8F%AA%E6%9C%89%E5%9C%A8%E7%BB%84%E4%BB%B6%E9%94%80%E6%AF%81%E6%97%B6%E6%88%96%E7%BB%84%E4%BB%B6%E6%8C%82%E8%BD%BD%E5%AE%8C%E6%88%90%E6%97%B6%E6%89%8D%E6%89%A7%E8%A1%8C\" aria-label=\"思考：useeffect 如果实现只有在组件销毁时或组件挂载完成时才执行 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>思考：useEffect 如果实现只有在组件销毁时或组件挂载完成时才执行?</h2>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// 关键是依赖项是空数组,表示render完后只执行一次</span>\n<span class=\"token comment\">// 如果有依赖项，则在render后依赖项变化，再去执行return的销毁函数，然后是callback函数</span></code></pre></div>"},{"id":"4750de19-3453-5f59-99b3-0f723f09d89e","headings":[{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":2}],"frontmatter":{"title":"Hooks核心03","path":"/nginx-hooks3","tags":["React"],"excerpt":"3个常用内置hooks：解决函数组件中遇到的特定问题","created":"2021-06-01 23:00","createdPretty":"01 June, 2021","updated":"2021-06-07 21:57","updatedPretty":"01 June, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAQX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABkdz9hxMH/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAISAwH/2gAIAQEAAQUCVMzueRCF9LKP/8QAFREBAQAAAAAAAAAAAAAAAAAAACH/2gAIAQMBAT8BiP/EABURAQEAAAAAAAAAAAAAAAAAAAAh/9oACAECAQE/Aar/xAAYEAACAwAAAAAAAAAAAAAAAAAAIDFBkf/aAAgBAQAGPwK8JX//xAAaEAADAAMBAAAAAAAAAAAAAAAAAREhMVGR/9oACAEBAAE/IXNtBBh/B0wxW0i+FH//2gAMAwEAAgADAAAAEL8//8QAFhEAAwAAAAAAAAAAAAAAAAAAABFR/9oACAEDAQE/EFAoP//EABYRAQEBAAAAAAAAAAAAAAAAAAARUf/aAAgBAgEBPxC6U//EABoQAQADAAMAAAAAAAAAAAAAAAEAETEhQXH/2gAIAQEAAT8Qoxx6VBNQhzG015DBs3SKXxL2mPWoez//2Q==","aspectRatio":1.5060240963855422,"src":"/static/5d09d84d218ee9db9c12c56401c91adc/ba9ae/header.jpg","srcSet":"/static/5d09d84d218ee9db9c12c56401c91adc/86d0f/header.jpg 125w,\n/static/5d09d84d218ee9db9c12c56401c91adc/520da/header.jpg 250w,\n/static/5d09d84d218ee9db9c12c56401c91adc/ba9ae/header.jpg 500w,\n/static/5d09d84d218ee9db9c12c56401c91adc/72227/header.jpg 750w,\n/static/5d09d84d218ee9db9c12c56401c91adc/5c39c/header.jpg 1000w,\n/static/5d09d84d218ee9db9c12c56401c91adc/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"usecallback：缓存回调函数避免子组件重复渲染\" style=\"position:relative;\"><a href=\"#usecallback%EF%BC%9A%E7%BC%93%E5%AD%98%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E9%81%BF%E5%85%8D%E5%AD%90%E7%BB%84%E4%BB%B6%E9%87%8D%E5%A4%8D%E6%B8%B2%E6%9F%93\" aria-label=\"usecallback：缓存回调函数避免子组件重复渲染 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useCallback：缓存回调函数(避免子组件重复渲染)</h2>\n<p><code class=\"language-text\">const cb = useCallback(fn,deps)</code><br>\n这里的 fn 是定义的回调函数，deps 是依赖的变量数组。只有当某个依赖变量发生变化时，才会重新声明 fn 这个回调函数。</p>\n<blockquote>\n<p>在 react 函数组件中，每一次的 ui 变化，都是通过重新执行函数来完成了，和 class 组件不一样，没有一个直接的方式在多次渲染之间维持一个状态。</p>\n</blockquote>\n<p>如下，每次创建新函数会让接收事件处理函数的组件重新渲染。</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Parent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleChirden</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>state <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 每次创建新函数的方式会让接收事件处理函数的组件重新渲染</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Children</span></span> <span class=\"token attr-name\">handler</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleChirden<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>所以 <code class=\"language-text\">useCallback</code> 可以通过定义依赖项：只有当<code class=\"language-text\">deps</code>发生变化时，才需要重新定义一个回调函数</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useCallback <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Parent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 只有当state发生变化时，才会重新创建回调函数</span>\n  <span class=\"token keyword\">const</span> handleChirden <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>state <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Children</span></span> <span class=\"token attr-name\">handler</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleChirden<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"usememo：缓存计算的结果（避免重复计算、避免子组件重复渲染）\" style=\"position:relative;\"><a href=\"#usememo%EF%BC%9A%E7%BC%93%E5%AD%98%E8%AE%A1%E7%AE%97%E7%9A%84%E7%BB%93%E6%9E%9C%EF%BC%88%E9%81%BF%E5%85%8D%E9%87%8D%E5%A4%8D%E8%AE%A1%E7%AE%97%E3%80%81%E9%81%BF%E5%85%8D%E5%AD%90%E7%BB%84%E4%BB%B6%E9%87%8D%E5%A4%8D%E6%B8%B2%E6%9F%93%EF%BC%89\" aria-label=\"usememo：缓存计算的结果（避免重复计算、避免子组件重复渲染） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useMemo：缓存计算的结果（避免重复计算、避免子组件重复渲染）</h2>\n<p><code class=\"language-text\">const result = useMemo(fn,deps)</code><br>\n这里的 fn 是产生所需数据的一个计算函数。通常来说，fn 会使用 deps 中声明的一些变量来生成一个结果没用来渲染出最终的 ui。</p>\n<blockquote>\n<p>场景：如果某个数据时通过其他数据计算得到的，那么只有当用到的数据，也就是依赖项的数据发生变化时，才需要重新计算。</p>\n</blockquote>\n<h3 id=\"避免重复计算\" style=\"position:relative;\"><a href=\"#%E9%81%BF%E5%85%8D%E9%87%8D%E5%A4%8D%E8%AE%A1%E7%AE%97\" aria-label=\"避免重复计算 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>避免重复计算</h3>\n<p>举个 🌰：当你需要根据购物车筛选出你想要的商品时，你可能会如下实现：</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Demo</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 后端返回的购物车数据</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>shopCart<span class=\"token punctuation\">,</span>setShopCart<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 搜索关键词</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>keyWord<span class=\"token punctuation\">,</span>setKeyWord<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> useState<span class=\"token punctuation\">[</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">let</span> goods <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>shopCart<span class=\"token operator\">?.</span>length<span class=\"token operator\">></span><span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> keyWord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 每次都会重新过滤</span>\n    goods <span class=\"token operator\">=</span> shopCart<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">good</span> <span class=\"token operator\">=></span> good<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>keyWord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>goods<span class=\"token operator\">?.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">good</span> <span class=\"token operator\">=></span> good<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>在这个例子中，组件的每次渲染都会进行一次过滤操作，但你只需要在购物车数据和关键词某一个数据变化时，才重新计算需要展示的数据就行了。</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">//..</span>\n<span class=\"token comment\">// 使用useMem缓存计算结果</span>\ngoods <span class=\"token operator\">=</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> shopCart<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">good</span> <span class=\"token operator\">=></span> good<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>keyWord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>shopCart<span class=\"token punctuation\">,</span> keyWord<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//..</span></code></pre></div>\n<h3 id=\"避免重复渲染\" style=\"position:relative;\"><a href=\"#%E9%81%BF%E5%85%8D%E9%87%8D%E5%A4%8D%E6%B8%B2%E6%9F%93\" aria-label=\"避免重复渲染 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>避免重复渲染</h3>\n<blockquote>\n<p>useCallback 的功能其实可以用 useMemo 来实现。</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> cb <span class=\"token operator\">=</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 返回一个函数作为缓存结果</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 在这里进行事件处理</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>deps<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>总结：这两个 API 只是做了同一件事情：<b>建立了一个绑定某个结果到依赖数据的关系。只有当依赖变了，这个结果才需要被重新计算得到</b></p>\n<h2 id=\"useref：在多次渲染之间共享数据\" style=\"position:relative;\"><a href=\"#useref%EF%BC%9A%E5%9C%A8%E5%A4%9A%E6%AC%A1%E6%B8%B2%E6%9F%93%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE\" aria-label=\"useref：在多次渲染之间共享数据 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useRef：在多次渲染之间共享数据</h2>\n<p><code class=\"language-text\">const ref = useRef(initialValue)</code><br>\n我们可以把 useRef 看做是在函数组件之外创建的一个容器空间。在这个容器上，我们可以通过唯一的 current 属性设置一个值，从而在函数组件的多次渲染之间共享这个值。</p>\n<blockquote>\n<p>在类组件可以定义类的成员变量（属性），以便能在对象上通过成员属性去保存一些数据。但是在函数组件中，是没有这样一个空间去保存数据的。</p>\n</blockquote>\n<p>举个 🌰：保存计时器的引用，操作计时器的开始和暂停</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> timer <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// 开始计时器</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleStart</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  timer<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 一些操作</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 暂时计时器</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handlePause</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>timer<span class=\"token punctuation\">.</span>current<span class=\"token punctuation\">)</span>\n  timer<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"保存某个-dom-节点的引用\" style=\"position:relative;\"><a href=\"#%E4%BF%9D%E5%AD%98%E6%9F%90%E4%B8%AA-dom-%E8%8A%82%E7%82%B9%E7%9A%84%E5%BC%95%E7%94%A8\" aria-label=\"保存某个 dom 节点的引用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>保存某个 DOM 节点的引用</h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">TextInputWithFocusButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> inputEl <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onButtonClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// current属性指向了真实的input这个dom节点，从而可以调用focus方法</span>\n    inputEl<span class=\"token punctuation\">,</span> current<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>inputEl<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"思考usestate-也可以在多少渲染之间共享数据，那么能否使用-state-来保存-useref-例子中的-timer-呢？\" style=\"position:relative;\"><a href=\"#%E6%80%9D%E8%80%83usestate-%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%9C%A8%E5%A4%9A%E5%B0%91%E6%B8%B2%E6%9F%93%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE%EF%BC%8C%E9%82%A3%E4%B9%88%E8%83%BD%E5%90%A6%E4%BD%BF%E7%94%A8-state-%E6%9D%A5%E4%BF%9D%E5%AD%98-useref-%E4%BE%8B%E5%AD%90%E4%B8%AD%E7%9A%84-timer-%E5%91%A2%EF%BC%9F\" aria-label=\"思考usestate 也可以在多少渲染之间共享数据，那么能否使用 state 来保存 useref 例子中的 timer 呢？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>思考:useState 也可以在多少渲染之间共享数据，那么能否使用 state 来保存 useRef 例子中的 timer 呢？</h2>\n<p>当然可以，只是 useRef 更优。更新 state 会导致重新渲染，而 ref 是不会的。</p>"},{"id":"0b258dd0-75e0-58ee-9d0f-62078b300a35","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"Hooks核心02","path":"/nginx-hooks2","tags":["React"],"excerpt":"两个核心Hook：掌握 React 函数组件的开发思路","created":"2021-05-30 21:54","createdPretty":"30 May, 2021","updated":"2021-05-30 21:54","updatedPretty":"30 May, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgT/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAP/2gAMAwEAAhADEAAAAZau2E0xAf/EABkQAQEBAQEBAAAAAAAAAAAAAAEAAhEDIf/aAAgBAQABBQIzosCx5djXJ38W/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAES/9oACAEDAQE/AZWn/8QAFhEBAQEAAAAAAAAAAAAAAAAAABFB/9oACAECAQE/AcV//8QAHBAAAQMFAAAAAAAAAAAAAAAAAQACEBEyQVGB/9oACAEBAAY/AsJw4rhBpuP/xAAbEAEAAgIDAAAAAAAAAAAAAAABABEhMVFhcf/aAAgBAQABPyEl5EVBCmKGSfIgHdMXAq8u4l7n/9oADAMBAAIAAwAAABBUz//EABYRAAMAAAAAAAAAAAAAAAAAAAEQIf/aAAgBAwEBPxCJT//EABgRAQEAAwAAAAAAAAAAAAAAAAEAESFB/9oACAECAQE/EA2wQDl//8QAGxABAQADAQEBAAAAAAAAAAAAAREAITGxgZH/2gAIAQEAAT8Q1TCIW74eZDRcN6d9w6XiJTkyEEH9wRDuR1PV+4dggM//2Q==","aspectRatio":1.5060240963855422,"src":"/static/e7ba5183968db3fd78d0c8ac5deaac29/ba9ae/header.jpg","srcSet":"/static/e7ba5183968db3fd78d0c8ac5deaac29/86d0f/header.jpg 125w,\n/static/e7ba5183968db3fd78d0c8ac5deaac29/520da/header.jpg 250w,\n/static/e7ba5183968db3fd78d0c8ac5deaac29/ba9ae/header.jpg 500w,\n/static/e7ba5183968db3fd78d0c8ac5deaac29/72227/header.jpg 750w,\n/static/e7ba5183968db3fd78d0c8ac5deaac29/5c39c/header.jpg 1000w,\n/static/e7ba5183968db3fd78d0c8ac5deaac29/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"新思想的开始很重要\" style=\"position:relative;\"><a href=\"#%E6%96%B0%E6%80%9D%E6%83%B3%E7%9A%84%E5%BC%80%E5%A7%8B%E5%BE%88%E9%87%8D%E8%A6%81\" aria-label=\"新思想的开始很重要 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>新思想的开始很重要</h2>\n<blockquote>\n<p>如果已经习惯了类组件的开发，那么要做的，甚至是彻底忘掉那些生命周期方法。不要遇到一个需求，就映射到这个功能该在哪个生命周期中去做，然后又要去想原来的声明周期方法在函数组件中应该怎么用 Hooks 去实现。<br>\n正确的思路应该是<b>遇到需求时，直接考虑在 Hooks 中去如何实现</b>。</p>\n</blockquote>\n<h2 id=\"usestate：让函数组件具有维持状态的能力\" style=\"position:relative;\"><a href=\"#usestate%EF%BC%9A%E8%AE%A9%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6%E5%85%B7%E6%9C%89%E7%BB%B4%E6%8C%81%E7%8A%B6%E6%80%81%E7%9A%84%E8%83%BD%E5%8A%9B\" aria-label=\"usestate：让函数组件具有维持状态的能力 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useState：让函数组件具有维持状态的能力</h2>\n<blockquote>\n<p>原则：<b>state 中永远不要保存可以通过计算得到的值</b></p>\n</blockquote>\n<ol>\n<li><b>通过 props 传递过来的值</b>。</li>\n<li><b>从 URL 中读到的值。</b></li>\n<li><b>从 cookie、localStorage 中读取的值。</b></li>\n</ol>\n<h2 id=\"useeffect：执行副作用\" style=\"position:relative;\"><a href=\"#useeffect%EF%BC%9A%E6%89%A7%E8%A1%8C%E5%89%AF%E4%BD%9C%E7%94%A8\" aria-label=\"useeffect：执行副作用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useEffect：执行副作用</h2>\n<h3 id=\"什么是副作用？\" style=\"position:relative;\"><a href=\"#%E4%BB%80%E4%B9%88%E6%98%AF%E5%89%AF%E4%BD%9C%E7%94%A8%EF%BC%9F\" aria-label=\"什么是副作用？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>什么是副作用？</h3>\n<blockquote>\n<p>通常来说，副作用是<b>执行与当前结果无关的代码</b>。比如说要修改函数外部的某个变量，要发起一个请求，等等。也就是说，在函数组件的当次执行过程中，useEffect 中代码的执行是不影响渲染出来的 UI 的。</p>\n</blockquote>\n<p>useEffect 让我们能够在下面四种时机去执行一个回调函数产生副作用：</p>\n<ol>\n<li>每次 render 后执行：不提供第二个依赖项参数。比如 useEffect(() => {})。</li>\n<li>仅第一次 render 后执行：提供一个空数组作为依赖项。比如 useEffect(() => {}, [])。</li>\n<li>第一次以及依赖项发生变化后执行：提供依赖项数组。比如 useEffect(() => {}, [deps])。</li>\n<li>组件 unmount 后执行：返回一个回调函数。比如 useEffect() => { return () => {} }, [])。</li>\n</ol>\n<h2 id=\"理解-hooks-的依赖\" style=\"position:relative;\"><a href=\"#%E7%90%86%E8%A7%A3-hooks-%E7%9A%84%E4%BE%9D%E8%B5%96\" aria-label=\"理解 hooks 的依赖 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>理解 Hooks 的依赖</h2>\n<blockquote>\n<p>Hooks 提供了让你监听某个数据变化的能力。这个变化可能会触发组件的刷新，也可能是去创建一个副作用，又或者是刷新一个缓存。那么定义要监听哪些数据变化的机制，其实就是指定 Hooks 的<b>依赖项</b>。</p>\n</blockquote>\n<p>定义依赖项的注意点：</p>\n<ol>\n<li>依赖项中定义的变量一定是会在回调函数中用到的，否则声明依赖项其实是没有意义的。</li>\n<li>依赖项一般是一个常量数组，而不是一个变量。因为一般在创建 callback 的时候，你其实非常清楚其中要用到哪些依赖项了。</li>\n<li>React 会使用浅比较来对比依赖项是否发生了变化，所以要特别注意数组或者对象类型。如果你是每次创建一个新对象，即使和之前的值是等价的，也会被认为是依赖项发生了变化。（每次重新渲染函数，依赖项的地址发生的变化）</li>\n</ol>\n<h2 id=\"掌握-hooks-的使用规则\" style=\"position:relative;\"><a href=\"#%E6%8E%8C%E6%8F%A1-hooks-%E7%9A%84%E4%BD%BF%E7%94%A8%E8%A7%84%E5%88%99\" aria-label=\"掌握 hooks 的使用规则 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>掌握 Hooks 的使用规则</h2>\n<blockquote>\n<p>Hooks 本身作为纯粹的 JavaScript 函数，不是通过某个特殊的 API 去创建的，而是直接定义一个函数，所以需要遵循一定的规则才能正常的工作。</p>\n</blockquote>\n<p>使用规则如下：</p>\n<ol>\n<li>在 useEffect 的回调函数中使用的变量，都必须在依赖项中声明；</li>\n<li>Hooks 不能出现在条件语句或者循环中，也不能出现在 return 之后；</li>\n<li>Hooks 只能在函数组件或者自定义 Hooks 中使用。</li>\n</ol>\n<h2 id=\"class-组件就不能使用-hooks-了吗？\" style=\"position:relative;\"><a href=\"#class-%E7%BB%84%E4%BB%B6%E5%B0%B1%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8-hooks-%E4%BA%86%E5%90%97%EF%BC%9F\" aria-label=\"class 组件就不能使用 hooks 了吗？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>class 组件就不能使用 hooks 了吗？</h2>\n<blockquote>\n<p>利用高阶组件的模式，将 Hooks 封装成高阶组件，从而让类组件使用。</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useWindowSize <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../hooks/useWindowSize\"</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">withWindowSize</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">Component</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> windowSize <span class=\"token operator\">=</span> <span class=\"token function\">useWindowSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Component</span></span> <span class=\"token attr-name\">windowSize</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>windowSize<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">props</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> windowSize <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 通过 withWindowSize 高阶组件给 MyComp 添加 windowSize 属性</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withWindowSize</span><span class=\"token punctuation\">(</span>MyComponent<span class=\"token punctuation\">)</span></code></pre></div>"},{"id":"a7c0e162-d571-5eae-861d-d3d71131a234","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":2}],"frontmatter":{"title":"Hooks核心01","path":"/nginx-whyHooks","tags":["React"],"excerpt":"为什么react要发明hooks？两个原因告诉你","created":"2021-05-30 21:03","createdPretty":"30 May, 2021","updated":"2021-05-30 21:03","updatedPretty":"30 May, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAUBAgME/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAZuryJkcIn//xAAZEAACAwEAAAAAAAAAAAAAAAABAgAREgP/2gAIAQEAAQUCQBRrm5ZVvdqXImjP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Bp//EABkQAAMAAwAAAAAAAAAAAAAAAAAQEQEhQf/aAAgBAQAGPwK5J1bKv//EABoQAQACAwEAAAAAAAAAAAAAAAEAESExQWH/2gAIAQEAAT8hx1CCBCnkBpFWAaeymDmLU3sn/9oADAMBAAIAAwAAABAQH//EABYRAQEBAAAAAAAAAAAAAAAAAAEQIf/aAAgBAwEBPxAMn//EABURAQEAAAAAAAAAAAAAAAAAABAx/9oACAECAQE/EKP/xAAbEAEAAwADAQAAAAAAAAAAAAABABEhMVGh4f/aAAgBAQABPxDJk5VohCWtYs7iEPEQhSA1vfyPJixb5gSq7J//2Q==","aspectRatio":1.5060240963855422,"src":"/static/6a430d32156cd312ac7fd987e52fc861/ba9ae/header.jpg","srcSet":"/static/6a430d32156cd312ac7fd987e52fc861/86d0f/header.jpg 125w,\n/static/6a430d32156cd312ac7fd987e52fc861/520da/header.jpg 250w,\n/static/6a430d32156cd312ac7fd987e52fc861/ba9ae/header.jpg 500w,\n/static/6a430d32156cd312ac7fd987e52fc861/72227/header.jpg 750w,\n/static/6a430d32156cd312ac7fd987e52fc861/5c39c/header.jpg 1000w,\n/static/6a430d32156cd312ac7fd987e52fc861/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"react-本质\" style=\"position:relative;\"><a href=\"#react-%E6%9C%AC%E8%B4%A8\" aria-label=\"react 本质 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React 本质</h2>\n<blockquote>\n<p>就是 Modal 到 View 层的映射，当 Modal 中的状态发生变化时，UI 会自动变化，即所谓的<b>数据绑定</b></p>\n</blockquote>\n<p>所以，可以把 UI 看成的展现看成是函数的执行过程，当 state 或者 props 发生变化时，react 的函数（组件）会重新执行，生成新的虚拟 dom 并通过 react 以最优的方式更新到浏览器的真实 dom。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 326px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2ff70b6465c2f0a103ed25d4ed366af2/8a553/1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3aAH/8QAFRABAQAAAAAAAAAAAAAAAAAAEEH/2gAIAQEAAQUCp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABcQAQEBAQAAAAAAAAAAAAAAAAABITH/2gAIAQEAAT8h0qcf/9oADAMBAAIAAwAAABAAD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQEBAAMAAAAAAAAAAAAAABEBACFBcf/aAAgBAQABPxCVJ1lwh7nAu//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"映射\"\n        title=\"映射\"\n        src=\"/static/2ff70b6465c2f0a103ed25d4ed366af2/8a553/1.jpg\"\n        srcset=\"/static/2ff70b6465c2f0a103ed25d4ed366af2/f93b5/1.jpg 300w,\n/static/2ff70b6465c2f0a103ed25d4ed366af2/8a553/1.jpg 326w\"\n        sizes=\"(max-width: 326px) 100vw, 326px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"hooks-是什么？\" style=\"position:relative;\"><a href=\"#hooks-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F\" aria-label=\"hooks 是什么？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hooks 是什么？</h2>\n<blockquote>\n<p>Hooks 就是<b>把某个目标的结果钩到某个可能会变化的数据源或者事件源上，那么当被钩到的数据或事件发生变化时，产生这个目标结果的代码会重新执行，产生更新后的结果</b></p>\n</blockquote>\n<p>对于函数组件来说，这个结果就是最终的 dom 树；对于 useCallback、useMemo 这样与缓存相关的 hooks 组件，则是在依赖项发生变化时去更新缓存。<br/></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 741px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/12abb142059afb9c5d9faedb8c2f0e03/23313/2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3lAH/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFhAAAwAAAAAAAAAAAAAAAAAAACAh/9oACAEBAAE/ISr/AP/aAAwDAQACAAMAAAAQUM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEAAgMAAAAAAAAAAAAAAAABACEgUWH/2gAIAQEAAT8QW7qGwQ7h/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"hook\"\n        title=\"hook\"\n        src=\"/static/12abb142059afb9c5d9faedb8c2f0e03/23313/2.jpg\"\n        srcset=\"/static/12abb142059afb9c5d9faedb8c2f0e03/f93b5/2.jpg 300w,\n/static/12abb142059afb9c5d9faedb8c2f0e03/b4294/2.jpg 600w,\n/static/12abb142059afb9c5d9faedb8c2f0e03/23313/2.jpg 741w\"\n        sizes=\"(max-width: 741px) 100vw, 741px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"hooks-带来最大的好处：简化逻辑复用\" style=\"position:relative;\"><a href=\"#hooks-%E5%B8%A6%E6%9D%A5%E6%9C%80%E5%A4%A7%E7%9A%84%E5%A5%BD%E5%A4%84%EF%BC%9A%E7%AE%80%E5%8C%96%E9%80%BB%E8%BE%91%E5%A4%8D%E7%94%A8\" aria-label=\"hooks 带来最大的好处：简化逻辑复用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hooks 带来最大的好处：简化逻辑复用</h2>\n<p>场景：根据不用的屏幕大小适配不同的组件</p>\n<h3 id=\"class-的高阶组件方案：\" style=\"position:relative;\"><a href=\"#class-%E7%9A%84%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E6%96%B9%E6%A1%88%EF%BC%9A\" aria-label=\"class 的高阶组件方案： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>class 的高阶组件方案：</h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">withWindowSize</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">Component</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 产生一个高阶组件 WrappedComponent，只包含监听窗口大小的逻辑</span>\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">WrappedComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>PureComponent</span> <span class=\"token punctuation\">{</span>\n\n    state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        size<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"resize\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleResize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"resize\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleResize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">getSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> window<span class=\"token punctuation\">.</span>innerWidth <span class=\"token operator\">></span> <span class=\"token number\">1000</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"large\"</span> ：<span class=\"token string\">\"small\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function-variable function\">handleResize</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> currentSize <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        size<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 将窗口大小传递给真正的业务逻辑组件</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Component</span></span> <span class=\"token attr-name\">size</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> WrappedComponent<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> size <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>size <span class=\"token operator\">===</span> <span class=\"token string\">\"small\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SmallComponent</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LargeComponent</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 使用 withWindowSize 产生高阶组件，用于产生 size 属性传递给真正的业务组件</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">withWindowSize</span><span class=\"token punctuation\">(</span>MyComponent<span class=\"token punctuation\">)</span></code></pre></div>\n<p>缺点：</p>\n<ol>\n<li>代码难理解，不直观，很多人甚至宁愿重复代码，也不愿用高阶组件；</li>\n<li>会增加很多额外的组件节点。每一个高阶组件都会多一层节点，这就会给调试带来很大的负担。</li>\n</ol>\n<h3 id=\"hooks-方案\" style=\"position:relative;\"><a href=\"#hooks-%E6%96%B9%E6%A1%88\" aria-label=\"hooks 方案 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>hooks 方案</h3>\n<ol>\n<li>首先实现一个 hooks</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getSize</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> window<span class=\"token punctuation\">.</span>innerWidth <span class=\"token operator\">></span> <span class=\"token number\">1000</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"large\"</span> ：<span class=\"token string\">\"small\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">useWindowSize</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>size<span class=\"token punctuation\">,</span> setSize<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token function\">getSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handler</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setSize</span><span class=\"token punctuation\">(</span><span class=\"token function\">getSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> size<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ol start=\"2\">\n<li>使用 hooks</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">MyComponent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> size <span class=\"token operator\">=</span> <span class=\"token function\">useWindowSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>size <span class=\"token operator\">===</span> <span class=\"token string\">\"small\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SmallComponent</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token keyword\">else</span> <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LargeComponent</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"hooks-的另一大好处：有助于关注分离\" style=\"position:relative;\"><a href=\"#hooks-%E7%9A%84%E5%8F%A6%E4%B8%80%E5%A4%A7%E5%A5%BD%E5%A4%84%EF%BC%9A%E6%9C%89%E5%8A%A9%E4%BA%8E%E5%85%B3%E6%B3%A8%E5%88%86%E7%A6%BB\" aria-label=\"hooks 的另一大好处：有助于关注分离 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hooks 的另一大好处：有助于关注分离</h2>\n<p>比如上面监听浏览器窗口大小的变化为例，我们来看 Hooks 是如何做到关注分离的？<br></p>\n<ul>\n<li>在过去的 Class 组件中，我们需要在 componentDidMount 中监听事件，在 componentWillUnmount 中去解绑事件。<br></li>\n<li>而在函数组件中，我们可以把所有逻辑写在一起。</li>\n</ul>\n<h2 id=\"为什么函数组合的方式要优于继承？\" style=\"position:relative;\"><a href=\"#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%87%BD%E6%95%B0%E7%BB%84%E5%90%88%E7%9A%84%E6%96%B9%E5%BC%8F%E8%A6%81%E4%BC%98%E4%BA%8E%E7%BB%A7%E6%89%BF%EF%BC%9F\" aria-label=\"为什么函数组合的方式要优于继承？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>为什么函数组合的方式要优于继承？</h2>\n<blockquote>\n<p><b>组合</b>的话组件仅仅需要通过props的方式来相互交互，依赖关系更加清楚，组合的内聚性会更好。<br>\n<b>继承</b>会让两个组件紧密的耦合在一起，继承要达到的目标组合都可以cover</p>\n</blockquote>"},{"id":"64aa6c7f-29ad-5a04-969d-fe3fa89bb7a0","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"聊一聊https吧","path":"/net-https","tags":["Network"],"excerpt":"目标互联网中较为安全的通信方式，图文结合，易于理解。","created":"2021-05-19 24:00","createdPretty":"20 May, 2021","updated":"2021-05-27 21:54","updatedPretty":"20 May, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFA//EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAE0jMlWEBP/xAAaEAACAwEBAAAAAAAAAAAAAAABAgADERMS/9oACAEBAAEFAuh8Jbq9JsS5lAtUz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABwQAAIBBQEAAAAAAAAAAAAAAAABEhAhMTKhov/aAAgBAQAGPwKUuF64TRp6P//EABoQAQEAAgMAAAAAAAAAAAAAAAEAETFBUYH/2gAIAQEAAT8hNHwRgdoM8LCHoEgcq8n/2gAMAwEAAgADAAAAEEjf/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEB/9oACAEDAQE/EImv/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8Qqv/EAB0QAQEAAQUBAQAAAAAAAAAAAAERACExUZHRQbH/2gAIAQEAAT8QKk28At41yAa1pJOsg2O3zI2KXlzVM19BkDK/En5n/9k=","aspectRatio":1.5060240963855422,"src":"/static/652800dccf564befa933b3998ea6bdae/ba9ae/header.jpg","srcSet":"/static/652800dccf564befa933b3998ea6bdae/86d0f/header.jpg 125w,\n/static/652800dccf564befa933b3998ea6bdae/520da/header.jpg 250w,\n/static/652800dccf564befa933b3998ea6bdae/ba9ae/header.jpg 500w,\n/static/652800dccf564befa933b3998ea6bdae/72227/header.jpg 750w,\n/static/652800dccf564befa933b3998ea6bdae/5c39c/header.jpg 1000w,\n/static/652800dccf564befa933b3998ea6bdae/b1e91/header.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"明文的-http-很危险！\" style=\"position:relative;\"><a href=\"#%E6%98%8E%E6%96%87%E7%9A%84-http-%E5%BE%88%E5%8D%B1%E9%99%A9%EF%BC%81\" aria-label=\"明文的 http 很危险！ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>明文的 http 很危险！</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 467px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/61714d6bfddc15288634f26ada4bebe6/86f7d/http.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3oFB/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGBAAAwEBAAAAAAAAAAAAAAAAABEhAUH/2gAIAQEAAT8hpUY+n//aAAwDAQACAAMAAAAQc8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAADAAMAAAAAAAAAAAAAAAAAASERUZH/2gAIAQEAAT8QVizh9IbH/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"http\"\n        title=\"http\"\n        src=\"/static/61714d6bfddc15288634f26ada4bebe6/86f7d/http.jpg\"\n        srcset=\"/static/61714d6bfddc15288634f26ada4bebe6/f93b5/http.jpg 300w,\n/static/61714d6bfddc15288634f26ada4bebe6/86f7d/http.jpg 467w\"\n        sizes=\"(max-width: 467px) 100vw, 467px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>http 明文传输会带来数据被监听的风险，所以<code class=\"language-text\">对称加密</code>对数据的加密传输脱颖而出。</p>\n</blockquote>\n<h2 id=\"加个密吧！\" style=\"position:relative;\"><a href=\"#%E5%8A%A0%E4%B8%AA%E5%AF%86%E5%90%A7%EF%BC%81\" aria-label=\"加个密吧！ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>加个密吧！</h2>\n<p>最简单的加密方式就是对称加密\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 482px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4bfcb07fc048a4c59885ca610e0c4dbd/05b37/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3RSmP//EABkQAAEFAAAAAAAAAAAAAAAAABAAARExQf/aAAgBAQABBQKVQ1h//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFxABAAMAAAAAAAAAAAAAAAAAEBEhMf/aAAgBAQAGPwKLdf/EABsQAAICAwEAAAAAAAAAAAAAAAERACEQMXGR/9oACAEBAAE/IbEp1Gjs8gLDiNvE0x//2gAMAwEAAgADAAAAEEMP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHRABAAMAAQUAAAAAAAAAAAAAAQARIVEQQWFxkf/aAAgBAQABPxBwl6Z9iHp49Mq6JfZKYXrE5BkV65en/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"对称加密\"\n        title=\"对称加密\"\n        src=\"/static/4bfcb07fc048a4c59885ca610e0c4dbd/05b37/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86.jpg\"\n        srcset=\"/static/4bfcb07fc048a4c59885ca610e0c4dbd/f93b5/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86.jpg 300w,\n/static/4bfcb07fc048a4c59885ca610e0c4dbd/05b37/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86.jpg 482w\"\n        sizes=\"(max-width: 482px) 100vw, 482px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>对称加密在双方都拿到正确的密钥时确实能防止窃听风险，那怎样才能防止密钥在传输过程中被中间人窃取呢？</p>\n</blockquote>\n<h2 id=\"非对称加密！\" style=\"position:relative;\"><a href=\"#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%EF%BC%81\" aria-label=\"非对称加密！ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>非对称加密！</h2>\n<p>那非对称加密算法就很合适了，公钥可以随意给，但是只有私钥才能进行解密。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 638px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/97c4b24145ffc56c1b2c3bca6385c2e6/8608d/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3YFB/8QAFhAAAwAAAAAAAAAAAAAAAAAAAAEQ/9oACAEBAAEFAoj/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAYEAEBAQEBAAAAAAAAAAAAAAABABEhMf/aAAgBAQABPyHU9txSanb/2gAMAwEAAgADAAAAEHPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBABAQEBAQAAAAAAAAAAAAAAAREAYXH/2gAIAQEAAT8QXMksI4AA33U4B43f/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"非对称加密\"\n        title=\"非对称加密\"\n        src=\"/static/97c4b24145ffc56c1b2c3bca6385c2e6/8608d/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86.jpg\"\n        srcset=\"/static/97c4b24145ffc56c1b2c3bca6385c2e6/f93b5/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86.jpg 300w,\n/static/97c4b24145ffc56c1b2c3bca6385c2e6/b4294/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86.jpg 600w,\n/static/97c4b24145ffc56c1b2c3bca6385c2e6/8608d/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86.jpg 638w\"\n        sizes=\"(max-width: 638px) 100vw, 638px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>客户端在请求服务端后，服务端返回公钥给客户端，客户端将自己选择好的对称加密算法的密钥用服务端的公钥进行加密再传给服务端，这样就实现了保证对称加密密钥的正确传输。</p>\n</blockquote>\n<p>注意：由于非对称加密比较耗时，在正确交换了对称加密密钥后，客户端和服务端一直会用对称加密的密钥进行加密通信。</p>\n<h2 id=\"你以为这样就安全了？\" style=\"position:relative;\"><a href=\"#%E4%BD%A0%E4%BB%A5%E4%B8%BA%E8%BF%99%E6%A0%B7%E5%B0%B1%E5%AE%89%E5%85%A8%E4%BA%86%EF%BC%9F\" aria-label=\"你以为这样就安全了？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>你以为这样就安全了？</h2>\n<blockquote>\n<p>如果中间人把服务端的公钥换成自己的公钥，客户端傻傻的就把自己想用的对称加密的密钥给了中间人，中间人再用原来的正确公钥包装给服务端。这样客户端一直在和中间人通信，信息安全还是得不到保证。</p>\n</blockquote>\n<h2 id=\"第三方证明人。\" style=\"position:relative;\"><a href=\"#%E7%AC%AC%E4%B8%89%E6%96%B9%E8%AF%81%E6%98%8E%E4%BA%BA%E3%80%82\" aria-label=\"第三方证明人。 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>第三方证明人。</h2>\n<blockquote>\n<p>CA 机构 就是这样的权威并且值得信任的第三方<br/></p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 625px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c66498a7e45bf8f166f8cf0cdd946d09/dfe3c/ca.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3SFB/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEQMf/aAAgBAQABBQKLHEf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAVEAEBAAAAAAAAAAAAAAAAAAAgMf/aAAgBAQAGPwKr/8QAGhAAAwADAQAAAAAAAAAAAAAAAAERITFBgf/aAAgBAQABPyFNN40PR7VpwTLND//aAAwDAQACAAMAAAAQc8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEBAAICAwAAAAAAAAAAAAABEQAhUWEQMUH/2gAIAQEAAT8QV+jRO8YDIeeMEgO4TCOx9yLQvj//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ca\"\n        title=\"ca\"\n        src=\"/static/c66498a7e45bf8f166f8cf0cdd946d09/dfe3c/ca.jpg\"\n        srcset=\"/static/c66498a7e45bf8f166f8cf0cdd946d09/f93b5/ca.jpg 300w,\n/static/c66498a7e45bf8f166f8cf0cdd946d09/b4294/ca.jpg 600w,\n/static/c66498a7e45bf8f166f8cf0cdd946d09/dfe3c/ca.jpg 625w\"\n        sizes=\"(max-width: 625px) 100vw, 625px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>服务端会用自己的 CSR 文件和公钥到 CA 机构申请数字证书，CA 用一种加密方法来对网站信息进行加密(比如 md5)生成<code class=\"language-text\">加密的网站信息</code><br></li>\n<li>然后用自己的私钥把<code class=\"language-text\">加密的网站信息</code>再次进行加密生成<code class=\"language-text\">数字签名</code></li>\n<li>最后把这份有着<code class=\"language-text\">加密网站信息</code>和<code class=\"language-text\">数字签名</code>的证书给到服务端。这是世界上具有唯一性的证书。</li>\n<li>客户端会预置一些知名 CA 机构的公钥信息，所以拿到服务端的证书之后，客户端就会解密证书上的<code class=\"language-text\">加密网站信息</code>得到<code class=\"language-text\">网站信息</code>，和用 CA 机构公钥解密<code class=\"language-text\">数字签名</code>得到的网站信息，经过对比确认是否是可信任的服务端。</li>\n<li>如果是可信任的服务端，客户端就取出证书中的公钥，对自己想用的对称密钥进行加密，然后传输给服务端。</li>\n<li>最后就可以一直使用对称密钥进行加密传输数据啦！</li>\n</ul>"},{"id":"22ddb865-dc69-510f-81f3-fdadba8a0079","headings":[{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3}],"frontmatter":{"title":"nginx配置https及nginx安全配置","path":"/nginx-https","tags":["DevOps"],"excerpt":"nginx配置https单向和双向认证，及nginx最佳安全配置","created":"2021-04-28 21:48","createdPretty":"28 April, 2021","updated":"2021-05-19 23:15","updatedPretty":"28 April, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAwb/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAV3ee00pEor/xAAaEAADAQADAAAAAAAAAAAAAAAAAQISAxMi/9oACAEBAAEFAuDElWnPihW0dtG6P//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/Aar/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARL/2gAIAQIBAT8Blaf/xAAbEAACAQUAAAAAAAAAAAAAAAAAESEBECIxQf/aAAgBAQAGPwJplceERfZ//8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERQSEx/9oACAEBAAE/IWakvNxj9iuKPg4Sajwmc5Rk/9oADAMBAAIAAwAAABAnL//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/EKU//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qif/EABsQAQADAAMBAAAAAAAAAAAAAAEAESEQMWGR/9oACAEBAAE/EMY5yvoxO2zC2oQPUFaPvEi2kIh7fZ//2Q==","aspectRatio":1.4367816091954022,"src":"/static/83a40cbba25cea1b5f61341b2cc07096/ba9ae/image.jpg","srcSet":"/static/83a40cbba25cea1b5f61341b2cc07096/86d0f/image.jpg 125w,\n/static/83a40cbba25cea1b5f61341b2cc07096/520da/image.jpg 250w,\n/static/83a40cbba25cea1b5f61341b2cc07096/ba9ae/image.jpg 500w,\n/static/83a40cbba25cea1b5f61341b2cc07096/72227/image.jpg 750w,\n/static/83a40cbba25cea1b5f61341b2cc07096/5c39c/image.jpg 1000w,\n/static/83a40cbba25cea1b5f61341b2cc07096/b1e91/image.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"nginx-的主要配置\" style=\"position:relative;\"><a href=\"#nginx-%E7%9A%84%E4%B8%BB%E8%A6%81%E9%85%8D%E7%BD%AE\" aria-label=\"nginx 的主要配置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nginx 的主要配置</h2>\n<h3 id=\"转发-http-请求到-https\" style=\"position:relative;\"><a href=\"#%E8%BD%AC%E5%8F%91-http-%E8%AF%B7%E6%B1%82%E5%88%B0-https\" aria-label=\"转发 http 请求到 https permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>转发 http 请求到 https</h3>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre class=\"language-nginx\"><code class=\"language-nginx\"><span class=\"token keyword\">server</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">listen</span> <span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">listen</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span><span class=\"token number\">80</span> default_server<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\"># 配置访问80http重定向到443的https，如果想开放80可以不配置</span>\n\t<span class=\"token keyword\">rewrite</span> <span class=\"token operator\">^</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>$ <span class=\"token keyword\">https</span><span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span><span class=\"token variable\">$host</span>$<span class=\"token number\">1</span> permanent<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"nginx-配置-https-单向认证\" style=\"position:relative;\"><a href=\"#nginx-%E9%85%8D%E7%BD%AE-https-%E5%8D%95%E5%90%91%E8%AE%A4%E8%AF%81\" aria-label=\"nginx 配置 https 单向认证 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nginx 配置 https 单向认证</h3>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre class=\"language-nginx\"><code class=\"language-nginx\"><span class=\"token keyword\">server</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">listen</span> <span class=\"token number\">443</span> <span class=\"token keyword\">ssl</span> default_server<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">listen</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span><span class=\"token number\">443</span> <span class=\"token keyword\">ssl</span> default_server<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\"># SSL configuration</span>\n    <span class=\"token comment\"># 服务器证书的绝对路径</span>\n\t<span class=\"token keyword\">ssl_certificate</span>     <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>certs<span class=\"token operator\">/</span><span class=\"token keyword\">server</span><span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\"># 服务器私钥的绝对路径</span>\n    <span class=\"token keyword\">ssl_certificate_key</span> <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>nginx<span class=\"token operator\">/</span>certs<span class=\"token operator\">/</span><span class=\"token keyword\">server</span><span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\"># enable session resumption to improve https performance</span>\n  \t<span class=\"token keyword\">ssl_session_cache</span> shared<span class=\"token punctuation\">:</span><span class=\"token keyword\">SSL</span><span class=\"token punctuation\">:</span><span class=\"token number\">50</span>m<span class=\"token punctuation\">;</span>\n  \t<span class=\"token keyword\">ssl_session_timeout</span> <span class=\"token number\">1</span>d<span class=\"token punctuation\">;</span>\n  \t<span class=\"token keyword\">ssl_session_tickets</span> off<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"没钱的打工人只能自签证书\" style=\"position:relative;\"><a href=\"#%E6%B2%A1%E9%92%B1%E7%9A%84%E6%89%93%E5%B7%A5%E4%BA%BA%E5%8F%AA%E8%83%BD%E8%87%AA%E7%AD%BE%E8%AF%81%E4%B9%A6\" aria-label=\"没钱的打工人只能自签证书 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>没钱的打工人只能自签证书</h2>\n<p>以下步骤需要自行安装 openssl 工具</p>\n<h3 id=\"https-自签发-ca-证书并实现网站可信\" style=\"position:relative;\"><a href=\"#https-%E8%87%AA%E7%AD%BE%E5%8F%91-ca-%E8%AF%81%E4%B9%A6%E5%B9%B6%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%AB%99%E5%8F%AF%E4%BF%A1\" aria-label=\"https 自签发 ca 证书并实现网站可信 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HTTPS 自签发 CA 证书并实现网站可信</h3>\n<blockquote>\n<p><a href=\"https://jinyy.app/article/https-ca/\">HTTPS 自签发 CA 证书</a></p>\n</blockquote>\n<h3 id=\"遇到-ios-13-与-macos-1015-不支持自签证书\" style=\"position:relative;\"><a href=\"#%E9%81%87%E5%88%B0-ios-13-%E4%B8%8E-macos-1015-%E4%B8%8D%E6%94%AF%E6%8C%81%E8%87%AA%E7%AD%BE%E8%AF%81%E4%B9%A6\" aria-label=\"遇到 ios 13 与 macos 1015 不支持自签证书 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>遇到 iOS 13 与 macOS 10.15 不支持自签证书</h3>\n<blockquote>\n<p><a href=\"https://jinyy.app/article/https-ca-2019/\">新版自签名 CA 证书生成</a></p>\n</blockquote>\n<h3 id=\"一键生成自签证书和私钥\" style=\"position:relative;\"><a href=\"#%E4%B8%80%E9%94%AE%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E8%AF%81%E4%B9%A6%E5%92%8C%E7%A7%81%E9%92%A5\" aria-label=\"一键生成自签证书和私钥 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>一键生成自签证书和私钥</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"> openssl req -out cert.crt -new -newkey rsa:2048  -nodes -keyout cert.key -x509 -days <span class=\"token number\">3650</span> -subj <span class=\"token string\">\"/C=[国家或地区]/ST=[省/市/自治区]/L=[所在地]/O=[组织]/OU=[组织单位]/CN=[常用名称]\"</span></code></pre></div>\n<blockquote>\n<p>自签证书缺点是浏览器不认识该证书，所以会显示网站不安全，想解决此问题，就到 OA 机构签发证书，比如<a href=\"https://letsencrypt.org/\">Let's Encrypt</a></p>\n</blockquote>\n<h2 id=\"nginx-的安全配置\" style=\"position:relative;\"><a href=\"#nginx-%E7%9A%84%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE\" aria-label=\"nginx 的安全配置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nginx 的安全配置</h2>\n<blockquote>\n<p>参考:<a href=\"https://gist.github.com/plentz/6737338\">最安全的 nginx 配置</a>\n在 http 或者 server 模块添加就可</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre class=\"language-nginx\"><code class=\"language-nginx\"><span class=\"token comment\"># 防止BEAST攻击</span>\n<span class=\"token keyword\">ssl_prefer_server_ciphers</span> on<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># 开启HSTS(HTTP Strict Transport Security)，强制https跳转</span>\n<span class=\"token keyword\">add_header</span> Strict<span class=\"token operator\">-</span>Transport<span class=\"token operator\">-</span>Security <span class=\"token string\">\"max-age=31536000; includeSubdomains; preload\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># 不要在错误页面和服务器头中发送nginx版本号</span>\n<span class=\"token keyword\">server_tokens</span> off<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># 不允许浏览器在框架或iframe中呈现页面，防止点击劫持</span>\n<span class=\"token keyword\">add_header</span> X<span class=\"token operator\">-</span>Frame<span class=\"token operator\">-</span>Options SAMEORIGIN<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># 防止content-type嗅探</span>\n<span class=\"token keyword\">add_header</span> X<span class=\"token operator\">-</span>Content<span class=\"token operator\">-</span>Type<span class=\"token operator\">-</span>Options nosniff<span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># xss过滤</span>\n<span class=\"token keyword\">add_header</span> X<span class=\"token operator\">-</span>XSS<span class=\"token operator\">-</span>Protection <span class=\"token string\">\"1; mode=block\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\"># 内容安全策略CSP</span>\n<span class=\"token keyword\">add_header</span> Content<span class=\"token operator\">-</span>Security<span class=\"token operator\">-</span>Policy <span class=\"token string\">\"default-src 'self';\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"openssl-生成证书和私钥的脚本\" style=\"position:relative;\"><a href=\"#openssl-%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6%E5%92%8C%E7%A7%81%E9%92%A5%E7%9A%84%E8%84%9A%E6%9C%AC\" aria-label=\"openssl 生成证书和私钥的脚本 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>openssl 生成证书和私钥的脚本</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token assign-left variable\">domain</span><span class=\"token operator\">=</span><span class=\"token variable\">$1</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"domain: <span class=\"token variable\">$1</span>\"</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -z <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"domain empty, exiting...\"</span>\n    <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token assign-left variable\">filename</span><span class=\"token operator\">=</span><span class=\"token variable\">${domain<span class=\"token operator\">/</span>\\*<span class=\"token operator\">/</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>}</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token operator\">!</span> -f <span class=\"token string\">\"ca.key\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"CA not exist, ready to create...\"</span>\n    <span class=\"token comment\"># ca私钥</span>\n    openssl genrsa -out ca.key <span class=\"token number\">2048</span>\n    openssl req -new -key ca.key -out ca.csr -sha256 -subj <span class=\"token string\">\"/C=CN/ST=BeiJing/L=BeiJing/O=SELF/OU=SELF/CN=self.signature\"</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"basicConstraints=CA:TRUE\"</span><span class=\"token operator\">></span>ca.ext\n    openssl x509 -req -in ca.csr -signkey ca.key -out ca.crt -extfile ca.ext -sha256 -days <span class=\"token number\">825</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"generating site cert...\"</span>\nopenssl genrsa -out <span class=\"token variable\">$filename</span>.key <span class=\"token number\">2048</span>\nopenssl req -new -key <span class=\"token variable\">$filename</span>.key -out <span class=\"token variable\">$filename</span>.csr -sha256 -subj <span class=\"token string\">\"/C=CN/ST=BeiJing/L=BeiJing/O=SELF/OU=SELF/CN=<span class=\"token variable\">$domain</span>\"</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"authorityKeyIdentifier=keyid,issuer\nbasicConstraints=CA:FALSE\nkeyUsage=digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment\nextendedKeyUsage=serverAuth,OCSPSigning\nsubjectAltName=@alt_names\n\n[alt_names]\nDNS.1=<span class=\"token variable\">$domain</span>\nDNS.2=*.<span class=\"token variable\">$domain</span>\"</span><span class=\"token operator\">></span><span class=\"token variable\">$filename</span>.ext\nopenssl x509 -req -in <span class=\"token variable\">$filename</span>.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out <span class=\"token variable\">$filename</span>.crt -extfile <span class=\"token variable\">$filename</span>.ext -sha256 -days <span class=\"token number\">824</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"done\"</span></code></pre></div>\n<p>使用方式，保存为 ca.sh，然后执行：</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sh</span> ca.sh test.com</code></pre></div>\n<h3 id=\"文件描述\" style=\"position:relative;\"><a href=\"#%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0\" aria-label=\"文件描述 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>文件描述</h3>\n<ul>\n<li>ca.crt 根证书</li>\n<li>ca.key CA 私钥</li>\n<li>client.crt 客户端证书</li>\n<li>client.key 客户端私钥</li>\n<li>client.p12 使用浏览器访问时，需要生成 p12 格式的客户端证书</li>\n<li>server.crt 服务端证书</li>\n<li>server.crt 服务端私钥</li>\n<li>*.csr 签发请求</li>\n</ul>\n<h3 id=\"nginx-配置-https-双向认证\" style=\"position:relative;\"><a href=\"#nginx-%E9%85%8D%E7%BD%AE-https-%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81\" aria-label=\"nginx 配置 https 双向认证 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nginx 配置 https 双向认证</h3>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre class=\"language-nginx\"><code class=\"language-nginx\"><span class=\"token comment\"># 配置https双向认证的主要配置</span>\n<span class=\"token keyword\">listen</span> <span class=\"token number\">443</span> <span class=\"token keyword\">ssl</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">server_name</span> hostName<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">server_tokens</span> off<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">ssl</span> on<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">ssl_certificate</span>      <span class=\"token keyword\">server</span><span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">;</span>  <span class=\"token comment\"># server证书公钥</span>\n<span class=\"token keyword\">ssl_certificate_key</span>  <span class=\"token keyword\">server</span><span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">;</span>  <span class=\"token comment\"># server私钥</span>\n<span class=\"token keyword\">ssl_client_certificate</span> ca<span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">;</span>  <span class=\"token comment\"># 根级证书公钥，用于验证各个二级client</span>\n<span class=\"token keyword\">ssl_verify_client</span> on<span class=\"token punctuation\">;</span>  <span class=\"token comment\"># 开启客户端证书验证</span></code></pre></div>\n<h3 id=\"https-双向认证测试\" style=\"position:relative;\"><a href=\"#https-%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81%E6%B5%8B%E8%AF%95\" aria-label=\"https 双向认证测试 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>https 双向认证测试</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 命令行Curl测试</span>\n<span class=\"token function\">curl</span> --insecure --key client.key --cert client.crt hostName\n<span class=\"token comment\"># 收到网页信息，成功</span>\n\n<span class=\"token comment\"># 浏览器访问测试</span>\n把client.p12导入到浏览器的https配置中，访问站点建立连接的时候nginx会\n要求客户端把这个证书发给自己验证，如果没有这个证书就拒绝访问。</code></pre></div>"},{"id":"9701b4e9-3cfe-552e-8215-ebb6d88cd77d","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"k8s修改外部访问端口","path":"/k8s-port","tags":["DevOps"],"excerpt":"k8s修改外部访问端口，只要是涉及到service的各种端口解惑","created":"2021-04-27 18:22","createdPretty":"27 April, 2021","updated":"2021-05-17 22:10","updatedPretty":"27 April, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDBAX/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQID/9oADAMBAAIQAxAAAAGTcl6zqZAf/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAECAwQRQf/aAAgBAQABBQKtVEo441XtM4z/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8BkY//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAABBQAAAAAAAAAAAAAAAAAAASAiMTL/2gAIAQEABj8CkWppn//EABoQAQEAAgMAAAAAAAAAAAAAAAEAETEhUZH/2gAIAQEAAT8hUZHjc7B2ucncrd7/2gAMAwEAAgADAAAAEJgP/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERIf/aAAgBAwEBPxCGQVH/xAAXEQADAQAAAAAAAAAAAAAAAAAAARFB/9oACAECAQE/EGtpT//EABsQAQADAQADAAAAAAAAAAAAAAEAESExUWGB/9oACAEBAAE/EKUarmkWWka1z5BIQHqZ9RCFeTGfE//Z","aspectRatio":1.7857142857142858,"src":"/static/f05eb1861e4384ccd1f4478fe0de1a22/ba9ae/image.jpg","srcSet":"/static/f05eb1861e4384ccd1f4478fe0de1a22/86d0f/image.jpg 125w,\n/static/f05eb1861e4384ccd1f4478fe0de1a22/520da/image.jpg 250w,\n/static/f05eb1861e4384ccd1f4478fe0de1a22/ba9ae/image.jpg 500w,\n/static/f05eb1861e4384ccd1f4478fe0de1a22/72227/image.jpg 750w,\n/static/f05eb1861e4384ccd1f4478fe0de1a22/5c39c/image.jpg 1000w,\n/static/f05eb1861e4384ccd1f4478fe0de1a22/b1e91/image.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"service-的-ports-字段解惑\" style=\"position:relative;\"><a href=\"#service-%E7%9A%84-ports-%E5%AD%97%E6%AE%B5%E8%A7%A3%E6%83%91\" aria-label=\"service 的 ports 字段解惑 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Service 的 ports 字段解惑</h2>\n<ul>\n<li>port: service 暴露在 cluster ip 上的端口，通过<code class=\"language-text\">&lt;cluster ip&gt;:port</code> 访问服务,通过此端口集群内的服务可以相互访问,简单来说就是 <code class=\"language-text\">pod</code> 和 pod 的端口访问。</li>\n<li>targetPort: Pod 的外部访问端口，port 和 nodePort 的数据通过这个端口进入到 Pod 内部，Pod 里面的 containers 的端口映射到这个端口，提供服务(需要与制作容器时暴露的端口一致,与 DockerFile 中的 <code class=\"language-text\">EXPOSE</code> 对应)，简单来说就是<code class=\"language-text\">容器</code>的端口</li>\n<li>nodePort: Node 节点的端口，<code class=\"language-text\">&lt;nodeIP&gt;:nodePort</code> 是提供给集群外部客户访问 service 的入口，简单来说就是<code class=\"language-text\">宿主机</code>的端口</li>\n</ul>\n<h2 id=\"deployment-的-ports-字段解惑\" style=\"position:relative;\"><a href=\"#deployment-%E7%9A%84-ports-%E5%AD%97%E6%AE%B5%E8%A7%A3%E6%83%91\" aria-label=\"deployment 的 ports 字段解惑 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deployment 的 ports 字段解惑</h2>\n<ul>\n<li>containerPort: 这里 containerPort 是容器内部的 port</li>\n<li>\n<p>hostPort: 相当于 docker 的-p 参数，映射容器端口到宿主机的端口</p>\n<blockquote>\n<p>但这样做有个缺点，因为 Pod 重新调度的时候该 Pod 被调度到的宿主机可能会变动，这样就变化了，用户必须自己维护一个 Pod 与所在宿主机的对应关系。\n使用了 hostPort 的容器只能调度到端口不冲突的 Node 上，除非有必要（比如运行一些系统级的 daemon 服务），不建议使用端口映射功能。如果需要对外暴露服务，建议使用 NodePort Service。</p>\n</blockquote>\n</li>\n</ul>\n<h2 id=\"示例\" style=\"position:relative;\"><a href=\"#%E7%A4%BA%E4%BE%8B\" aria-label=\"示例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>示例</h2>\n<blockquote>\n<p>如果想把 nginx 容器的 80 端口映射到宿主机上的 1000 端口，则只要修改 service.yml 文件如下</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n<span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> NodePort\n<span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n  <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n  <span class=\"token key atrule\">nodePort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1000</span></code></pre></div>\n<h2 id=\"注意\" style=\"position:relative;\"><a href=\"#%E6%B3%A8%E6%84%8F\" aria-label=\"注意 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>注意</h2>\n<blockquote>\n<p>修改完 Service 的配置别忘了要重启下才能生效</p>\n</blockquote>\n<ul>\n<li>kubectl replace --force -f service.yml</li>\n</ul>\n<h2 id=\"总结\" style=\"position:relative;\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-label=\"总结 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>总结</h2>\n<blockquote>\n<p>总结了 Service,因为 Service 的端口服务会覆盖 Deployment 的端口映射，对外端口服务推荐使用 Service</p>\n</blockquote>\n<p>总的来说，<code class=\"language-text\">port</code> 和 <code class=\"language-text\">nodePort</code> 都是 service 的端口，前者暴露给 k8s 集群内部服务访问，后者暴露给 k8s 集群外部流量访问。从上两个端口过来的数据都需要经过反向代理 <code class=\"language-text\">kube-proxy</code>，流入后端 pod 的 <code class=\"language-text\">targetPort</code> 上，最后到达 pod 内的容器。</p>"},{"id":"efbd3e18-2fc2-56bf-99b2-8f555443ce4d","headings":[{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3}],"frontmatter":{"title":"使用docker部署react项目到服务器","path":"/docker-deployment","tags":["DevOps"],"excerpt":"使用docker部署react项目到服务器,并完成与后端容器的通信，通信过程中遇到了不能访问上游服务器的问题。","created":"2021-04-14T00:00:00.000Z","createdPretty":"14 April, 2021","updated":"2021-04-15T00:00:00.000Z","updatedPretty":"14 April, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACYUlEQVQ4y61TTW8SYRDmz3jyoMajd49e9OLFg8Y/4Ec4eDA18WJaK9GWYDCBGpPWdLESoVDaBtqCltJSYJfdxfKRVMECy37wcTB2H2eB3UJbbx4m8747s888z8y8Nq3F6f/TbKrE4rRRwDorZPLQn+TkBtbMDe4j+bbzqlBA78p5vUvnnszpf1SBPN3VAnlR77QKuqoUdbVX1DWN7+cP/mV1AxCmmVXoZwg/d1BupLH/Yw8Mt45KLY3D0hoKqXlUoq/QDrxAJzIHRUxC04SBMonDGKAJ2pU5VOoCFhMMXm9P4cLCDG4texDzO7HzfgKzEQdepqcR9z9C03EXUmSBQEVL8hg74yw3slBLIXCzbtz2TOHKl7ewxxmEKtvophlI08/h97jxkJuHn3ejdxCBIgsjgH2wkUGQ5GzkIxxv7Ljkc+FGeA7VegYdI9Y5QKfM4Ng1gZz3HXL1FLrad2s4NpOVZjKk6XWUDIphHvdmwrgadOJ6wEM93e33VmkSe60ItcgQsxh9E/sTNzFslty+dBbNZhl8YwnV0BPc+eDCxc8uXPY54WVXAeqTbK6NXICi5K1hqK2ByiFDujTzJOkbftWCeJqN4ebqM1zzuzG5F0S0FIf96xKOjN5a7cmNETGV2qzFbLCQPrkRSjzG/Q0ffHwCk7tBhMQNoMXDm1nBgy1fn2F7qOr0hpwAGkGFh5BcRjy/CUlmcUxBJhWCJ7KI6IoPm1sBrGfWqHBu7GWcARxdG60t4jctqcFAomcl1/ZRLSdRLCRwSF45ypx5mv9mOExSTiW2qfFdYm/4seLnyDXsL3yh3JleIuEaAAAAAElFTkSuQmCC","aspectRatio":1.3888888888888888,"src":"/static/cd2fed732da0d690be8178f64aad459d/0853f/dinosaur.png","srcSet":"/static/cd2fed732da0d690be8178f64aad459d/14156/dinosaur.png 125w,\n/static/cd2fed732da0d690be8178f64aad459d/d6e47/dinosaur.png 250w,\n/static/cd2fed732da0d690be8178f64aad459d/0853f/dinosaur.png 500w,\n/static/cd2fed732da0d690be8178f64aad459d/ce627/dinosaur.png 750w,\n/static/cd2fed732da0d690be8178f64aad459d/9dbcf/dinosaur.png 1000w,\n/static/cd2fed732da0d690be8178f64aad459d/87046/dinosaur.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<blockquote>\n<p>看此文章前需要您具备 docker，linux，makefile ,nginx 的基础知识</p>\n</blockquote>\n<h2 id=\"镜像准备\" style=\"position:relative;\"><a href=\"#%E9%95%9C%E5%83%8F%E5%87%86%E5%A4%87\" aria-label=\"镜像准备 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>镜像准备</h2>\n<h3 id=\"编写-makefile\" style=\"position:relative;\"><a href=\"#%E7%BC%96%E5%86%99-makefile\" aria-label=\"编写 makefile permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>编写 Makefile</h3>\n<div class=\"gatsby-highlight\" data-language=\"makefile\"><pre class=\"language-makefile\"><code class=\"language-makefile\"><span class=\"token comment\"># 这个名称在拉取镜像的时候有用哦</span>\nimagePath <span class=\"token operator\">=</span> [你的harbor地址]/[镜像名]<span class=\"token punctuation\">:</span>[镜像版本号]\n<span class=\"token symbol\">push-webapp</span><span class=\"token punctuation\">:</span>\n\tyarn build\n\tdocker build -t <span class=\"token variable\">$</span><span class=\"token punctuation\">{</span>imagePath<span class=\"token punctuation\">}</span> .\n\tdocker push <span class=\"token variable\">$</span><span class=\"token punctuation\">{</span>imagePath<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"编写-dockerfile\" style=\"position:relative;\"><a href=\"#%E7%BC%96%E5%86%99-dockerfile\" aria-label=\"编写 dockerfile permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>编写 Dockerfile</h3>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token comment\"># nginx的版本可以自行选择</span>\n<span class=\"token keyword\">FROM</span> nginx<span class=\"token punctuation\">:</span>1.19<span class=\"token punctuation\">-</span>alpine\n<span class=\"token keyword\">COPY</span> ./nginx.conf /etc/nginx/nginx.conf\n<span class=\"token keyword\">COPY</span> ./dist/ /opt/www/\n<span class=\"token keyword\">ENTRYPOINT</span> nginx <span class=\"token punctuation\">-</span>g <span class=\"token string\">\"daemon off;\"</span>\n<span class=\"token keyword\">EXPOSE</span> 80</code></pre></div>\n<h3 id=\"编写-nignxconf\" style=\"position:relative;\"><a href=\"#%E7%BC%96%E5%86%99-nignxconf\" aria-label=\"编写 nignxconf permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>编写 nignx.conf</h3>\n<blockquote>\n<p>主要是在 nginx.conf 文件的 server 块中修改或添加以下代理就可以了</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre class=\"language-nginx\"><code class=\"language-nginx\"><span class=\"token comment\"># 指定静态文件夹的根目录</span>\n<span class=\"token keyword\">root</span> <span class=\"token operator\">/</span>opt<span class=\"token operator\">/</span>www<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\"># api_url 为后端容器的ip地址,api_port为容器开启的服务端口</span>\n<span class=\"token keyword\">location</span> <span class=\"token operator\">~</span> <span class=\"token operator\">/</span>api<span class=\"token operator\">/</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">proxy_pass</span> <span class=\"token keyword\">http</span><span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span><span class=\"token punctuation\">[</span>api_url<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span>api_port<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">proxy_set_header</span> real_ip <span class=\"token variable\">$remote_addr</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># 因为是单页应用，所以需要总是返回index.html文件</span>\n<span class=\"token keyword\">location</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try_files</span> <span class=\"token variable\">$uri</span> <span class=\"token operator\">/</span><span class=\"token keyword\">index</span><span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"在服务器端运行镜像\" style=\"position:relative;\"><a href=\"#%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%BF%90%E8%A1%8C%E9%95%9C%E5%83%8F\" aria-label=\"在服务器端运行镜像 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>在服务器端运行镜像</h2>\n<h3 id=\"拉取镜像\" style=\"position:relative;\"><a href=\"#%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F\" aria-label=\"拉取镜像 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>拉取镜像</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 上面打的镜像变量名imagePath</span>\ndocker pull <span class=\"token punctuation\">[</span>imagePath<span class=\"token punctuation\">]</span></code></pre></div>\n<h3 id=\"以守护态形式运行镜像\" style=\"position:relative;\"><a href=\"#%E4%BB%A5%E5%AE%88%E6%8A%A4%E6%80%81%E5%BD%A2%E5%BC%8F%E8%BF%90%E8%A1%8C%E9%95%9C%E5%83%8F\" aria-label=\"以守护态形式运行镜像 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>以守护态形式运行镜像</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 这里的-p是映射主机80端口到容器的80端口,dockerfile中的EXPOSE是容器暴露的端口</span>\ndocker run --name <span class=\"token punctuation\">[</span>容器名<span class=\"token punctuation\">]</span> -d -p <span class=\"token number\">80</span>:80 <span class=\"token punctuation\">[</span>imagePath的镜像id<span class=\"token punctuation\">]</span></code></pre></div>\n<h2 id=\"遇到的问题以及解决方法\" style=\"position:relative;\"><a href=\"#%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%BB%A5%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95\" aria-label=\"遇到的问题以及解决方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>遇到的问题以及解决方法</h2>\n<h3 id=\"nignx-无法访问上游服务器\" style=\"position:relative;\"><a href=\"#nignx-%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E4%B8%8A%E6%B8%B8%E6%9C%8D%E5%8A%A1%E5%99%A8\" aria-label=\"nignx 无法访问上游服务器 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nignx 无法访问上游服务器</h3>\n<ul>\n<li>一开始我配置的<code class=\"language-text\">proxy_pass http://[api_url]:[api_port]</code>中的<code class=\"language-text\">api_url</code>是 127.0.0.1，导致打开页面报网关错误的问题，大佬一看就肯定知道啥原因了。<br></li>\n<li>经过排查，docker 容器的网络是通过 linux 的 namespace 进行隔离的，默认的桥接情况下，每个容器都有自己的一块独立的网卡，学过 linux 的肯定知道 127.0.0.1 是 lo 回环网卡的地址，所以是访问不到后端服务的（QAQ，我这里的错误就是误认为后端服务和前端服务同用宿主机的网卡了,hahahah~）。</li>\n<li>\n<p>解决方案：</p>\n<ul>\n<li>使用宿主机的 ip + 后端服务的端口(相当于外部访问宿主机的后端服务，转了一圈~)</li>\n<li>如果是同一网桥 docker0 中，可以将请求地址改成后端服务在网段中的地址（具体地址可以进容器查看，也可以通过<code class=\"language-text\">docker network inspect bridge</code>,bridge 是网桥的名称，可以通过<code class=\"language-text\">docker netword ls</code>查看所有的网桥）</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"nginx-部署单页应用遇到白屏问题\" style=\"position:relative;\"><a href=\"#nginx-%E9%83%A8%E7%BD%B2%E5%8D%95%E9%A1%B5%E5%BA%94%E7%94%A8%E9%81%87%E5%88%B0%E7%99%BD%E5%B1%8F%E9%97%AE%E9%A2%98\" aria-label=\"nginx 部署单页应用遇到白屏问题 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nginx 部署单页应用遇到白屏问题</h3>\n<p>可以查看<a href=\"http://localhost:8001/nginx-deployment\"> nginx 部署 react 项目</a></p>\n<h2 id=\"docker-一共有四种网络模式\" style=\"position:relative;\"><a href=\"#docker-%E4%B8%80%E5%85%B1%E6%9C%89%E5%9B%9B%E7%A7%8D%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F\" aria-label=\"docker 一共有四种网络模式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>docker 一共有四种网络模式:</h2>\n<h3 id=\"host-模式\" style=\"position:relative;\"><a href=\"#host-%E6%A8%A1%E5%BC%8F\" aria-label=\"host 模式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>host 模式</h3>\n<ul>\n<li>设置命令:<code class=\"language-text\">--net=host</code></li>\n<li>详细说明: 容器不会获得一个独立的 network namespace，而是与宿主机共用一个 network namespace，容器不会虚拟出自己的网卡、配置自己的 ip 等，而是使用宿主机的 ip 和端口。</li>\n</ul>\n<blockquote>\n<p>应用场景:当网络不应与 Docker 主机隔离，但又希望容器的其他方面隔离时，主机网络是最佳选择。</p>\n</blockquote>\n<h3 id=\"container-模式\" style=\"position:relative;\"><a href=\"#container-%E6%A8%A1%E5%BC%8F\" aria-label=\"container 模式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>container 模式</h3>\n<ul>\n<li>设置命令: <code class=\"language-text\">--net=container</code></li>\n<li>详细说明:指定新创建的容器和已经存在的一个容器共享一个 network namespace，而不是和宿主机共享，新创建的容器不会创建自己的网卡、配置自己的 ip，而是和指定的容器共享 ip、端口等。两个容器除网络方面相同外，其他的如文件系统、进程列表等还是隔离的。</li>\n</ul>\n<h3 id=\"none-模式\" style=\"position:relative;\"><a href=\"#none-%E6%A8%A1%E5%BC%8F\" aria-label=\"none 模式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>none 模式</h3>\n<ul>\n<li>设置命令:<code class=\"language-text\">--net=none</code></li>\n<li>详细说明:容器拥有自己的 network namespace，但是并未对容器进行任何网络配置，需要手工为容器添加网卡、配置 ip 等。可以使用 pipework 工具为容器指定 ip 等信息</li>\n</ul>\n<blockquote>\n<p>应用场景：第三方网络插件使您可以将 docker 与专用网络集成。</p>\n</blockquote>\n<h3 id=\"bridge-模式\" style=\"position:relative;\"><a href=\"#bridge-%E6%A8%A1%E5%BC%8F\" aria-label=\"bridge 模式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>bridge 模式</h3>\n<ul>\n<li>设置命令:<code class=\"language-text\">--net=bridge</code></li>\n<li>详细说明:bridge 模式是容器默认的网络模式，该模式会为每个容器分配独立的 network namespace，设置 ip、路由等信息，默认会将容器连接到一个虚拟网桥交换机 docker0 上，容器之间组成一个局域网，可以相互访问。</li>\n</ul>\n<blockquote>\n<p>应用场景:当您需要多个容器在同一 docker 主机上进行通信时，最好使用用户定义的网桥网络。用户定义的网桥网络的容器会自动将所有端口彼此公开，而不会向外界公开任何端口。默认网桥网络上运行相同的应用程序堆栈，则需要使用-p 或–publish 标志分别打开 Web 端口和数据库端口。这意味着 docker 主机需要通过其他方式阻止对数据库端口的访问。</p>\n</blockquote>"},{"id":"34b54494-7148-55e6-b682-4ee67348dfe6","headings":[{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"使用Gatsby.js+github pages搭建个人博客","path":"/gatsby-blog","tags":["Gatsby"],"excerpt":"使用Gatsby.js+github pages搭建个人博客，手把手教你的完整教程。","created":"2021-04-12T00:00:00.000Z","createdPretty":"12 April, 2021","updated":"2021-04-12T00:00:00.000Z","updatedPretty":"12 April, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAACz0lEQVQozz2QW0hTARjH/7rTe/TQUy9FBEFvEvXQgxQE0nbOdnRnMyIIokwhCdPMYea8zMvc3Nxcm7ufsx2dt7zMNs0oVLxsblFBQRF0BSEoNNLp5ukcjeDH9/D/vu////iQDDErIeZNqDg3VSJMl2Zjmp0pZnemdDem3o0xIkKM+dSvTIZUSU654KFSIfV/IC4nw5oVn2pjTJ0dvLjTdjjbfHDLdzY3Le0Lceb7oCrJKl/ydCqsWg5S817y2SP5UoBOsCVY4ZhZp2LeLU9z1FrdIaEaQi2yugOZoaLdae1+7GKAWmGpNE+nwyoR0eW5Ux63FWHOQy4HyfSecdJeuKY7KOjysrV5m+HzwsxlMXw7WrIWUb4Pyl84iuY88nmPYsGrmHMrEiyFFK9a5enVMJ0KKZci2g/6o8Id/Gk/kokyudg+GiEuwrwLyBcCVIJTiseneZWYh2Uf+YqjUkHyNUt9jNDr4Qvb/YXZuFqYVefimr2HqbMxJhvXro+r37Jkwk8t7rHMKvFzkPw6ov0yos1MFgtP6c0x7QYr/8XR37ibmVH69xPtj+iVrSgjTKmEOC3M0LkJMjN8aWdU8ZkncdpmPW5zn7C5zzgcFQGDpqpCoS6mysvP1bsLjD0n7a5jlr5TFjvV26Z3VQV9ZQPsLStXc9VnLHD2AdZx2Cdgm4BpGE1B6D1o8aPVj64QrGPoGZdalsdo5VDvwoM+PPShNQTTKGyTkJn4/J7hfPsoYR0kzDxh8MkanbIWt8wQkHVyMnO/2CV6RojuCGEKE20+otVDGLxEu58Q3aGzosULYxjmAXTx6ODQFoQhsIdfooOFOQLrsIRlSKqOCTij6B0HKptwW4/KZlR3oq4b98242y6JFQ0o0+H6PVyrwo06VLWjwSHFiHaNTtQYpQG0eNDsRqML9TbUWaCzSENNfZK4j971z7G6A7Um6dKGXknUu/4C9meNYrKGECoAAAAASUVORK5CYII=","aspectRatio":1.5060240963855422,"src":"/static/dc2bce1fd13abc10f2e1d3abc9435a3b/0853f/header.png","srcSet":"/static/dc2bce1fd13abc10f2e1d3abc9435a3b/14156/header.png 125w,\n/static/dc2bce1fd13abc10f2e1d3abc9435a3b/d6e47/header.png 250w,\n/static/dc2bce1fd13abc10f2e1d3abc9435a3b/0853f/header.png 500w,\n/static/dc2bce1fd13abc10f2e1d3abc9435a3b/ce627/header.png 750w,\n/static/dc2bce1fd13abc10f2e1d3abc9435a3b/9dbcf/header.png 1000w,\n/static/dc2bce1fd13abc10f2e1d3abc9435a3b/87046/header.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"-gatsby-环境配置\" style=\"position:relative;\"><a href=\"#-gatsby-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE\" aria-label=\" gatsby 环境配置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🚀 Gatsby 环境配置</h2>\n<ol>\n<li>\n<p><strong>安装 Gatsby 命令行工具.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> -g gatsby-cli</code></pre></div>\n</li>\n<li>\n<p><strong>根据官方博客的 starter，创建一个新的 Gatsby 站点.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">gatsby new my-blog-starter https://github.com/gatsbyjs/gatsby-starter-blog</code></pre></div>\n</li>\n<li>\n<p><strong>本地开发环境.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> my-blog-starter/\ngatsby develop</code></pre></div>\n</li>\n<li>\n<p><strong>打开源代码并开始编辑!</strong></p>\n<p>你的站点运行在 <code class=\"language-text\">http://localhost:8000</code>!</p>\n<p>注意: 此链接的工具将会方便 graphql 数据查询: <code class=\"language-text\">http://localhost:8000/___graphql</code></p>\n<p>在您选择的代码编辑器中打开 my-blog-starter 目录，然后编辑 src / pages / index.js。 保存您的更改，浏览器将实时更新！</p>\n</li>\n</ol>\n<h2 id=\"-部署到-github-pages\" style=\"position:relative;\"><a href=\"#-%E9%83%A8%E7%BD%B2%E5%88%B0-github-pages\" aria-label=\" 部署到 github pages permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🌞 部署到 github pages</h2>\n<p>需要在 github 上上创建一个名字叫 username.github.io 的工程，比如本人的 github 用户名是 pipihua666，那么创建的工程名字就是<code class=\"language-text\">pipihua666.github.io</code></p>\n<ol>\n<li>\n<p>安装依赖</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> gh-pages --save-dev</code></pre></div>\n</li>\n<li>\n<p>找到 gatsby-config.js,添加 pathPrefix 配置，如果不需要路径，直接配置成 pathPrefix: /就可以。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">module.exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n pathPrefix: <span class=\"token variable\"><span class=\"token variable\">`</span>/project-name<span class=\"token variable\">`</span></span>,\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>在 package.json，配置 github 仓库并添加一个 scripts 配置，将先将静态文件 build 到 public 目录，然后再 push 到 github。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token string\">\"scripts\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token string\">\"deploy\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"gatsby build --prefix-paths  &amp;&amp; gh-pages -d public master\"</span>,\n <span class=\"token punctuation\">}</span>\n<span class=\"token string\">\"repository\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"type\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"git\"</span>,\n  <span class=\"token string\">\"url\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"git@github.com:pipihua666/pipihua666.github.io.git\"</span>\n<span class=\"token punctuation\">}</span>,</code></pre></div>\n</li>\n<li>\n<p>发布并上线</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> run deploy</code></pre></div>\n</li>\n</ol>\n<h2 id=\"🧐-文件夹约定规范\" style=\"position:relative;\"><a href=\"#%F0%9F%A7%90-%E6%96%87%E4%BB%B6%E5%A4%B9%E7%BA%A6%E5%AE%9A%E8%A7%84%E8%8C%83\" aria-label=\"🧐 文件夹约定规范 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🧐 文件夹约定规范</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.\n├── node_modules\n├── src\n├── .gitignore\n├── .prettierrc\n├── gatsby-browser.js\n├── gatsby-config.js\n├── gatsby-node.js\n├── gatsby-ssr.js\n├── LICENSE\n├── package-lock.json\n├── package.json\n└── README.md</code></pre></div>\n<ol>\n<li><strong><code class=\"language-text\">/src</code></strong>: 源代码</li>\n<li><strong><code class=\"language-text\">gatsby-browser.js</code></strong>:自定义/扩展影响浏览器的默认 Gatsby 设置。</li>\n<li><strong><code class=\"language-text\">gatsby-config.js</code></strong>: 这是 Gatsby 站点的主要配置文件。 您可以在此处指定有关您的网站（元数据）的信息，例如网站标题和说明，您要包括的 Gatsby 插件等。</li>\n<li><strong><code class=\"language-text\">gatsby-node.js</code></strong>:自定义/扩展默认的 Gatsby 设置，从而影响网站的构建过程。</li>\n<li><strong><code class=\"language-text\">gatsby-ssr.js</code></strong>:自定义影响服务器端渲染的默认 Gatsby 设置。</li>\n</ol>"},{"id":"cb8bd104-6fbf-5904-bacf-fc5e088d2498","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3}],"frontmatter":{"title":"Linux-文本操作","path":"/linux-text","tags":["Linux"],"excerpt":"linux-文本操作，个人记录学习","created":"2021-04-11T00:00:00.000Z","createdPretty":"11 April, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"11 April, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3ElEQVQoz01RaU8TURR905lpS4WwyFIgokYxEsWAVoGAURSIIEqCGAFBlFBUaKBQ1koZBMvSoQvQlk6HltJtCl1sS1voFokY/eQP8Rfw1SnVhJOT++479+S8l/dAUyfWxpe/ERLvxZbheef4kncaD8woQrPKgyQlyoMZRXAa948tegQY1TdhfD2oae2VPe3AQMcHGX9cN/LZKpa55lQ+qTokIyK4PionE1xN1Biuj6wQ4UVNEFN4Jxcdgk/Gd8KNV/wlMDC1MSndWVhz4jr/himitcQ2zVGdJUZYY7pEHyEsUbrXmsNq06HKEFzReDDcJsKIfpEcSJYJXGNXb3lIa1ClozRbLvNu2JLgIeWJewLf7c6I1Rl2fI3b3VGTI0RafOv6XanCMDWnAko1qTfZzJSbcvmLr12/V1F1GP3mDxzG40eUw7W0vBoIHHj9IYI0GrbNvv3Qnttrse/pyO0V+RowEBrKuu11UVYjiSIIl8tdwCR2IykRTzU11Av6esSi4eOgu7CAy7tdFvbu7TttHrvJuqXVKpeBdV3q1svD9k3FrAhm0EBYzJTyGyV1FeU70omfto3GmsqeFy05WRk5mRk+7eKBYdW3uexQYuT8KKAWBB7Z6JFOMtndDABgoilpqelrA22/VCM/8MHjpf4Y1t1VXQIgGEXgzeH2GD7k/fLRMdOrF7YDg+C5fbQ1ONMu76mDYQSGUTbr3NbbmmPRo/hg5W8hj1918VZRLgtF6Wis5U54rHl38ImRX6/qfADWX1Zvdz109tb6+bVXczMhCKJNQ7zcPx/zT4SsEzFcnJVQIIiRgiK2lhJfB0/9rFzWWCauLQU387PvXsi7f6mg/kphXloqOAWXg4pK2TuPEWEVzEQh+DQxk81sKMq6nM45z2Fnc9jpbBY4CyhhOz0nsWMAQF8VPjv/Xxn/BARmJIkm3jo5BvTKghlsBGIhybSkyGAhKBOhP5S2M2j+BU+JI3HgZJpGAAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/fd86a57a19d26f621fabca2e9cc0b4cc/0853f/header.png","srcSet":"/static/fd86a57a19d26f621fabca2e9cc0b4cc/14156/header.png 125w,\n/static/fd86a57a19d26f621fabca2e9cc0b4cc/d6e47/header.png 250w,\n/static/fd86a57a19d26f621fabca2e9cc0b4cc/0853f/header.png 500w,\n/static/fd86a57a19d26f621fabca2e9cc0b4cc/ce627/header.png 750w,\n/static/fd86a57a19d26f621fabca2e9cc0b4cc/9dbcf/header.png 1000w,\n/static/fd86a57a19d26f621fabca2e9cc0b4cc/87046/header.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"wc\" style=\"position:relative;\"><a href=\"#wc\" aria-label=\"wc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>wc</h2>\n<blockquote>\n<p>print newline, word, and byte counts for each file</p>\n</blockquote>\n<ul>\n<li>wc -l [文件名] // 计算文件的行数</li>\n<li>wc -c [文件名] // 计算文件字节数</li>\n<li>wc -w [文件名] // 计算文件字符数</li>\n</ul>\n<h2 id=\"stat\" style=\"position:relative;\"><a href=\"#stat\" aria-label=\"stat permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stat</h2>\n<blockquote>\n<p>display file or file system status</p>\n</blockquote>\n<ul>\n<li>LANG=c stat [filename] // 英文化查看文件的信息</li>\n</ul>\n<h2 id=\"grep\" style=\"position:relative;\"><a href=\"#grep\" aria-label=\"grep permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>grep</h2>\n<blockquote>\n<p>print lines matching a pattern</p>\n</blockquote>\n<ul>\n<li>grep [正则][文件名] 一行一行查找正则匹配的内容</li>\n</ul>\n<h2 id=\"find\" style=\"position:relative;\"><a href=\"#find\" aria-label=\"find permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>find</h2>\n<blockquote>\n<p>search for files in a directory hierarchy</p>\n</blockquote>\n<ul>\n<li>find *txt -exec rm -v {} ; // 查找文件并执行命令操作</li>\n</ul>\n<h2 id=\"time\" style=\"position:relative;\"><a href=\"#time\" aria-label=\"time permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>time</h2>\n<blockquote>\n<p>计算指令的执行时间</p>\n</blockquote>\n<ul>\n<li>time ls</li>\n</ul>\n<h2 id=\"cut\" style=\"position:relative;\"><a href=\"#cut\" aria-label=\"cut permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>cut</h2>\n<blockquote>\n<p>remove sections from each line of files</p>\n</blockquote>\n<ul>\n<li>cut -d \" \" -f 1 // 以空格分隔文本并显示第一个（相当于 split()[0]）</li>\n</ul>\n<p><a name=\"NrMVF\"></a></p>\n<h2 id=\"sed\" style=\"position:relative;\"><a href=\"#sed\" aria-label=\"sed permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sed</h2>\n<blockquote>\n<p>默认只替换每行的第一个</p>\n</blockquote>\n<p><a name=\"mmHID\"></a></p>\n<h3 id=\"sed-的工作模式\" style=\"position:relative;\"><a href=\"#sed-%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F\" aria-label=\"sed 的工作模式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sed 的工作模式</h3>\n<ul>\n<li>将文件以行为单位读取到内存（模式空间）</li>\n<li>使用 sed 的每个脚本对该行进行操作 sed \"script\" filename</li>\n<li>处理完成后输出该行（默认输出）</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sed</span> <span class=\"token string\">'a/lod/new/'</span> filename\n\n<span class=\"token comment\"># 如果要替换/，可以使用别的分隔符</span>\n<span class=\"token function\">sed</span> <span class=\"token string\">'s!/!abc!'</span> filename\n\n<span class=\"token comment\"># 执行多个命令</span>\n<span class=\"token function\">sed</span> -e <span class=\"token string\">'s/a/aa/'</span> -e <span class=\"token string\">'s/aa/bb/'</span> afile\n<span class=\"token function\">sed</span> <span class=\"token string\">'s/a/aa/;s/aa/bb/'</span> afile\n\n<span class=\"token comment\"># 将替换后的内容写入到原始文件</span>\n<span class=\"token function\">sed</span> -i <span class=\"token string\">'s/a/aa/;s/aa/bb/'</span> afile\n\n<span class=\"token comment\"># 支持元字符</span>\n<span class=\"token function\">head</span> -5 /etc/passwd <span class=\"token operator\">|</span> <span class=\"token function\">sed</span> <span class=\"token string\">'s/s*bin//'</span>\n\n<span class=\"token comment\"># 支持回调，源文件内容：axyzb</span>\n<span class=\"token comment\"># 扩展元字符使用 -r 参数</span>\nroot@4ebe31ff7a18:/tmp<span class=\"token comment\"># sed -r 's/(a.*b)/\\1:\\1/' cfile</span>\naxyzb:axyzb</code></pre></div>\n<p><a name=\"EUZxj\"></a></p>\n<h3 id=\"sed-替换指令加强版\" style=\"position:relative;\"><a href=\"#sed-%E6%9B%BF%E6%8D%A2%E6%8C%87%E4%BB%A4%E5%8A%A0%E5%BC%BA%E7%89%88\" aria-label=\"sed 替换指令加强版 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sed 替换指令加强版</h3>\n<ul>\n<li>\n<p>标志位：</p>\n<ul>\n<li>s/old/new/ 标志位</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 全局替换</span>\n<span class=\"token function\">sed</span> <span class=\"token string\">\"s/old/new/g\"</span> afile\n\n<span class=\"token comment\"># 替换前两次</span>\n<span class=\"token function\">sed</span> <span class=\"token string\">\"s/old/new/2\"</span> afile\n\n<span class=\"token comment\"># /p 打印模式空间的内容,匹配的行在下面再进行输出,应用：只输出替换成功的行, -n阻止默认输出</span>\n<span class=\"token function\">sed</span> -n <span class=\"token string\">'s/root/123/p'</span>\n\n<span class=\"token comment\"># /w 将替换成功的行写入别的文件</span>\n<span class=\"token function\">sed</span> -n <span class=\"token string\">'s/root/123/w a.txt'</span></code></pre></div>\n<ul>\n<li>\n<p>寻址：默认对每行进行操作，增加寻址后对匹配的行进行操作</p>\n<ul>\n<li>/正则表达式/s/old/new/g</li>\n<li>行号/s/old/new/g</li>\n<li>可以使用两个寻址符号，也可以混合使用行号和正则地址</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 从1-6行进行替换</span>\n<span class=\"token function\">head</span> -6 /etc/passwd <span class=\"token operator\">|</span> <span class=\"token function\">sed</span> <span class=\"token string\">'1,6s/games/!!!!!!!!/'</span>\n\n<span class=\"token comment\"># 匹配root行，进行替换</span>\n<span class=\"token function\">head</span> -6 /etc/passwd <span class=\"token operator\">|</span> <span class=\"token function\">sed</span> <span class=\"token string\">'/root/s/bash/!!!!!!!!/'</span>\n\n<span class=\"token comment\"># 多条命令</span>\n<span class=\"token function\">sed</span> /正则/<span class=\"token punctuation\">{</span>s/old/new/<span class=\"token punctuation\">;</span>s/old/new/<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>脚本文件：文件里写正常的 sed 命令</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sed</span> -f sedscript filename // 加载脚本文件</code></pre></div>\n<p><a name=\"sm3XA\"></a></p>\n<h3 id=\"sed-的其他常用命令\" style=\"position:relative;\"><a href=\"#sed-%E7%9A%84%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4\" aria-label=\"sed 的其他常用命令 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sed 的其他常用命令</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 删除行，删除操作会改变模式空间，就和管道的作用一样，后面的命令会以删除后的文件内容为准</span>\n<span class=\"token function\">sed</span> <span class=\"token string\">'/ab/d'</span> bfile\n<span class=\"token function\">sed</span> <span class=\"token string\">'/ab/d;='</span> bfile\n\n<span class=\"token comment\"># /i 在上一行插入</span>\n<span class=\"token function\">sed</span> <span class=\"token string\">'/ab/i hello'</span> bfile\n\n<span class=\"token comment\"># /a 在下一行插入</span>\n<span class=\"token function\">sed</span> <span class=\"token string\">'/ab/a hello'</span> bfile\n\n<span class=\"token comment\"># /c 替换行</span>\n<span class=\"token function\">sed</span> <span class=\"token string\">'/ab/c hello'</span> bfile\n\n<span class=\"token comment\"># /r 合并两个文件</span>\n<span class=\"token function\">sed</span> <span class=\"token string\">'/ab/r cfile'</span> bfile\n\n<span class=\"token comment\"># 打印行号 =</span>\n<span class=\"token function\">sed</span> <span class=\"token string\">\"=\"</span> bfile\n\n<span class=\"token comment\"># /n 操作匹配的下一行</span>\n\n<span class=\"token comment\"># 打印匹配行，这个替换中的p不同，通常和-n参数配合只打印匹配到的行</span>\n<span class=\"token function\">sed</span> -n <span class=\"token string\">'/ab/p'</span> bfile\n\n<span class=\"token comment\"># 退出命令</span>\n<span class=\"token function\">sed</span> 10q filename <span class=\"token comment\"># 不会把文件全部读入</span>\n<span class=\"token function\">sed</span> -n <span class=\"token number\">1</span>,10p filename</code></pre></div>\n<p><a name=\"UCTeJ\"></a></p>\n<h3 id=\"sed-多行模式\" style=\"position:relative;\"><a href=\"#sed-%E5%A4%9A%E8%A1%8C%E6%A8%A1%E5%BC%8F\" aria-label=\"sed 多行模式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sed 多行模式</h3>\n<ul>\n<li>N：将下一行加入到模式空间中</li>\n<li>D：删除模式空间中的第一个字符到第一个换行符</li>\n<li>P：打印模式空间中第一个字符到第一个换行符</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@4ebe31ff7a18:/tmp<span class=\"token comment\"># cat dfile</span>\nhel\nlo\nroot@4ebe31ff7a18:/tmp<span class=\"token comment\"># sed 'N;s/hel\\nlo/!!!/' dfile</span>\n<span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span>\nroot@4ebe31ff7a18:/tmp<span class=\"token comment\"># sed 'N;s/hel.lo/!!!/' dfile</span>\n<span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token operator\">!</span>\n\n<span class=\"token comment\"># 多行操作</span>\nroot@4ebe31ff7a18:/tmp<span class=\"token comment\"># cat b.txt</span>\nhell\no <span class=\"token function\">bash</span> hel\nlo <span class=\"token function\">bash</span>\n<span class=\"token comment\"># 两行连起来操作</span>\nroot@4ebe31ff7a18:/tmp<span class=\"token comment\"># sed 'N;s/\\n//;s/hello bash/hello sed\\n/;P;D' b.txt</span>\nhello <span class=\"token function\">sed</span>\n hello <span class=\"token function\">sed</span>\n<span class=\"token comment\"># 三行连起来操作</span>\n<span class=\"token function\">sed</span> <span class=\"token string\">'N;N;s/<span class=\"token entity\" title=\"\\n\">\\n</span>//;s/hello bash/hello sed<span class=\"token entity\" title=\"\\n\">\\n</span>/;P;D'</span> b.txt</code></pre></div>\n<p><a name=\"wYacy\"></a></p>\n<h2 id=\"awk\" style=\"position:relative;\"><a href=\"#awk\" aria-label=\"awk permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWK</h2>\n<p><a name=\"QYMuI\"></a></p>\n<h3 id=\"认识-awk\" style=\"position:relative;\"><a href=\"#%E8%AE%A4%E8%AF%86-awk\" aria-label=\"认识 awk permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>认识 awk</h3>\n<ul>\n<li>awk 更像是脚本语言</li>\n<li>awk 用于比较规范的文本处理，用于统计数量并输出指定字段</li>\n<li>sed 将不规范的文本，处理为比较规范的文本</li>\n</ul>\n<p><a name=\"qDTRG\"></a></p>\n<h3 id=\"awk-的字段\" style=\"position:relative;\"><a href=\"#awk-%E7%9A%84%E5%AD%97%E6%AE%B5\" aria-label=\"awk 的字段 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWK 的字段</h3>\n<ul>\n<li>每行称作 AWK 的记录</li>\n<li>使用空格、制表符分隔开的单词成为字段</li>\n<li>可以自己制定分隔的字段</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># -F 指定分隔符</span>\n<span class=\"token comment\"># x++：打印行号</span>\n<span class=\"token comment\"># ^menu：匹配行</span>\n<span class=\"token function\">awk</span> -F <span class=\"token string\">\"''\"</span> <span class=\"token string\">'/^menu/{ print x++, <span class=\"token variable\">$2</span> }'</span> /boot/grub2/grub.cfg</code></pre></div>\n<p><a name=\"zDdaT\"></a></p>\n<h3 id=\"awk-表达式\" style=\"position:relative;\"><a href=\"#awk-%E8%A1%A8%E8%BE%BE%E5%BC%8F\" aria-label=\"awk 表达式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWK 表达式</h3>\n<ul>\n<li>\n<p>系统变量</p>\n<ul>\n<li>FS 表示输入的内容用什么分隔，OFS 表示输出用什么符号分隔</li>\n<li>RS 行分隔符</li>\n<li>NR 打印行号，如果文件变化了 NR 是不会重新排号，FNR 则会重新排号</li>\n<li>NF 字段的数量</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 下面两行意义相同，BEGIN表示在输入内容之前的操作</span>\n<span class=\"token function\">head</span> -n <span class=\"token number\">6</span> /etc/passwd <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'BEGIN{FS=\":\"}{print <span class=\"token variable\">$1</span>}'</span>\n<span class=\"token function\">head</span> -n <span class=\"token number\">6</span> /etc/passwd <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F <span class=\"token string\">':'</span> <span class=\"token string\">'{print <span class=\"token variable\">$1</span>}\t'</span>\n\n<span class=\"token comment\"># 设置输出分隔符</span>\n<span class=\"token function\">head</span> -n <span class=\"token number\">6</span> /etc/passwd <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'BEGIN{FS=\":\";OFS=\"-\"}{print <span class=\"token variable\">$1</span>,<span class=\"token variable\">$2</span>}\n\n# 改变内容行的分隔符，改为通过:来换行，<span class=\"token variable\">$0</span>是输出一行\nhead -n 6 /etc/passwd | awk '</span>BEGIN<span class=\"token punctuation\">{</span>RS<span class=\"token operator\">=</span><span class=\"token string\">\":\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>print <span class=\"token variable\">$0</span><span class=\"token punctuation\">}</span><span class=\"token string\">'\n\n# 打印行号\nroot@709230c0b366:~# awk '</span><span class=\"token punctuation\">{</span>print NR, <span class=\"token variable\">$0</span><span class=\"token punctuation\">}</span><span class=\"token string\">' /etc/hosts /etc/hosts\n1 127.0.0.1    localhost\n2 ::1    localhost ip6-localhost ip6-loopback\n3 fe00::0    ip6-localnet\n4 ff00::0    ip6-mcastprefix\n5 ff02::1    ip6-allnodes\n6 ff02::2    ip6-allrouters\n7 172.17.0.4    709230c0b366\n8 127.0.0.1    localhost\n9 ::1    localhost ip6-localhost ip6-loopback\n10 fe00::0    ip6-localnet\n11 ff00::0    ip6-mcastprefix\n12 ff02::1    ip6-allnodes\n13 ff02::2    ip6-allrouters\n14 172.17.0.4    709230c0b366\nroot@709230c0b366:~# awk '</span><span class=\"token punctuation\">{</span>print FNR, <span class=\"token variable\">$0</span><span class=\"token punctuation\">}</span><span class=\"token string\">' /etc/hosts /etc/hosts\n1 127.0.0.1    localhost\n2 ::1    localhost ip6-localhost ip6-loopback\n3 fe00::0    ip6-localnet\n4 ff00::0    ip6-mcastprefix\n5 ff02::1    ip6-allnodes\n6 ff02::2    ip6-allrouters\n7 172.17.0.4    709230c0b366\n1 127.0.0.1    localhost\n2 ::1    localhost ip6-localhost ip6-loopback\n3 fe00::0    ip6-localnet\n4 ff00::0    ip6-mcastprefix\n5 ff02::1    ip6-allnodes\n6 ff02::2    ip6-allrouters\n7 172.17.0.4    709230c0b366\n\n# 打印有多少个字段\nhead -n 6 /etc/passwd | awk '</span>BEGIN<span class=\"token punctuation\">{</span>FS<span class=\"token operator\">=</span><span class=\"token string\">\":\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>print NF<span class=\"token punctuation\">}</span><span class=\"token string\">'\n\n# 打印最后一个字段的值\nhead -n 6 /etc/passwd | awk '</span>BEGIN<span class=\"token punctuation\">{</span>FS<span class=\"token operator\">=</span><span class=\"token string\">\":\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>print <span class=\"token variable\">$NF</span><span class=\"token punctuation\">}</span>'</code></pre></div>\n<p><a name=\"VHsAt\"></a></p>\n<h3 id=\"awk-的判断和循环\" style=\"position:relative;\"><a href=\"#awk-%E7%9A%84%E5%88%A4%E6%96%AD%E5%92%8C%E5%BE%AA%E7%8E%AF\" aria-label=\"awk 的判断和循环 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWK 的判断和循环</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@7dc8bb7d5702:/tmp<span class=\"token comment\"># cat a.txt</span>\nuser1 <span class=\"token number\">34</span> <span class=\"token number\">54</span> <span class=\"token number\">23</span> <span class=\"token number\">12</span>\nuser2 <span class=\"token number\">94</span> <span class=\"token number\">34</span> <span class=\"token number\">73</span> <span class=\"token number\">22</span>\nuser3 <span class=\"token number\">99</span> <span class=\"token number\">45</span> <span class=\"token number\">12</span> <span class=\"token number\">49</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk '{ if($2>80) {print $1,$2} }' a.txt</span>\nuser2 <span class=\"token number\">94</span>\nuser3 <span class=\"token number\">99</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk '{ for(c=2;c&lt;=NF;c++) print $c }' a.txt</span>\n<span class=\"token number\">34</span>\n<span class=\"token number\">54</span>\n<span class=\"token number\">23</span>\n<span class=\"token number\">12</span>\n<span class=\"token number\">94</span>\n<span class=\"token number\">34</span>\n<span class=\"token number\">73</span>\n<span class=\"token number\">22</span>\n<span class=\"token number\">99</span>\n<span class=\"token number\">45</span>\n<span class=\"token number\">12</span>\n<span class=\"token number\">49</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk '{ for(c=2;c&lt;=NF;c++) sum+=$c; print sum}' a.txt</span>\n<span class=\"token number\">123</span>\n<span class=\"token number\">346</span>\n<span class=\"token number\">551</span></code></pre></div>\n<p><a name=\"2YGNz\"></a></p>\n<h3 id=\"awk-数组\" style=\"position:relative;\"><a href=\"#awk-%E6%95%B0%E7%BB%84\" aria-label=\"awk 数组 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWK 数组</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># END表示数据读入完毕</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk '{ sum=0; for(c=2;c&lt;=NF;c++) sum+=$c; average[$1]=sum/(NF-1) }END{ for( user in average ) print user,average[user] }' a.txt</span>\nuser1 <span class=\"token number\">30.75</span>\nuser2 <span class=\"token number\">55.75</span>\nuser3 <span class=\"token number\">51.25</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># cat a.txt</span>\nuser1 <span class=\"token number\">34</span> <span class=\"token number\">54</span> <span class=\"token number\">23</span> <span class=\"token number\">12</span>\nuser2 <span class=\"token number\">94</span> <span class=\"token number\">34</span> <span class=\"token number\">73</span> <span class=\"token number\">22</span>\nuser3 <span class=\"token number\">99</span> <span class=\"token number\">45</span> <span class=\"token number\">12</span> <span class=\"token number\">49</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk '{ sum=0; for(c=2;c&lt;=NF;c++) sum+=$c; average[$1]=sum/(NF-1) }END{ for( user in average ) print user,average[user] }' a.txt</span>\nuser1 <span class=\"token number\">30.75</span>\nuser2 <span class=\"token number\">55.75</span>\nuser3 <span class=\"token number\">51.25</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk '{ sum=0; for(c=2;c&lt;=NF;c++) sum+=$c; average[$1]=sum/(NF-1) }END{ for( user in average ) sum2+=average[user]; print sum2/NR }' a.txt</span>\n<span class=\"token number\">45.9167</span></code></pre></div>\n<p><a name=\"53WWH\"></a></p>\n<h3 id=\"awk-数组的应用\" style=\"position:relative;\"><a href=\"#awk-%E6%95%B0%E7%BB%84%E7%9A%84%E5%BA%94%E7%94%A8\" aria-label=\"awk 数组的应用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWK 数组的应用</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@7dc8bb7d5702:/tmp<span class=\"token comment\"># cat a.txt</span>\nuser1 <span class=\"token number\">34</span> <span class=\"token number\">54</span> <span class=\"token number\">23</span> <span class=\"token number\">12</span>\nuser2 <span class=\"token number\">94</span> <span class=\"token number\">34</span> <span class=\"token number\">73</span> <span class=\"token number\">22</span>\nuser3 <span class=\"token number\">99</span> <span class=\"token number\">45</span> <span class=\"token number\">12</span> <span class=\"token number\">49</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># cat result.awk</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token function\">sum</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nfor<span class=\"token punctuation\">(</span>c <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> c <span class=\"token operator\">&lt;</span><span class=\"token operator\">=</span> NF<span class=\"token punctuation\">;</span> c++<span class=\"token punctuation\">)</span>\n    <span class=\"token function\">sum</span> <span class=\"token operator\">+=</span> <span class=\"token variable\">$c</span>\n\naverage<span class=\"token punctuation\">[</span><span class=\"token variable\">$1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">sum</span> / <span class=\"token punctuation\">(</span>NF - <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nprint <span class=\"token variable\">$1</span>, average<span class=\"token punctuation\">[</span><span class=\"token variable\">$1</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">}</span>\nEND<span class=\"token punctuation\">{</span>\nfor<span class=\"token punctuation\">(</span>user <span class=\"token keyword\">in</span> average<span class=\"token punctuation\">)</span>\n    sum_all <span class=\"token operator\">+=</span> average<span class=\"token punctuation\">[</span>user<span class=\"token punctuation\">]</span>\n\navg_all <span class=\"token operator\">=</span> sum_all / NR\n\nfor<span class=\"token punctuation\">(</span>user <span class=\"token keyword\">in</span> average<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>average<span class=\"token punctuation\">[</span>user<span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> avg_all<span class=\"token punctuation\">)</span>\n        above++\n    <span class=\"token keyword\">else</span>\n        below++\n\nprint <span class=\"token string\">\"above\"</span>, above\nprint <span class=\"token string\">\"below\"</span>, below\n\n<span class=\"token punctuation\">}</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk -f result.awk a.txt</span>\nuser1 <span class=\"token number\">30.75</span>\nuser2 <span class=\"token number\">55.75</span>\nuser3 <span class=\"token number\">51.25</span>\nabove <span class=\"token number\">2</span>\nbelow <span class=\"token number\">1</span></code></pre></div>\n<p><a name=\"CKQgY\"></a></p>\n<h3 id=\"awk-函数\" style=\"position:relative;\"><a href=\"#awk-%E5%87%BD%E6%95%B0\" aria-label=\"awk 函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AWK 函数</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 整数</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk 'BEGIN{pi=3.114; print int(pi)}'</span>\n<span class=\"token number\">3</span>\n\n<span class=\"token comment\"># 随机数</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk 'BEGIN{srand(); print rand()}'</span>\n<span class=\"token number\">0.739691</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk 'BEGIN{srand(); print rand()}'</span>\n<span class=\"token number\">0.00276686</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk 'BEGIN{srand(); print rand()}'</span>\n<span class=\"token number\">0.134305</span>\n\n<span class=\"token comment\"># 自定义函数</span>\nroot@7dc8bb7d5702:/tmp<span class=\"token comment\"># awk 'function double(str) {return str str} BEGIN{print double(\"hello\")}'</span>\nhellohello</code></pre></div>"},{"id":"087e5a98-e766-5fe1-b172-702aa6ddf103","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3}],"frontmatter":{"title":"Linux-shell","path":"/linux-shell","tags":["Linux"],"excerpt":"linux-shell，个人记录学习","created":"2021-04-11T00:00:00.000Z","createdPretty":"11 April, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"11 April, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC8klEQVQozw3RyW4bZQAA4HkQHoA3AAlx66ESAm5cqFRSkSbFcRPHY3s8+/r/4392z9iuPROPd894iZ2lbnHihGCaqi0SCREXKEtVJNQiwaEv0L7Ad/mwZGKVyt0VmZTEpQGXgXwGiXkk0khkTJnTBFYkSYmiRILgslkmnaK3k5mNOxurK2s3b2DJ5Hqe2GSoFJAIpBAyjysihYCgqxKSBcjzFpBrZqGCFEOSBJIk01vpZDL1zXri6xVMZdOGlLYKlK2Lpsa9IzTI+J6xU7bLNipqsGRogevUHMvVNFUQ2Bye3d7a2riTuL2KQWbTg3jNZFxDMFTG1XlBEtfSOVNVdjvhoFH1He2ejQLXqJjIhsBSJF3iRCpPbOMYS2YlJlcumg8eHMdx3Gm31vLqh59/ef2Ta0gR/Wp5HI/GcbdfL0/6vZIBbVW2oCKQFEMwGEngNIVDBKaHR8Pxbhi2uHDxGTPiZCMogWrFubr67e8Xr54++fn57/+OhiNFoMvFKhAUhqCxZqMNVd60oG4jVeNXcfI62H//lnqLQmFQ6rXCw6j/7WQ0HAxOFo/ajYYBlFq5ocoFCs9ir1/9/+Ozi4NpXKsZjkHdyLAfF2bvrYAvcDBt7kRhfTGfL8+W01H8cHYUtzu+V7GRAViiwNHY3v7keLG4PztcnJwe7PZE3fxI3/sg74bV4vL4eL44WT46v7z8pRd1w7A+jqKD6f1uWHdV1gIitp3fZGWqG41Pvnv2cP5DXQefZoSvZDXyUTfutTtBsOMOB5046taDYNjfbbeGisQzRDqb2sKId/ECQzKEhqBn37N5RgAFaBf9WslyVMvTy74fhK3+cDbePxvtfR/vL2udWcGs5wgRy+aTeSIBZcqzqyLFIcN2PdvzdNOxNct0K5VmO2o04/7k7PTpn7/+9d/zl2/OL/8ZHT5xvCZ2c/124u4G4CGgSYFjaZKgqYwkkSKEsu4Bxy/VBzutSTw9m51ePf7pxeOLl0fnf0zmF7oVvAXjurvNWDzUaQAAAABJRU5ErkJggg==","aspectRatio":1.5060240963855422,"src":"/static/f2df1ce3efc76701a8251a8b9d07f035/0853f/header.png","srcSet":"/static/f2df1ce3efc76701a8251a8b9d07f035/14156/header.png 125w,\n/static/f2df1ce3efc76701a8251a8b9d07f035/d6e47/header.png 250w,\n/static/f2df1ce3efc76701a8251a8b9d07f035/0853f/header.png 500w,\n/static/f2df1ce3efc76701a8251a8b9d07f035/ce627/header.png 750w,\n/static/f2df1ce3efc76701a8251a8b9d07f035/9dbcf/header.png 1000w,\n/static/f2df1ce3efc76701a8251a8b9d07f035/87046/header.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"shell-脚本的不同运行方式\" style=\"position:relative;\"><a href=\"#shell-%E8%84%9A%E6%9C%AC%E7%9A%84%E4%B8%8D%E5%90%8C%E8%BF%90%E8%A1%8C%E6%96%B9%E5%BC%8F\" aria-label=\"shell 脚本的不同运行方式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Shell 脚本的不同运行方式</h2>\n<ul>\n<li>内建命令不需要创建子进程</li>\n<li>内建命令对当前 shell 生效</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">bash</span> <span class=\"token number\">1</span>.sh\n<span class=\"token comment\"># 不用给1.sh赋予执行权限，bash脚本执行完后会回到当前目录</span>\n<span class=\"token comment\"># 会产生新的子进程</span>\n\n./1.sh\n<span class=\"token comment\"># 必须要可执行权限，bash脚本执行完后会回到当前目录</span>\n<span class=\"token comment\"># 会产生新的子进程</span>\n\n<span class=\"token builtin class-name\">source</span> <span class=\"token number\">1</span>.sh 和 <span class=\"token builtin class-name\">.</span> <span class=\"token number\">1</span>.sh\n<span class=\"token comment\"># 必须要可执行权限，bash脚本执行完后不会回到当前目录</span>\n<span class=\"token comment\"># 不会创建新的子进程</span></code></pre></div>\n<p><a name=\"i9qSO\"></a></p>\n<h2 id=\"管道与重定向\" style=\"position:relative;\"><a href=\"#%E7%AE%A1%E9%81%93%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91\" aria-label=\"管道与重定向 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>管道与重定向</h2>\n<blockquote>\n<p>管道和信号是一样的，也是进程通信的方式之一</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 输入重定向</span>\n<span class=\"token operator\">&lt;</span>\n\n<span class=\"token comment\"># 输出重定向</span>\n<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># 追加模式</span>\n<span class=\"token operator\">>></span>\n\n<span class=\"token comment\"># 将a.txt文件内容赋值给变量ss</span>\n<span class=\"token builtin class-name\">read</span> ss <span class=\"token operator\">&lt;</span> a.txt\n\n<span class=\"token comment\"># 将ss变量内容写入到文件中</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$ss</span> <span class=\"token operator\">></span> a.txt\n\n<span class=\"token comment\"># 将ss变量内容追加到文件中</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$ss</span> <span class=\"token operator\">>></span> a.txt\n\n<span class=\"token comment\"># 将错误信息重定向到文件中</span>\nxxx <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span> a.txt\n\n<span class=\"token comment\"># 将输出信息全部重定向到文件中</span>\nxxx <span class=\"token operator\">&amp;></span> a.txt</code></pre></div>\n<p><a name=\"DPoUT\"></a></p>\n<h2 id=\"变量的赋值\" style=\"position:relative;\"><a href=\"#%E5%8F%98%E9%87%8F%E7%9A%84%E8%B5%8B%E5%80%BC\" aria-label=\"变量的赋值 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>变量的赋值</h2>\n<ul>\n<li>shell 中不区分变量类型</li>\n<li>变量赋值等号两边不允许有空格</li>\n<li>将命令的值赋值给变量，使用 $() 和 ``</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token assign-left variable\">a</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ls</span> -l /etc<span class=\"token variable\">)</span></span></code></pre></div>\n<p><a name=\"Yfx5Z\"></a></p>\n<h3 id=\"\" style=\"position:relative;\"><a href=\"#\" aria-label=\" permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><a name=\"Lj0JN\"></a></p>\n<h2 id=\"变量的作用范围\" style=\"position:relative;\"><a href=\"#%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%9C%E7%94%A8%E8%8C%83%E5%9B%B4\" aria-label=\"变量的作用范围 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>变量的作用范围</h2>\n<ul>\n<li>声明的变量只在当前的 shell 中生效，在子进程、父进程和 bash xx.sh 中都是不生效的，要想使得变量在 bash xx.sh 中生效，需要执行 source xx.sh 或者. xx.sh，因为这两种方式都不会创建新的子进程</li>\n<li>使用 export xx，可以使该变量在子进程中可用</li>\n<li>使用 unset xx，删除变量</li>\n</ul>\n<p><a name=\"VifoM\"></a></p>\n<h2 id=\"环境变量、预定义变量和位置变量\" style=\"position:relative;\"><a href=\"#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E3%80%81%E9%A2%84%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F%E5%92%8C%E4%BD%8D%E7%BD%AE%E5%8F%98%E9%87%8F\" aria-label=\"环境变量、预定义变量和位置变量 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>环境变量、预定义变量和位置变量</h2>\n<p><a name=\"fXmLm\"></a></p>\n<h3 id=\"环境变量每个-shell-打开都可以获取到的变量\" style=\"position:relative;\"><a href=\"#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%AF%8F%E4%B8%AA-shell-%E6%89%93%E5%BC%80%E9%83%BD%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%8F%96%E5%88%B0%E7%9A%84%E5%8F%98%E9%87%8F\" aria-label=\"环境变量每个 shell 打开都可以获取到的变量 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>环境变量每个 shell 打开都可以获取到的变量</h3>\n<ul>\n<li>env 查看环境变量</li>\n<li>set 查看环境变量、预定义变量和位置变量</li>\n<li>PATH 该变量定义了命令查找的路径，我们需要添加路径时可以 PATH=$PATH:xx，该变量修改后可以在子进程和别的 shell 中生效，因为被 export 了</li>\n<li>PS1 设置 shell 中提示\n<a name=\"Qjcoy\"></a></li>\n</ul>\n<h3 id=\"预定义变量\" style=\"position:relative;\"><a href=\"#%E9%A2%84%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F\" aria-label=\"预定义变量 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>预定义变量</h3>\n<ul>\n<li>$?上一条命令是否执行成功，成功的话返回 0</li>\n<li>$$\n$$</li>\n<li>$0 当前执行的程序,比如 bash\n<a name=\"o7DzA\"></a></li>\n</ul>\n<h3 id=\"位置变量获取命令行参数\" style=\"position:relative;\"><a href=\"#%E4%BD%8D%E7%BD%AE%E5%8F%98%E9%87%8F%E8%8E%B7%E5%8F%96%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0\" aria-label=\"位置变量获取命令行参数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>位置变量(获取命令行参数)</h3>\n<ul>\n<li>$1......$n 特别注意的是当大于等于 10 时，必须写成${10}...${xx}</li>\n<li>$* 和 $@ 代表所有位置参数</li>\n<li>$#代表位置参数的数量</li>\n<li>如果想给位置变量设置默认值可以用${1-xx}，xx 就是设置的默认值</li>\n</ul>\n<br />\n<a name=\"06JSY\"></a>\n### 环境变量配置文件\n<a name=\"zdAS3\"></a>\n#### 所有用户都可用的环境变量保存在\n<ul>\n<li>/etc/profile</li>\n<li>/etc/profile.d</li>\n<li>/etc/bashrc\n<a name=\"Nd42S\"></a></li>\n</ul>\n<h3 id=\"用户自定义的环境变量\" style=\"position:relative;\"><a href=\"#%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F\" aria-label=\"用户自定义的环境变量 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>用户自定义的环境变量</h3>\n<ul>\n<li>~/.bashrc</li>\n<li>~/.bash_profile</li>\n</ul>\n<p><a name=\"5onOE\"></a></p>\n<h2 id=\"数组\" style=\"position:relative;\"><a href=\"#%E6%95%B0%E7%BB%84\" aria-label=\"数组 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>数组</h2>\n<p><a name=\"iMbNR\"></a></p>\n<h3 id=\"定义数组\" style=\"position:relative;\"><a href=\"#%E5%AE%9A%E4%B9%89%E6%95%B0%E7%BB%84\" aria-label=\"定义数组 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>定义数组</h3>\n<ul>\n<li>IPTS=(1 2 3 4)\n<a name=\"EzMuA\"></a></li>\n</ul>\n<h3 id=\"显示所有元素\" style=\"position:relative;\"><a href=\"#%E6%98%BE%E7%A4%BA%E6%89%80%E6%9C%89%E5%85%83%E7%B4%A0\" aria-label=\"显示所有元素 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>显示所有元素</h3>\n<ul>\n<li>echo ${IPTS[@]}\n<a name=\"w3ZXj\"></a></li>\n</ul>\n<h3 id=\"显示长度\" style=\"position:relative;\"><a href=\"#%E6%98%BE%E7%A4%BA%E9%95%BF%E5%BA%A6\" aria-label=\"显示长度 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>显示长度</h3>\n<ul>\n<li>echo ${#IPTS[@]}\n<a name=\"qyfN5\"></a></li>\n</ul>\n<h3 id=\"获取第一个元素\" style=\"position:relative;\"><a href=\"#%E8%8E%B7%E5%8F%96%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0\" aria-label=\"获取第一个元素 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>获取第一个元素</h3>\n<ul>\n<li>echo ${IPTS[0]}<br /></li>\n</ul>\n<p><a name=\"0s3Fh\"></a></p>\n<h2 id=\"转义与引用\" style=\"position:relative;\"><a href=\"#%E8%BD%AC%E4%B9%89%E4%B8%8E%E5%BC%95%E7%94%A8\" aria-label=\"转义与引用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>转义与引用</h2>\n<blockquote>\n<p>注意单引号 ` 是不对特殊字符进行解释，双引号” 会对特殊字符进行解释</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># $a</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'<span class=\"token variable\">$a</span>'</span>\n\n<span class=\"token comment\"># 1</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">$a</span>\"</span></code></pre></div>\n<ul>\n<li>反引号 ` 可以获取命令执行的结果</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token assign-left variable\">num1</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">expr</span> <span class=\"token number\">4</span> + <span class=\"token number\">5</span><span class=\"token variable\">`</span></span>\n<span class=\"token comment\"># 9</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$num1</span></code></pre></div>\n<p><a name=\"Qzhxz\"></a></p>\n<h2 id=\"运算符\" style=\"position:relative;\"><a href=\"#%E8%BF%90%E7%AE%97%E7%AC%A6\" aria-label=\"运算符 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>运算符</h2>\n<p><a name=\"r9MEo\"></a></p>\n<h3 id=\"赋值运算符\" style=\"position:relative;\"><a href=\"#%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6\" aria-label=\"赋值运算符 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>赋值运算符</h3>\n<p><a name=\"HSkcr\"></a></p>\n<h3 id=\"算数运算符\" style=\"position:relative;\"><a href=\"#%E7%AE%97%E6%95%B0%E8%BF%90%E7%AE%97%E7%AC%A6\" aria-label=\"算数运算符 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>算数运算符</h3>\n<ul>\n<li>expr 4 + 5 只能支持整数</li>\n<li>((4+5))((a=9))((a++))是 let 的简化方式</li>\n</ul>\n<p><a name=\"FMSpu\"></a></p>\n<h2 id=\"特殊符号大全\" style=\"position:relative;\"><a href=\"#%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7%E5%A4%A7%E5%85%A8\" aria-label=\"特殊符号大全 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>特殊符号大全</h2>\n<ul>\n<li>$()和反引号``的作用一样，里面包含需要执行的命令</li>\n<li>()会创建一个新的 shell</li>\n<li>[]是 test 命令的简写</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token number\">5</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 1</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$?</span></code></pre></div>\n<ul>\n<li>{}输出范围和快速操作</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 0 1 2 3 4 5 6 7 8 9</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">..</span><span class=\"token number\">9</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># mv 1.sh 1.sh.bak</span>\n➜ <span class=\"token function\">mv</span> <span class=\"token number\">1</span>.sh<span class=\"token punctuation\">{</span>,.bak<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>;会确保上一条命令执行完在执行下一条</li>\n<li>&#x26;&#x26;上一条命令执行成功后执行下一条</li>\n<li>:类似于 python 中的 pass</li>\n</ul>\n<p><a name=\"pSaDt\"></a></p>\n<h2 id=\"test-命令\" style=\"position:relative;\"><a href=\"#test-%E5%91%BD%E4%BB%A4\" aria-label=\"test 命令 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>test 命令</h2>\n<p><a name=\"s5Zdd\"></a></p>\n<h3 id=\"退出程序命令\" style=\"position:relative;\"><a href=\"#%E9%80%80%E5%87%BA%E7%A8%8B%E5%BA%8F%E5%91%BD%E4%BB%A4\" aria-label=\"退出程序命令 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>退出程序命令</h3>\n<ul>\n<li>exit 会返回上一条命令的成功与否</li>\n<li>exit 10 返回值 10，非 0 则是不正常退出\n<a name=\"YvvVv\"></a></li>\n</ul>\n<h3 id=\"test-命令可以用来检查文件或者比较值\" style=\"position:relative;\"><a href=\"#test-%E5%91%BD%E4%BB%A4%E5%8F%AF%E4%BB%A5%E7%94%A8%E6%9D%A5%E6%A3%80%E6%9F%A5%E6%96%87%E4%BB%B6%E6%88%96%E8%80%85%E6%AF%94%E8%BE%83%E5%80%BC\" aria-label=\"test 命令可以用来检查文件或者比较值 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>test 命令可以用来检查文件或者比较值</h3>\n<ul>\n<li>\n<p>test 可以做一下测试</p>\n<ul>\n<li>文件测试</li>\n<li>整数比较测试</li>\n<li>字符串测试</li>\n</ul>\n</li>\n<li>test 测试语句可以简化为 [] 符号</li>\n<li>[] 还有扩展写法 [[]] 支持 &#x26;&#x26;、|| 等</li>\n</ul>\n<p><a name=\"ofm71\"></a></p>\n<h2 id=\"if-else\" style=\"position:relative;\"><a href=\"#if-else\" aria-label=\"if else permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>if else</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"start\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">$0</span> start...\"</span>\n<span class=\"token keyword\">elif</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"stop\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">$0</span> stop...\"</span>\n<span class=\"token keyword\">else</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Usage: <span class=\"token variable\">$0</span> {start|stop}\"</span>\n<span class=\"token keyword\">fi</span></code></pre></div>\n<p><a name=\"awwSV\"></a></p>\n<h2 id=\"case\" style=\"position:relative;\"><a href=\"#case\" aria-label=\"case permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>case</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token keyword\">case</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token keyword\">in</span>\n    <span class=\"token string\">\"start\"</span> <span class=\"token operator\">|</span> <span class=\"token string\">\"START\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">$0</span> start...\"</span>\n    <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token string\">\"stop\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">$0</span> stop...\"</span>\n    <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n\n    *<span class=\"token punctuation\">)</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Usage: <span class=\"token variable\">$0</span> {start|stop}\"</span>\n    <span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">esac</span></code></pre></div>\n<p><a name=\"hOKtR\"></a></p>\n<h2 id=\"for\" style=\"position:relative;\"><a href=\"#for\" aria-label=\"for permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>for</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">filename</span> <span class=\"token keyword\">in</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ls</span> *.mp3<span class=\"token variable\">)</span></span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n    <span class=\"token function\">mv</span> <span class=\"token variable\">$filename</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">basename</span> $filename .mp3<span class=\"token variable\">)</span></span>.mp4\n<span class=\"token keyword\">done</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token variable\"><span class=\"token punctuation\">((</span> i<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;=</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span> <span class=\"token punctuation\">))</span></span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$i</span>\n<span class=\"token keyword\">done</span></code></pre></div>\n<p><a name=\"vwyW5\"></a></p>\n<h2 id=\"while\" style=\"position:relative;\"><a href=\"#while\" aria-label=\"while permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>while</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token assign-left variable\">n</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\n<span class=\"token comment\"># [[ $n &lt; 10 ]] 不能用于条件判断</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">[</span>  <span class=\"token variable\">$n</span> -lt <span class=\"token number\">10</span> <span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">do</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$n</span>\n    <span class=\"token variable\"><span class=\"token punctuation\">((</span>n<span class=\"token operator\">++</span><span class=\"token punctuation\">))</span></span>\n\n<span class=\"token keyword\">done</span></code></pre></div>\n<p><a name=\"kmlve\"></a></p>\n<h2 id=\"嵌套\" style=\"position:relative;\"><a href=\"#%E5%B5%8C%E5%A5%97\" aria-label=\"嵌套 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>嵌套</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">filename</span> <span class=\"token keyword\">in</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ls</span> *.mp4<span class=\"token variable\">)</span></span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -x <span class=\"token variable\">$filename</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$filename</span> <span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">break</span>\n    <span class=\"token keyword\">fi</span>\n<span class=\"token keyword\">done</span></code></pre></div>\n<p><a name=\"G8e3J\"></a></p>\n<h2 id=\"循环处理位置参数\" style=\"position:relative;\"><a href=\"#%E5%BE%AA%E7%8E%AF%E5%A4%84%E7%90%86%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0\" aria-label=\"循环处理位置参数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>循环处理位置参数</h2>\n<ul>\n<li>$#  位置参数的数量</li>\n<li>$*  所有的位置参数</li>\n<li>$0  脚本名称</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token comment\"># for</span>\n<span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">args</span> <span class=\"token keyword\">in</span> <span class=\"token variable\">$*</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$args</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"help\"</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">$args</span>\"</span> <span class=\"token string\">\"<span class=\"token variable\">$args</span>\"</span>\n    <span class=\"token keyword\">fi</span>\n<span class=\"token keyword\">done</span>\n\n<span class=\"token comment\"># while</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$#</span>\"</span> -ge <span class=\"token number\">1</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"help\"</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n        <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span>\n    <span class=\"token keyword\">fi</span>\n    <span class=\"token builtin class-name\">shift</span>\n<span class=\"token keyword\">done</span></code></pre></div>\n<p><a name=\"kHwkR\"></a></p>\n<h2 id=\"自定义函数\" style=\"position:relative;\"><a href=\"#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0\" aria-label=\"自定义函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>自定义函数</h2>\n<ul>\n<li>local  声明函数内的变量</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function-name function\">checkpid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin class-name\">local</span> i\n\n    <span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">i</span> <span class=\"token keyword\">in</span> <span class=\"token variable\">$*</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n        <span class=\"token punctuation\">[</span> -d <span class=\"token string\">\"/proc/<span class=\"token variable\">$i</span>\"</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">return</span> <span class=\"token number\">0</span>\n    <span class=\"token keyword\">done</span>\n\n    <span class=\"token builtin class-name\">return</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a name=\"gKUfg\"></a></p>\n<h2 id=\"脚本控制\" style=\"position:relative;\"><a href=\"#%E8%84%9A%E6%9C%AC%E6%8E%A7%E5%88%B6\" aria-label=\"脚本控制 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>脚本控制</h2>\n<p><a name=\"iFerV\"></a></p>\n<h3 id=\"fork-炸弹---\" style=\"position:relative;\"><a href=\"#fork-%E7%82%B8%E5%BC%B9---\" aria-label=\"fork 炸弹    permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fork 炸弹 - .(){.|.&#x26;};.</h3>\n<blockquote>\n<p>普通用户创建的线程数是受到控制的，可以通过 ulimit -a 控制</p>\n</blockquote>\n<p><a name=\"UEMzC\"></a></p>\n<h2 id=\"捕获信号\" style=\"position:relative;\"><a href=\"#%E6%8D%95%E8%8E%B7%E4%BF%A1%E5%8F%B7\" aria-label=\"捕获信号 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>捕获信号</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># kill -l</span>\n<span class=\"token number\">1</span><span class=\"token punctuation\">)</span> SIGHUP     <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> SIGINT     <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> SIGQUIT     <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> SIGILL     <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> SIGTRAP\n<span class=\"token number\">6</span><span class=\"token punctuation\">)</span> SIGABRT     <span class=\"token number\">7</span><span class=\"token punctuation\">)</span> SIGBUS     <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> SIGFPE     <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> SIGKILL    <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> SIGUSR1\n<span class=\"token number\">11</span><span class=\"token punctuation\">)</span> SIGSEGV    <span class=\"token number\">12</span><span class=\"token punctuation\">)</span> SIGUSR2    <span class=\"token number\">13</span><span class=\"token punctuation\">)</span> SIGPIPE    <span class=\"token number\">14</span><span class=\"token punctuation\">)</span> SIGALRM    <span class=\"token number\">15</span><span class=\"token punctuation\">)</span> SIGTERM\n<span class=\"token number\">16</span><span class=\"token punctuation\">)</span> SIGSTKFLT    <span class=\"token number\">17</span><span class=\"token punctuation\">)</span> SIGCHLD    <span class=\"token number\">18</span><span class=\"token punctuation\">)</span> SIGCONT    <span class=\"token number\">19</span><span class=\"token punctuation\">)</span> SIGSTOP    <span class=\"token number\">20</span><span class=\"token punctuation\">)</span> SIGTSTP\n<span class=\"token number\">21</span><span class=\"token punctuation\">)</span> SIGTTIN    <span class=\"token number\">22</span><span class=\"token punctuation\">)</span> SIGTTOU    <span class=\"token number\">23</span><span class=\"token punctuation\">)</span> SIGURG    <span class=\"token number\">24</span><span class=\"token punctuation\">)</span> SIGXCPU    <span class=\"token number\">25</span><span class=\"token punctuation\">)</span> SIGXFSZ\n<span class=\"token number\">26</span><span class=\"token punctuation\">)</span> SIGVTALRM    <span class=\"token number\">27</span><span class=\"token punctuation\">)</span> SIGPROF    <span class=\"token number\">28</span><span class=\"token punctuation\">)</span> SIGWINCH    <span class=\"token number\">29</span><span class=\"token punctuation\">)</span> SIGIO    <span class=\"token number\">30</span><span class=\"token punctuation\">)</span> SIGPWR\n<span class=\"token number\">31</span><span class=\"token punctuation\">)</span> SIGSYS    <span class=\"token number\">34</span><span class=\"token punctuation\">)</span> SIGRTMIN    <span class=\"token number\">35</span><span class=\"token punctuation\">)</span> SIGRTMIN+1    <span class=\"token number\">36</span><span class=\"token punctuation\">)</span> SIGRTMIN+2    <span class=\"token number\">37</span><span class=\"token punctuation\">)</span> SIGRTMIN+3\n<span class=\"token number\">38</span><span class=\"token punctuation\">)</span> SIGRTMIN+4    <span class=\"token number\">39</span><span class=\"token punctuation\">)</span> SIGRTMIN+5    <span class=\"token number\">40</span><span class=\"token punctuation\">)</span> SIGRTMIN+6    <span class=\"token number\">41</span><span class=\"token punctuation\">)</span> SIGRTMIN+7    <span class=\"token number\">42</span><span class=\"token punctuation\">)</span> SIGRTMIN+8\n<span class=\"token number\">43</span><span class=\"token punctuation\">)</span> SIGRTMIN+9    <span class=\"token number\">44</span><span class=\"token punctuation\">)</span> SIGRTMIN+10    <span class=\"token number\">45</span><span class=\"token punctuation\">)</span> SIGRTMIN+11    <span class=\"token number\">46</span><span class=\"token punctuation\">)</span> SIGRTMIN+12    <span class=\"token number\">47</span><span class=\"token punctuation\">)</span> SIGRTMIN+13\n<span class=\"token number\">48</span><span class=\"token punctuation\">)</span> SIGRTMIN+14    <span class=\"token number\">49</span><span class=\"token punctuation\">)</span> SIGRTMIN+15    <span class=\"token number\">50</span><span class=\"token punctuation\">)</span> SIGRTMAX-14    <span class=\"token number\">51</span><span class=\"token punctuation\">)</span> SIGRTMAX-13    <span class=\"token number\">52</span><span class=\"token punctuation\">)</span> SIGRTMAX-12\n<span class=\"token number\">53</span><span class=\"token punctuation\">)</span> SIGRTMAX-11    <span class=\"token number\">54</span><span class=\"token punctuation\">)</span> SIGRTMAX-10    <span class=\"token number\">55</span><span class=\"token punctuation\">)</span> SIGRTMAX-9    <span class=\"token number\">56</span><span class=\"token punctuation\">)</span> SIGRTMAX-8    <span class=\"token number\">57</span><span class=\"token punctuation\">)</span> SIGRTMAX-7\n<span class=\"token number\">58</span><span class=\"token punctuation\">)</span> SIGRTMAX-6    <span class=\"token number\">59</span><span class=\"token punctuation\">)</span> SIGRTMAX-5    <span class=\"token number\">60</span><span class=\"token punctuation\">)</span> SIGRTMAX-4    <span class=\"token number\">61</span><span class=\"token punctuation\">)</span> SIGRTMAX-3    <span class=\"token number\">62</span><span class=\"token punctuation\">)</span> SIGRTMAX-2\n<span class=\"token number\">63</span><span class=\"token punctuation\">)</span> SIGRTMAX-1    <span class=\"token number\">64</span><span class=\"token punctuation\">)</span> SIGRTMAX</code></pre></div>\n<p><a name=\"gb4xZ\"></a></p>\n<h2 id=\"trap-捕获信号\" style=\"position:relative;\"><a href=\"#trap-%E6%8D%95%E8%8E%B7%E4%BF%A1%E5%8F%B7\" aria-label=\"trap 捕获信号 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>trap 捕获信号</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token builtin class-name\">trap</span> <span class=\"token string\">\"echo 15\"</span> <span class=\"token number\">15</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$$</span>\n\n<span class=\"token keyword\">while</span> <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n    <span class=\"token builtin class-name\">:</span>\n<span class=\"token keyword\">done</span></code></pre></div>\n<p><a name=\"2wMfj\"></a></p>\n<h2 id=\"计划任务\" style=\"position:relative;\"><a href=\"#%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1\" aria-label=\"计划任务 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>计划任务</h2>\n<p><a name=\"zC7l8\"></a></p>\n<h3 id=\"一次性的计划任务at-命令\" style=\"position:relative;\"><a href=\"#%E4%B8%80%E6%AC%A1%E6%80%A7%E7%9A%84%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1at-%E5%91%BD%E4%BB%A4\" aria-label=\"一次性的计划任务at 命令 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>一次性的计划任务:at 命令</h3>\n<ul>\n<li>没有标准输出，需要使用重定向</li>\n<li>在 at 命令中执行的 shell 命令如果不是系统内置命令，需要使用命令的完整路径</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">at <span class=\"token number\">18</span>:31 （在18点31执行任务，ctrl + d退出<span class=\"token punctuation\">)</span>\natq （显示一次性任务的列表）</code></pre></div>\n<p><a name=\"GmdEF\"></a></p>\n<h3 id=\"周期性计划任务（同一次性任务有标准输出流和命令路径的问题）\" style=\"position:relative;\"><a href=\"#%E5%91%A8%E6%9C%9F%E6%80%A7%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%EF%BC%88%E5%90%8C%E4%B8%80%E6%AC%A1%E6%80%A7%E4%BB%BB%E5%8A%A1%E6%9C%89%E6%A0%87%E5%87%86%E8%BE%93%E5%87%BA%E6%B5%81%E5%92%8C%E5%91%BD%E4%BB%A4%E8%B7%AF%E5%BE%84%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%89\" aria-label=\"周期性计划任务（同一次性任务有标准输出流和命令路径的问题） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>周期性计划任务（同一次性任务有标准输出流和命令路径的问题）</h3>\n<ul>\n<li>/var/log/cron 任务的日志</li>\n<li>/var/spool/cron 用户的计划任务</li>\n<li>配置方式 crontabl -e</li>\n<li>查看现有的计划任务 crontab -l</li>\n<li>\n<p>配置方式: 分钟 小时 日期 月份 星期 执行的命令</p>\n<ul>\n<li>比如 1 1 1 1 1-5 echo crontab （1 月 1 日 1 时 1 分 如果是周一到周五，就输出 crontab）</li>\n</ul>\n</li>\n</ul>\n<p><a name=\"uWBR6\"></a></p>\n<h2 id=\"计划任务加锁\" style=\"position:relative;\"><a href=\"#%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E5%8A%A0%E9%94%81\" aria-label=\"计划任务加锁 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>计划任务加锁</h2>\n<p><a name=\"cYVMR\"></a></p>\n<h3 id=\"延时计划任务即使系统遇到了关机等影响计划任务的事情，也能让计划任务延时运行起来\" style=\"position:relative;\"><a href=\"#%E5%BB%B6%E6%97%B6%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E5%8D%B3%E4%BD%BF%E7%B3%BB%E7%BB%9F%E9%81%87%E5%88%B0%E4%BA%86%E5%85%B3%E6%9C%BA%E7%AD%89%E5%BD%B1%E5%93%8D%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E7%9A%84%E4%BA%8B%E6%83%85%EF%BC%8C%E4%B9%9F%E8%83%BD%E8%AE%A9%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E5%BB%B6%E6%97%B6%E8%BF%90%E8%A1%8C%E8%B5%B7%E6%9D%A5\" aria-label=\"延时计划任务即使系统遇到了关机等影响计划任务的事情，也能让计划任务延时运行起来 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>延时计划任务即使系统遇到了关机等影响计划任务的事情，也能让计划任务延时运行起来</h3>\n<ul>\n<li>/etc/cron.d/0hourly 系统记录计划任务的是否运行（每小时）</li>\n<li>/etc/anacrontab 延时任务文件夹 （每天、每周、每月）\n<a name=\"vQG0a\"></a></li>\n</ul>\n<h3 id=\"flock--xn-tmpflock--c-rootash-一段时间只能运行一个脚本\" style=\"position:relative;\"><a href=\"#flock--xn-tmpflock--c-rootash-%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4%E5%8F%AA%E8%83%BD%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AA%E8%84%9A%E6%9C%AC\" aria-label=\"flock  xn tmpflock  c rootash 一段时间只能运行一个脚本 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>flock -xn \"tmp/f.lock\" -c \"/root/a.sh\" 一段时间只能运行一个脚本</h3>\n<ul>\n<li>/tmp/f.lock 锁存放的文件路径</li>\n<li>需要锁住的命令/root/a.sh</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 加锁</span>\nflock -xn <span class=\"token string\">\"/tmp/f.lock\"</span> -c <span class=\"token string\">\"/tmp/1.sh\"</span>\n\n<span class=\"token comment\"># 另外一个地方执行该脚本时就会直接退出</span>\nflock -xn <span class=\"token string\">\"/tmp/f.lock\"</span> -c <span class=\"token string\">\"/tmp/1.sh\"</span></code></pre></div>"},{"id":"78c8831a-9006-585a-b0f7-b36601e9884b","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3}],"frontmatter":{"title":"Linux-基础命令","path":"/linux-basic","tags":["Linux"],"excerpt":"linux-基础命令，个人记录学习","created":"2021-04-11T00:00:00.000Z","createdPretty":"11 April, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"11 April, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC4UlEQVQozx3La2/SUAAG4H7xN/h3/AF+0S/+AGfizBY1TtQNxmVe4iU6nSiDMgb0cgoU2h7ac2gPdKPAGHSyjbFxm24zRs28LDNGjR+0mjx58+ZNXgrKlw18Y4m4y6Xpcsn7j+krmwFracZa8lWtYGX5nmU6o9/Zl0s+s+g1S15ieDFyU5p6gxQ8JeItOgwfMfwOg/gMEtDJM6tm1urEbpWba7JuBFDB59Cw16GiaUqCrjya+s8NkUdB0zL2Q30OGRnTsuzWoG4Ptja3Dt5/e3/4NV98xkhuHvoBDAA4QyVzLg5OctDNKR5WmWYVf0K5I0C2aLbqq11NM5Zjp3eFk0f1c58/7H4+/mE2cCj1KJqbi0kvqGjqJp2epFNT0YyHznjpjCcqzmJiv9n7dPjp++wjj+sUVZg48S5Eva2cP/z65+ev33ElHM48TShhSoAuAK+z8jVGnmBkV1J2xeVboh6sNqu9/sfW+k7wcSB2+8xy8rRd4Trb+1+OjjvDzUXpCQODlIyvyvplqTAu4rEUGhfUcaBdYmQPK0Z0K10glc72wXZvb6M9tF/11ta7ne7+1nA9od5fkO5SWTwikxGJjOSMC6J+MYVHARoV0HUBX2Fys1CpxrI0K8X6O+863T29KlirtWZ7lZZ8UecclUZYbZTHYwBdA2iS13ysOsOpM0B7kFbTqpEfmzvLyIlytd1Y7yFLScg0QOm4wsYVgbrPPX0uBuflcFRZjCncopKJQymZh2xe5TWNgXnX/BiHsKjXcqQuYEvAVV6rALQCsE09AaVQrhyBlYV8PanaHGpxaAPgNo8204VuHDamFvzZYlckA5H0RTIUya4jW3yTJXtUOLORyO+wWp/T+jwa8GjIa/9wag+g15Hsipu+IxYOeG3Aq31e7bGwy8IdJxNSm3pIm3PJWoi3w8JaGDTnQTPEN16y9efJ6kum8TCWmwjeXMxsREAtItQjQs0pNFgJc5UXcfMvw0IRJ2WhivgAAAAASUVORK5CYII=","aspectRatio":1.5060240963855422,"src":"/static/203778e71300e5b2843da99252e9a12a/0853f/header.png","srcSet":"/static/203778e71300e5b2843da99252e9a12a/14156/header.png 125w,\n/static/203778e71300e5b2843da99252e9a12a/d6e47/header.png 250w,\n/static/203778e71300e5b2843da99252e9a12a/0853f/header.png 500w,\n/static/203778e71300e5b2843da99252e9a12a/ce627/header.png 750w,\n/static/203778e71300e5b2843da99252e9a12a/9dbcf/header.png 1000w,\n/static/203778e71300e5b2843da99252e9a12a/87046/header.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"创建多个嵌套目录\" style=\"position:relative;\"><a href=\"#%E5%88%9B%E5%BB%BA%E5%A4%9A%E4%B8%AA%E5%B5%8C%E5%A5%97%E7%9B%AE%E5%BD%95\" aria-label=\"创建多个嵌套目录 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>创建多个嵌套目录</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">mkdir</span> -p a/b/c</code></pre></div>\n<h2 id=\"查看嵌套目录\" style=\"position:relative;\"><a href=\"#%E6%9F%A5%E7%9C%8B%E5%B5%8C%E5%A5%97%E7%9B%AE%E5%BD%95\" aria-label=\"查看嵌套目录 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>查看嵌套目录</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"> <span class=\"token function\">ls</span> -R ./</code></pre></div>\n<h2 id=\"显示文件大小，单位-bkmg\" style=\"position:relative;\"><a href=\"#%E6%98%BE%E7%A4%BA%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%EF%BC%8C%E5%8D%95%E4%BD%8D-bkmg\" aria-label=\"显示文件大小，单位 bkmg permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>显示文件大小，单位 B,K,M,G</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"> <span class=\"token function\">ls</span> -h</code></pre></div>\n<h2 id=\"复制文件保留元信息（复制文件默认会修改文件的元信息\" style=\"position:relative;\"><a href=\"#%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6%E4%BF%9D%E7%95%99%E5%85%83%E4%BF%A1%E6%81%AF%EF%BC%88%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6%E9%BB%98%E8%AE%A4%E4%BC%9A%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E7%9A%84%E5%85%83%E4%BF%A1%E6%81%AF\" aria-label=\"复制文件保留元信息（复制文件默认会修改文件的元信息 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>复制文件保留元信息（复制文件默认会修改文件的元信息</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"> <span class=\"token function\">cp</span> -a a b</code></pre></div>\n<h2 id=\"通配符，只匹配一个字符\" style=\"position:relative;\"><a href=\"#%E9%80%9A%E9%85%8D%E7%AC%A6%EF%BC%8C%E5%8F%AA%E5%8C%B9%E9%85%8D%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6\" aria-label=\"通配符，只匹配一个字符 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>通配符，只匹配一个字符</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"> <span class=\"token function\">ls</span> a?\n<span class=\"token comment\"># 会匹配 ab 不会匹配 abc</span></code></pre></div>\n<h2 id=\"打包文件，解包文件\" style=\"position:relative;\"><a href=\"#%E6%89%93%E5%8C%85%E6%96%87%E4%BB%B6%EF%BC%8C%E8%A7%A3%E5%8C%85%E6%96%87%E4%BB%B6\" aria-label=\"打包文件，解包文件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>打包文件，解包文件</h2>\n<ul>\n<li>将 a 目录下的文件打包成 xxx.tar 文件，f 表示打包成文件</li>\n<li>tar 命令的参数是不带 - 的</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 打包文件</span>\n<span class=\"token function\">tar</span> cf xxx.tar /a\n\n<span class=\"token comment\"># 解包文件</span>\n<span class=\"token function\">tar</span> xf xxx.tar -C /a</code></pre></div>\n<h2 id=\"压缩文件，解压文件\" style=\"position:relative;\"><a href=\"#%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%EF%BC%8C%E8%A7%A3%E5%8E%8B%E6%96%87%E4%BB%B6\" aria-label=\"压缩文件，解压文件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>压缩文件，解压文件</h2>\n<ul>\n<li>bzip2 压缩的文件方式要比 gzip 小，压缩比例更高</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># gzip 压缩文件，打包文件加压缩</span>\n<span class=\"token function\">tar</span> czf xxx.tar.gz /a\n\n<span class=\"token comment\">#gzip 解压文件</span>\n<span class=\"token function\">tar</span> xzf xxx.tar.gz -C /a\n\n<span class=\"token comment\"># bzip2 压缩文件，打包文件加压缩</span>\n<span class=\"token function\">tar</span> cjf xxx.tar.bz2 /a\n\n<span class=\"token comment\">#bzip2解压文件</span>\n<span class=\"token function\">tar</span> xjf xx.tar.gz <span class=\"token punctuation\">\\</span>_v /a</code></pre></div>\n<h2 id=\"vim\" style=\"position:relative;\"><a href=\"#vim\" aria-label=\"vim permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>vim</h2>\n<h3 id=\"进入插入模式：\" style=\"position:relative;\"><a href=\"#%E8%BF%9B%E5%85%A5%E6%8F%92%E5%85%A5%E6%A8%A1%E5%BC%8F%EF%BC%9A\" aria-label=\"进入插入模式： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>进入插入模式：</h3>\n<ul>\n<li><code class=\"language-text\">i</code>：当前位置进入插入模式</li>\n<li><code class=\"language-text\">I</code>：跳转到行前进入插入模式</li>\n<li><code class=\"language-text\">a</code>：跳转到下一个字符进入插入模式</li>\n<li><code class=\"language-text\">A</code>：跳转到行尾进入插入模式</li>\n<li><code class=\"language-text\">o</code>：下一行进入插入模式</li>\n<li><code class=\"language-text\">O</code>：上一行进入插入模式</li>\n</ul>\n<h3 id=\"命令行模式\" style=\"position:relative;\"><a href=\"#%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%A8%A1%E5%BC%8F\" aria-label=\"命令行模式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>命令行模式</h3>\n<ul>\n<li><code class=\"language-text\">:!</code>：可以执行 Linux 命令</li>\n<li><code class=\"language-text\">:s/a/b</code>：对当前行进行替换</li>\n<li><code class=\"language-text\">:%s/a/b/g</code>：对所有符合条件的内容进行替换</li>\n<li><code class=\"language-text\">:10,25s/a/b/g</code>：对 10-25 行中的内容进行替换</li>\n<li><code class=\"language-text\">:.,+2s/a/b/g</code>：当前行.与接下来两行+2：</li>\n<li><code class=\"language-text\">/foo\\c</code>：在查找模式中加入\\c 表示大小写不敏感查找，\\C 表示大小写敏感查找</li>\n</ul>\n<h3 id=\"替换标志\" style=\"position:relative;\"><a href=\"#%E6%9B%BF%E6%8D%A2%E6%A0%87%E5%BF%97\" aria-label=\"替换标志 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>替换标志</h3>\n<ul>\n<li><code class=\"language-text\">c</code> 需要确认，例如:%s/foo/bar/gc 全局查找\"foo\"替换为\"bar\"并且需要确认</li>\n<li><code class=\"language-text\">i</code> 表示大小写不敏感查找,I 表示大小写敏感</li>\n<li><code class=\"language-text\">g</code> 表示全局 global 替换（即替换目标的所有出现)</li>\n</ul>\n<h3 id=\"可视模式\" style=\"position:relative;\"><a href=\"#%E5%8F%AF%E8%A7%86%E6%A8%A1%E5%BC%8F\" aria-label=\"可视模式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>可视模式</h3>\n<ul>\n<li><code class=\"language-text\">v</code>：字符可视模式</li>\n<li><code class=\"language-text\">V</code>：行可视模式</li>\n<li><code class=\"language-text\">^+v</code>：块可视模式</li>\n<li><code class=\"language-text\">I</code>：可以在块模式下编辑多行，编辑完后按两下 esc 键，修改就会同步到其他行</li>\n<li><code class=\"language-text\">d</code>：在块模式下，删除多行选中的字符</li>\n</ul>\n<h3 id=\"复制\" style=\"position:relative;\"><a href=\"#%E5%A4%8D%E5%88%B6\" aria-label=\"复制 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>复制</h3>\n<ul>\n<li><code class=\"language-text\">yy</code>：复制正行</li>\n<li><code class=\"language-text\">n yy</code>：复制 n 行</li>\n<li><code class=\"language-text\">y\\$</code>：从当前字符复制到行尾</li>\n<li><code class=\"language-text\">p</code>：粘贴</li>\n</ul>\n<h3 id=\"剪切\" style=\"position:relative;\"><a href=\"#%E5%89%AA%E5%88%87\" aria-label=\"剪切 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>剪切</h3>\n<ul>\n<li><code class=\"language-text\">dd</code>：剪切整行</li>\n<li><code class=\"language-text\">n dd</code>：剪切 n 行</li>\n<li><code class=\"language-text\">d\\$</code>：剪切当前字符到行尾</li>\n</ul>\n<h3 id=\"撤销\" style=\"position:relative;\"><a href=\"#%E6%92%A4%E9%94%80\" aria-label=\"撤销 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>撤销</h3>\n<ul>\n<li><code class=\"language-text\">^+r</code>：反向撤销</li>\n<li><code class=\"language-text\">u</code>：撤销</li>\n</ul>\n<h3 id=\"替换\" style=\"position:relative;\"><a href=\"#%E6%9B%BF%E6%8D%A2\" aria-label=\"替换 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>替换</h3>\n<ul>\n<li><code class=\"language-text\">r</code>：替换单个字符</li>\n<li><code class=\"language-text\">x</code>：删除单个字符</li>\n</ul>\n<h3 id=\"跳转到指定行\" style=\"position:relative;\"><a href=\"#%E8%B7%B3%E8%BD%AC%E5%88%B0%E6%8C%87%E5%AE%9A%E8%A1%8C\" aria-label=\"跳转到指定行 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>跳转到指定行</h3>\n<ul>\n<li><code class=\"language-text\">n G</code>：跳转到第 n 行</li>\n<li><code class=\"language-text\">gg</code>：跳转到第一行</li>\n<li><code class=\"language-text\">G</code>：跳转到最后一行</li>\n<li><code class=\"language-text\">\\$</code>：跳转到该行的行尾</li>\n<li><code class=\"language-text\">^</code>：跳转到该行的行首</li>\n</ul>\n<h2 id=\"常用配置\" style=\"position:relative;\"><a href=\"#%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE\" aria-label=\"常用配置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>常用配置</h2>\n<h3 id=\"设置默认进行大小写不敏感查找\" style=\"position:relative;\"><a href=\"#%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E8%BF%9B%E8%A1%8C%E5%A4%A7%E5%B0%8F%E5%86%99%E4%B8%8D%E6%95%8F%E6%84%9F%E6%9F%A5%E6%89%BE\" aria-label=\"设置默认进行大小写不敏感查找 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>设置默认进行大小写不敏感查找</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">:set ignorecase</code></pre></div>\n<h3 id=\"如果有一个大写字母，则切换到大小写敏感查找\" style=\"position:relative;\"><a href=\"#%E5%A6%82%E6%9E%9C%E6%9C%89%E4%B8%80%E4%B8%AA%E5%A4%A7%E5%86%99%E5%AD%97%E6%AF%8D%EF%BC%8C%E5%88%99%E5%88%87%E6%8D%A2%E5%88%B0%E5%A4%A7%E5%B0%8F%E5%86%99%E6%95%8F%E6%84%9F%E6%9F%A5%E6%89%BE\" aria-label=\"如果有一个大写字母，则切换到大小写敏感查找 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>如果有一个大写字母，则切换到大小写敏感查找</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">:set smartcase</code></pre></div>\n<h3 id=\"可以在敲键的同时搜索，按下回车把移动光标移动到匹配的词；-按下-esc-取消搜索。\" style=\"position:relative;\"><a href=\"#%E5%8F%AF%E4%BB%A5%E5%9C%A8%E6%95%B2%E9%94%AE%E7%9A%84%E5%90%8C%E6%97%B6%E6%90%9C%E7%B4%A2%EF%BC%8C%E6%8C%89%E4%B8%8B%E5%9B%9E%E8%BD%A6%E6%8A%8A%E7%A7%BB%E5%8A%A8%E5%85%89%E6%A0%87%E7%A7%BB%E5%8A%A8%E5%88%B0%E5%8C%B9%E9%85%8D%E7%9A%84%E8%AF%8D%EF%BC%9B-%E6%8C%89%E4%B8%8B-esc-%E5%8F%96%E6%B6%88%E6%90%9C%E7%B4%A2%E3%80%82\" aria-label=\"可以在敲键的同时搜索，按下回车把移动光标移动到匹配的词； 按下 esc 取消搜索。 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>可以在敲键的同时搜索，按下回车把移动光标移动到匹配的词； 按下 Esc 取消搜索。</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">:set incsearch</code></pre></div>\n<h3 id=\"用来设置到文件尾部后是否重新从文件头开始搜索。\" style=\"position:relative;\"><a href=\"#%E7%94%A8%E6%9D%A5%E8%AE%BE%E7%BD%AE%E5%88%B0%E6%96%87%E4%BB%B6%E5%B0%BE%E9%83%A8%E5%90%8E%E6%98%AF%E5%90%A6%E9%87%8D%E6%96%B0%E4%BB%8E%E6%96%87%E4%BB%B6%E5%A4%B4%E5%BC%80%E5%A7%8B%E6%90%9C%E7%B4%A2%E3%80%82\" aria-label=\"用来设置到文件尾部后是否重新从文件头开始搜索。 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>用来设置到文件尾部后是否重新从文件头开始搜索。</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">:set wrapscan</code></pre></div>\n<h3 id=\"禁用高亮\" style=\"position:relative;\"><a href=\"#%E7%A6%81%E7%94%A8%E9%AB%98%E4%BA%AE\" aria-label=\"禁用高亮 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>禁用高亮</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">:set nohlsearch</code></pre></div>\n<h3 id=\"启用高亮\" style=\"position:relative;\"><a href=\"#%E5%90%AF%E7%94%A8%E9%AB%98%E4%BA%AE\" aria-label=\"启用高亮 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>启用高亮</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">:set hlsearch</code></pre></div>"},{"id":"d8d509c0-719b-5a2c-8754-c4880e61ed76","headings":[{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":2},{"depth":3},{"depth":2},{"depth":2}],"frontmatter":{"title":"Linux-服务管理","path":"/linux-service","tags":["Linux"],"excerpt":"linux-服务管理，个人记录学习","created":"2021-04-11T00:00:00.000Z","createdPretty":"11 April, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"11 April, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJElEQVQozwEZA+b8ABAPDhUgLRMZIBYgKhokMB04UwlRiwFKfgNFdgFAbwE9agE7ZwE4ZgE3ZQE1YwI0YgI0YQEzYgEzYgIzYQAQDw0UGR4YJDEYHSMcJS0fJSkgSm4EU4oASnsCR3YCQ3EBP20DPmwEPWwDO2wBPHAAN20BN2oBNWgANGgAEhMWEhANFyMtFRshHycxLDlKRF5/PGqWC1SEAE1+A0x8A0d6AEB1ADp1AD15BjpqEUJyBkF7CUR+DUV9AA4VHxcYHS83SENTcFhskF58qFJ2oktwmDNlkRdYiQZLgQBIghlaj050lTxLVjtAOkA/OR0yTBcsShoqQQBBSl13g6KHkrKJlrODkax6iaNwhqBYeZxFbJQ/Z5FniqqJobOfpaippJzAuaOmpI6OhnpPTVEqLDclJzMAqbPIpbHGnaa5jZeqlZurlZqrhY2gbX+XV3GTUm2Rio2MzsrAlZSQo6WjqKqmgH99wbmqxbijoJOFSEI7AL7Aw7q+w660vZ2ktoiTqHZ/jYKJnHaDnVxzk1t2oB8vTHh6d9DSynZ4eeXm35OUkVpbWtDOwtDJto2HeADKzszS0c7FxMmpq7xxfn48SEksOExOWXJeb41Zc51NY4sVGyqvsKzn59/g4djT0suSko9tbWxwcGyhn5YAusLFt73FtLfLgImRVWRcMzxAHys4DhIhU1xzeoqrW3urKDtbJSYn19bK4+PZ3t3Ux8fAi4uFcXFubW1qAMO7sLWvtoaKl1VlX0ZQTB0kLiAqNA4QHFNYcImSs2d+plJokAAAA1pcXenp3OHh1oaGgCMjI1BPTpeWkQC7rKOgmqBUYVxKWFIpMDIaIysdIywLDBY+Q1t3f55weZlodZ4wOlQCBQyNjYfo5tra2c45OTkzMzJdXVcAqI+NWl1YQE1FNz46GiAkHSguFRgfHBsiOz9ISlZcTVZlYWqXTFaAEBcmHSIsuLar3dvOmJeOFhYVNjY2AFpfbT9KPis2NxsjKBUbIhQcJQ4OFCQjJz5ARTA6RB8qMUpai1Vopys2WQAAAD8/P83MwNPRxJiYkYiHgSdtMYpo6E3kAAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/2488e7022098906f1e790b6c6b7279a3/0853f/header.png","srcSet":"/static/2488e7022098906f1e790b6c6b7279a3/14156/header.png 125w,\n/static/2488e7022098906f1e790b6c6b7279a3/d6e47/header.png 250w,\n/static/2488e7022098906f1e790b6c6b7279a3/0853f/header.png 500w,\n/static/2488e7022098906f1e790b6c6b7279a3/ce627/header.png 750w,\n/static/2488e7022098906f1e790b6c6b7279a3/9dbcf/header.png 1000w,\n/static/2488e7022098906f1e790b6c6b7279a3/87046/header.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<p><a name=\"4LcBi\"></a></p>\n<h2 id=\"防火墙的概述：\" style=\"position:relative;\"><a href=\"#%E9%98%B2%E7%81%AB%E5%A2%99%E7%9A%84%E6%A6%82%E8%BF%B0%EF%BC%9A\" aria-label=\"防火墙的概述： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>防火墙的概述：</h2>\n<p><a name=\"npBbA\"></a></p>\n<h3 id=\"软件防火墙，主要限制-ip，过滤-ip-等\" style=\"position:relative;\"><a href=\"#%E8%BD%AF%E4%BB%B6%E9%98%B2%E7%81%AB%E5%A2%99%EF%BC%8C%E4%B8%BB%E8%A6%81%E9%99%90%E5%88%B6-ip%EF%BC%8C%E8%BF%87%E6%BB%A4-ip-%E7%AD%89\" aria-label=\"软件防火墙，主要限制 ip，过滤 ip 等 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>软件防火墙，主要限制 ip，过滤 ip 等</h3>\n<ul>\n<li>包过滤防火墙，比如 ip，iptables 就是包过滤防火墙</li>\n<li>应用层防火墙，比如根据系统用户来控制\n<a name=\"Db2J4\"></a></li>\n</ul>\n<h3 id=\"硬件防火墙，用来防-dos-攻击等，也兼顾一些软件防火墙的功能\" style=\"position:relative;\"><a href=\"#%E7%A1%AC%E4%BB%B6%E9%98%B2%E7%81%AB%E5%A2%99%EF%BC%8C%E7%94%A8%E6%9D%A5%E9%98%B2-dos-%E6%94%BB%E5%87%BB%E7%AD%89%EF%BC%8C%E4%B9%9F%E5%85%BC%E9%A1%BE%E4%B8%80%E4%BA%9B%E8%BD%AF%E4%BB%B6%E9%98%B2%E7%81%AB%E5%A2%99%E7%9A%84%E5%8A%9F%E8%83%BD\" aria-label=\"硬件防火墙，用来防 dos 攻击等，也兼顾一些软件防火墙的功能 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>硬件防火墙，用来防 dos 攻击等，也兼顾一些软件防火墙的功能</h3>\n<blockquote>\n<p>Centos 6 默认使用的防火墙是 iptables,\nCentos 7 是 firewallD，\n但这两者底层都是内核中的 filter 过滤表来进行实际的控制</p>\n</blockquote>\n<p><a name=\"Au3lM\"></a></p>\n<h2 id=\"iptables-的表和链\" style=\"position:relative;\"><a href=\"#iptables-%E7%9A%84%E8%A1%A8%E5%92%8C%E9%93%BE\" aria-label=\"iptables 的表和链 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>iptables 的表和链</h2>\n<p><a name=\"Jqrw9\"></a></p>\n<h3 id=\"规则表\" style=\"position:relative;\"><a href=\"#%E8%A7%84%E5%88%99%E8%A1%A8\" aria-label=\"规则表 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>规则表</h3>\n<ul>\n<li>filter,用来过滤</li>\n<li>nat，地址转换</li>\n<li>其他查看 man iptables\n<a name=\"hjkma\"></a></li>\n</ul>\n<h3 id=\"规则链确定规则的方向\" style=\"position:relative;\"><a href=\"#%E8%A7%84%E5%88%99%E9%93%BE%E7%A1%AE%E5%AE%9A%E8%A7%84%E5%88%99%E7%9A%84%E6%96%B9%E5%90%91\" aria-label=\"规则链确定规则的方向 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>规则链(确定规则的方向)</h3>\n<ul>\n<li>INPUT，外部请求进入当前主机</li>\n<li>OUTPUT，当前主机发出的数据包</li>\n<li>FORWARD，数据包经过当前主机转给其他主机</li>\n<li>PREROUTING，路由前</li>\n<li>POSTROUTING，路由后</li>\n</ul>\n<p><a name=\"v7mOl\"></a></p>\n<h2 id=\"iptables-filter-表\" style=\"position:relative;\"><a href=\"#iptables-filter-%E8%A1%A8\" aria-label=\"iptables filter 表 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>iptables filter 表</h2>\n<ul>\n<li>iptales -t filter 命令 规则链 规则</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># -v 显示更详细信息</span>\n<span class=\"token comment\"># -n 不进行反向域名解析</span>\n<span class=\"token comment\"># -L 显示iptables信息</span>\n<span class=\"token comment\"># 所以查看防火墙的配置可以使用iptables -t filter -vnL</span>\n<span class=\"token punctuation\">[</span>root@iz2zeje77jss3tlyqj8p12z ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># iptables -t filter -vnL</span>\nChain INPUT <span class=\"token punctuation\">(</span>policy ACCEPT <span class=\"token number\">0</span> packets, <span class=\"token number\">0</span> bytes<span class=\"token punctuation\">)</span>\n pkts bytes target     prot opt <span class=\"token keyword\">in</span>     out     <span class=\"token builtin class-name\">source</span>               destination\n\nChain FORWARD <span class=\"token punctuation\">(</span>policy ACCEPT <span class=\"token number\">0</span> packets, <span class=\"token number\">0</span> bytes<span class=\"token punctuation\">)</span>\n pkts bytes target     prot opt <span class=\"token keyword\">in</span>     out     <span class=\"token builtin class-name\">source</span>               destination\n\nChain OUTPUT <span class=\"token punctuation\">(</span>policy ACCEPT <span class=\"token number\">0</span> packets, <span class=\"token number\">0</span> bytes<span class=\"token punctuation\">)</span>\n pkts bytes target     prot opt <span class=\"token keyword\">in</span>     out     <span class=\"token builtin class-name\">source</span>               destination</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"> <span class=\"token comment\"># 增加iptables规则</span>\n <span class=\"token comment\"># -A 在规则后加入 -I 在规则前加入（靠前的优先级高）</span>\n <span class=\"token comment\"># -s 源地址 -d 目的地址</span>\n <span class=\"token comment\"># -j 指定是ACCEPT还是DROP</span>\n <span class=\"token punctuation\">[</span>root@iz2zeje77jss3tlyqj8p12z ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># iptables -t filter -A INPUT -s 10.0.0.1 -j ACCEPT</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"> <span class=\"token comment\"># 下面默认规则都是ACCEPT，如果没有匹配到我们指定的规则，最后就会匹配默认规则</span>\n<span class=\"token punctuation\">[</span>root@iz2zeje77jss3tlyqj8p12z ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># iptables -nvL</span>\nChain INPUT <span class=\"token punctuation\">(</span>policy ACCEPT <span class=\"token number\">49</span> packets, <span class=\"token number\">3361</span> bytes<span class=\"token punctuation\">)</span>\n pkts bytes target     prot opt <span class=\"token keyword\">in</span>     out     <span class=\"token builtin class-name\">source</span>               destination\n    <span class=\"token number\">0</span>     <span class=\"token number\">0</span> ACCEPT     all  --  *      *       <span class=\"token number\">10.0</span>.0.1             <span class=\"token number\">0.0</span>.0.0/0\n\nChain FORWARD <span class=\"token punctuation\">(</span>policy ACCEPT <span class=\"token number\">0</span> packets, <span class=\"token number\">0</span> bytes<span class=\"token punctuation\">)</span>\n pkts bytes target     prot opt <span class=\"token keyword\">in</span>     out     <span class=\"token builtin class-name\">source</span>               destination\n\nChain OUTPUT <span class=\"token punctuation\">(</span>policy ACCEPT <span class=\"token number\">31</span> packets, <span class=\"token number\">8484</span> bytes<span class=\"token punctuation\">)</span>\n pkts bytes target     prot opt <span class=\"token keyword\">in</span>     out     <span class=\"token builtin class-name\">source</span>               destination\n\n <span class=\"token comment\"># 修改默认规则，以下为拒绝所有INPUT的ip连接</span>\n iptables -P INPUT DROP\n\n <span class=\"token comment\"># 清空所有自定义规则，不会修改默认规则</span>\n iptables -F\n\n <span class=\"token comment\"># 清空某个规则</span>\n iptables -D 序列号\n\n <span class=\"token comment\"># 多个规则</span>\n <span class=\"token comment\"># -i 指定网络接口（网卡）</span>\n <span class=\"token comment\"># -p 指定协议tcp/udp</span>\n <span class=\"token comment\"># -dport 指定端口</span>\niptables -t filter -A INPUT -i eth0 -s <span class=\"token number\">10.0</span>.0.2 -p tcp --dport <span class=\"token number\">80</span> -j ACCEPT</code></pre></div>\n<p><a name=\"Z16YH\"></a></p>\n<h2 id=\"iptables-nat-表\" style=\"position:relative;\"><a href=\"#iptables-nat-%E8%A1%A8\" aria-label=\"iptables nat 表 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>iptables nat 表</h2>\n<ul>\n<li>iptables -t nat 命令 规则链 规则</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 修改目的地址，转发到10.0.0.1上</span>\niptables -t nat -A PREROUTING -i eth0 -d <span class=\"token number\">114.115</span>.116.117 -p tcp -dport <span class=\"token number\">80</span> -j DNAT --to-destination <span class=\"token number\">10.0</span>.0.1\n\n<span class=\"token comment\"># 修改源地址，将内网ip都改为出口IP地址</span>\niptables -t nat -A POSTROUTING -s <span class=\"token number\">10.0</span>.0.0/24 -o eth1 -j SNAT --to-source <span class=\"token number\">111.112</span>.113.114</code></pre></div>\n<blockquote>\n<p>iptables 自定义的规则默认是存在内存中的，需要持久化\n可以直接在 /etc/sysconfig/iptables 中写数据，也可以下载工具将内存中的数据写到文件中 yum install iptables-services</p>\n</blockquote>\n<p><a name=\"szxJF\"></a></p>\n<h2 id=\"ssh\" style=\"position:relative;\"><a href=\"#ssh\" aria-label=\"ssh permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSH</h2>\n<p><a name=\"xVyDj\"></a></p>\n<h3 id=\"ssh-服务配置文件---sshd_config\" style=\"position:relative;\"><a href=\"#ssh-%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6---sshd_config\" aria-label=\"ssh 服务配置文件   sshd_config permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ssh 服务配置文件 - sshd_config</h3>\n<ul>\n<li>Port 22 默认端口</li>\n<li>PermitRootLogin yes 是否允许 root 登录</li>\n<li>AuthorizedKeysFile .ssh/authorized_keys 秘钥认证文件</li>\n</ul>\n<br />\n<a name=\"lxoKU\"></a>\n### 将公钥拷贝到服务器上\n<ul>\n<li>ssh-copy-id -i /root/.ssh/id_ras.pub root@/xxx</li>\n</ul>\n<p><a name=\"rYekR\"></a></p>\n<h2 id=\"ftp-服务器-vsftpd-介绍与软件包安装\" style=\"position:relative;\"><a href=\"#ftp-%E6%9C%8D%E5%8A%A1%E5%99%A8-vsftpd-%E4%BB%8B%E7%BB%8D%E4%B8%8E%E8%BD%AF%E4%BB%B6%E5%8C%85%E5%AE%89%E8%A3%85\" aria-label=\"ftp 服务器 vsftpd 介绍与软件包安装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FTP 服务器 vsftpd 介绍与软件包安装</h2>\n<p><a name=\"oVW3t\"></a></p>\n<h3 id=\"ftp-协议分为两条连接不同的信息要用不同连接传输\" style=\"position:relative;\"><a href=\"#ftp-%E5%8D%8F%E8%AE%AE%E5%88%86%E4%B8%BA%E4%B8%A4%E6%9D%A1%E8%BF%9E%E6%8E%A5%E4%B8%8D%E5%90%8C%E7%9A%84%E4%BF%A1%E6%81%AF%E8%A6%81%E7%94%A8%E4%B8%8D%E5%90%8C%E8%BF%9E%E6%8E%A5%E4%BC%A0%E8%BE%93\" aria-label=\"ftp 协议分为两条连接不同的信息要用不同连接传输 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FTP 协议分为两条连接,不同的信息要用不同连接传输</h3>\n<ul>\n<li>命令链路</li>\n<li>数据链路</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 安装</span>\nyum <span class=\"token function\">install</span> vsftpd <span class=\"token function\">ftp</span>\n\n<span class=\"token comment\"># 启动</span>\nsystemctl start vsftpd.service\n\n<span class=\"token comment\"># 开机自启动</span>\nsystemctl <span class=\"token builtin class-name\">enable</span> vsftpd.service\n\n<span class=\"token comment\"># 访问，使用ftp账户，则是匿名模式，默认的目录是宿主机的/var/ftp目录。也可以用系统用户，目录则是用户根目录</span>\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ftp localhost</span>\nTrying ::1<span class=\"token punctuation\">..</span>.\nConnected to localhost <span class=\"token punctuation\">(</span>::1<span class=\"token punctuation\">)</span>.\n<span class=\"token number\">220</span> <span class=\"token punctuation\">(</span>vsFTPd <span class=\"token number\">3.0</span>.2<span class=\"token punctuation\">)</span>\nName <span class=\"token punctuation\">(</span>localhost:root<span class=\"token punctuation\">)</span>: <span class=\"token function\">ftp</span>\n<span class=\"token number\">331</span> Please specify the password.\nPassword:\n<span class=\"token number\">230</span> Login successful.\nRemote system <span class=\"token builtin class-name\">type</span> is UNIX.\nUsing binary mode to transfer files.\nftp<span class=\"token operator\">></span> <span class=\"token function\">ls</span>\n<span class=\"token number\">229</span> Entering Extended Passive Mode <span class=\"token punctuation\">(</span><span class=\"token operator\">||</span><span class=\"token operator\">|</span><span class=\"token number\">31008</span><span class=\"token operator\">|</span><span class=\"token punctuation\">)</span>.\n<span class=\"token number\">150</span> Here comes the directory listing.\ndrwxr-xr-x    <span class=\"token number\">2</span> <span class=\"token number\">0</span>        <span class=\"token number\">0</span>            <span class=\"token number\">4096</span> Apr 01  <span class=\"token number\">2020</span> pub\n<span class=\"token number\">226</span> Directory send OK.\n\n<span class=\"token comment\"># 要开启ftp服务让别的主机访问，需要开放端口，最简单的用firewall-cmd --add-service ftp</span>\n\n<span class=\"token comment\"># 下载和上传</span>\n➜ <span class=\"token function\">ftp</span> <span class=\"token number\">139.155</span>.182.202\nConnected to <span class=\"token number\">139.155</span>.182.202.\n<span class=\"token number\">220</span> <span class=\"token punctuation\">(</span>vsFTPd <span class=\"token number\">3.0</span>.2<span class=\"token punctuation\">)</span>\nName <span class=\"token punctuation\">(</span><span class=\"token number\">139.155</span>.182.202:qq<span class=\"token punctuation\">)</span>: xx\n<span class=\"token number\">331</span> Please specify the password.\nPassword:\n<span class=\"token number\">230</span> Login successful.\nftp<span class=\"token operator\">></span> <span class=\"token operator\">!</span>ls <span class=\"token comment\"># ！可以执行本机命令</span>\na.txt        get_product.py    ipv4        main.go        utils\naa.txt        go.mod        ipv6        result.txt    writefile.py\nbfile        go.sum        knowledge.py    <span class=\"token builtin class-name\">test</span>\nftp<span class=\"token operator\">></span> put a.txt <span class=\"token comment\"># 上传文件，既在远程主机上写入文件</span>\n<span class=\"token number\">200</span> PORT <span class=\"token builtin class-name\">command</span> successful. Consider using PASV.\n<span class=\"token number\">150</span> Ok to send data.\n<span class=\"token number\">226</span> Transfer complete.\n<span class=\"token number\">7500000</span> bytes sent <span class=\"token keyword\">in</span> <span class=\"token number\">0.926</span> seconds <span class=\"token punctuation\">(</span><span class=\"token number\">7.72</span> Mbytes/s<span class=\"token punctuation\">)</span>\nftp<span class=\"token operator\">></span> <span class=\"token function\">ls</span>\n<span class=\"token number\">200</span> PORT <span class=\"token builtin class-name\">command</span> successful. Consider using PASV.\n<span class=\"token number\">150</span> Here comes the directory listing.\n-rw-r--r--    <span class=\"token number\">1</span> <span class=\"token number\">1000</span>     <span class=\"token number\">1000</span>      <span class=\"token number\">7500000</span> Nov 02 <span class=\"token number\">14</span>:21 a.txt\ndrwxrwxr-x    <span class=\"token number\">2</span> <span class=\"token number\">1000</span>     <span class=\"token number\">1000</span>         <span class=\"token number\">4096</span> Nov 02 <span class=\"token number\">14</span>:19 <span class=\"token builtin class-name\">test</span>\n<span class=\"token number\">226</span> Directory send OK.\nftp<span class=\"token operator\">></span> get aaaa.txt <span class=\"token comment\"># 下载文件，既在本地主机上写入文件</span>\n<span class=\"token number\">200</span> PORT <span class=\"token builtin class-name\">command</span> successful. Consider using PASV.\n<span class=\"token number\">150</span> Opening BINARY mode data connection <span class=\"token keyword\">for</span> aaaa.txt <span class=\"token punctuation\">(</span><span class=\"token number\">7</span> bytes<span class=\"token punctuation\">)</span>.\nWARNING<span class=\"token operator\">!</span> <span class=\"token number\">2</span> bare linefeeds received <span class=\"token keyword\">in</span> ASCII mode\nFile may not have transferred correctly.\n<span class=\"token number\">226</span> Transfer complete.\n<span class=\"token number\">7</span> bytes received <span class=\"token keyword\">in</span> <span class=\"token number\">0.000211</span> seconds <span class=\"token punctuation\">(</span><span class=\"token number\">32.4</span> kbytes/s<span class=\"token punctuation\">)</span></code></pre></div>\n<p><a name=\"51nHl\"></a></p>\n<h2 id=\"samba-和-nfs-服务\" style=\"position:relative;\"><a href=\"#samba-%E5%92%8C-nfs-%E6%9C%8D%E5%8A%A1\" aria-label=\"samba 和 nfs 服务 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Samba 和 NFS 服务</h2>\n<ul>\n<li>samba 服务主要针对于 windows 和 windows 系统</li>\n<li>NFS 主要针对的的是 linux 和 linux 系统</li>\n</ul>\n<p><a name=\"HcTgt\"></a></p>\n<h2 id=\"nginx-基本配置文件\" style=\"position:relative;\"><a href=\"#nginx-%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\" aria-label=\"nginx 基本配置文件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nginx 基本配置文件</h2>\n<p>OpenResty® 是一个基于 Nginx 与 Lua 的高性能 Web 平台，其内部集成了大量精良的 Lua 库、第三方模块以及大多数的依赖项。用于方便地搭建能够处理超高并发、扩展性极高的动态 Web 应用、Web 服务和动态网关。<br />\n<br />OpenResty® 通过汇聚各种设计精良的 Nginx 模块（主要由 OpenResty 团队自主开发），从而将 Nginx 有效地变成一个强大的通用 Web 应用平台。这样，Web 开发人员和系统工程师可以使用 Lua 脚本语言调动 Nginx 支持的各种 C 以及 Lua 模块，快速构造出足以胜任 10K 乃至 1000K 以上单机并发连接的高性能 Web 应用系统。<br />\n<br />OpenResty® 的目标是让你的 Web 服务直接跑在 Nginx 服务内部，充分利用 Nginx 的非阻塞 I/O 模型，不仅仅对 HTTP 客户端请求，甚至于对远程后端诸如 MySQL、PostgreSQL、Memcached 以及 Redis 等都进行一致的高性能响应。来自 OpenResty® 官网</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 下载</span>\nyum-config-manager --add-repo https://openresty.org/package/centos/openresty.repo\nyum <span class=\"token function\">install</span> openresty\n\n<span class=\"token comment\"># 配置文件</span>\n/usr/local/openresty/nginx/conf/nginx.conf\n\n<span class=\"token comment\"># 启动</span>\n<span class=\"token function\">service</span> openresty start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>restart<span class=\"token operator\">|</span>reload</code></pre></div>\n<br />\n<br />\n<br />"},{"id":"8abb392c-098f-58f8-91a3-fabbbcd63587","headings":[{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":1},{"depth":1},{"depth":1},{"depth":1},{"depth":1},{"depth":1},{"depth":2},{"depth":3},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":2}],"frontmatter":{"title":"Linux-系统管理","path":"/linux-system","tags":["Linux"],"excerpt":"linux-系统管理，个人记录学习","created":"2021-04-11T00:00:00.000Z","createdPretty":"11 April, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"11 April, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAC4jAAAuIwF4pT92AAADFUlEQVQozw3P+1PaBgDA8fwFe+jt1nXT2RZLqCFIgBDAYGISSJCSlfAU5SEkIYlRsNWok+IL8BzetXVKtytt9badXW9ddz2u2/q63bXbur9q3n1++P76Bfog4mOY6htlzvTbA332wIfwxEejdB/CnHU/EvwEYc456AE0MOwNQjhnJ8P2iasIOemhQsDloDwaX4ITK7bEsiOz5iltEdqeT254pZ2A1ohVm3mjpa+3jI3m4tdbulGXlzbk5a2lerO+3QKixvfJm8eZnR+nm4+Ug2fG/T8Lez+s//RX85e/Hz5//+TVP6/f/ff67fsXb//tvXnXfdy71T1t3ulutjsb7SOAk3ZCWlswOrndU+3bnnr0DEmqeqe32H25eu/59vHvt09f3H388sGTVz/33jx6+sfd7unuN0eNxv5uqw3Ykzc9uRZb7cRr9zOb3dzmdz5BTOrr+bV2sX4wv31rbe+wcXhycPLb4fHTozMPf20fnrTandbuHcBGp8YjKZaP0eFY5FqMZWgX5g9NhkRFNowbRUUrSOKsKBdFTV3eqdb2F2v7CysNSV/JiQsAbB1xWEG/1x3l+bgQpVguVSjFpzPpklRdXV2u1dTrlbk5uTCdmskX8yVNU+bzxfkwn5oMC4BpaNDudLN8PC7wMwk+lUnPaTNlvZRVlNINo7rVrK7X5AVVViRJkbPZ9BRHFL/igjSDecYAGHEHSW/6KiVFJ8QomcvGC4p6vV6vNbfLulZeqGiVSnm+mpUUVVcVXRf4CI0hYzbLmB0CCNvlAHwphJjKHCpHMCZEC8lYfCqTEsuFsqpWqmopm8atIf7arDhblKSIkCAZ1oFiFhAE3ODnlG2Itl9kHRdDmNnv93E0QTAcFYmGp7LFOT2TFK6c/wA2DaIoivvHWJajGG6cHHdjLsAJfoZBX8JD5yDzhSsO1E3SJO7DcNyK+ryBSCAxTTPMpS8+dZoHLKZhMzSKYR78bJegHagLAIcHTef7LwwNgE4PjGIERTphaGDYArpwbJxGyYCPoBAXGiRxjglCDs+IDYJGzBYQtiLY/+vJF7ga68kZAAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/2faf45e003e62c2c140c31ffb6a359e0/0853f/header.png","srcSet":"/static/2faf45e003e62c2c140c31ffb6a359e0/14156/header.png 125w,\n/static/2faf45e003e62c2c140c31ffb6a359e0/d6e47/header.png 250w,\n/static/2faf45e003e62c2c140c31ffb6a359e0/0853f/header.png 500w,\n/static/2faf45e003e62c2c140c31ffb6a359e0/ce627/header.png 750w,\n/static/2faf45e003e62c2c140c31ffb6a359e0/9dbcf/header.png 1000w,\n/static/2faf45e003e62c2c140c31ffb6a359e0/87046/header.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<p><a name=\"mHmmL\"></a></p>\n<h2 id=\"用户管理\" style=\"position:relative;\"><a href=\"#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86\" aria-label=\"用户管理 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>用户管理</h2>\n<p><a name=\"A0IK0\"></a></p>\n<h3 id=\"添加用户（需要在-root-用户下执行，其他普通用户无法创建用户）\" style=\"position:relative;\"><a href=\"#%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%EF%BC%88%E9%9C%80%E8%A6%81%E5%9C%A8-root-%E7%94%A8%E6%88%B7%E4%B8%8B%E6%89%A7%E8%A1%8C%EF%BC%8C%E5%85%B6%E4%BB%96%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E6%97%A0%E6%B3%95%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%EF%BC%89\" aria-label=\"添加用户（需要在 root 用户下执行，其他普通用户无法创建用户） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>添加用户（需要在 root 用户下执行，其他普通用户无法创建用户）</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 不会创建用户目录、设定密码等</span>\n<span class=\"token function\">useradd</span> abc\n\n<span class=\"token comment\"># 会创建用户目录、设定密码等</span>\nadduser abc</code></pre></div>\n<p><a name=\"3ybAj\"></a></p>\n<h3 id=\"设置密码\" style=\"position:relative;\"><a href=\"#%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81\" aria-label=\"设置密码 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>设置密码</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">passwd</span> abc</code></pre></div>\n<p><a name=\"DC9NT\"></a></p>\n<h3 id=\"查看某一个用户是否存在\" style=\"position:relative;\"><a href=\"#%E6%9F%A5%E7%9C%8B%E6%9F%90%E4%B8%80%E4%B8%AA%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8\" aria-label=\"查看某一个用户是否存在 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>查看某一个用户是否存在</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">id</span> abc\n<span class=\"token comment\"># uid=0(root) gid=0(root) groups=0(root),113(docker)</span></code></pre></div>\n<p><a name=\"Zi2c2\"></a></p>\n<h3 id=\"添加用户会经过那些操作\" style=\"position:relative;\"><a href=\"#%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E4%BC%9A%E7%BB%8F%E8%BF%87%E9%82%A3%E4%BA%9B%E6%93%8D%E4%BD%9C\" aria-label=\"添加用户会经过那些操作 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>添加用户会经过那些操作</h3>\n<ul>\n<li>会在 /etc/passwd 中添加用户</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">cat</span> /etc/passwd\n<span class=\"token comment\"># abc:x:1002:1002::/home/abc:/bin/sh</span></code></pre></div>\n<ul>\n<li>会在 /etc/shadow 中添加用户</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">cat</span> /etc/shadow\n<span class=\"token comment\"># abc:!:18510:0:99999:7:::</span></code></pre></div>\n<p><a name=\"13yTz\"></a></p>\n<h3 id=\"删除用户\" style=\"position:relative;\"><a href=\"#%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7\" aria-label=\"删除用户 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>删除用户</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 不会删除用户目录</span>\n<span class=\"token function\">userdel</span> abc\n\n<span class=\"token comment\"># 删除用户目录</span>\n<span class=\"token function\">userdel</span> -r abc</code></pre></div>\n<p><a name=\"BBlpa\"></a></p>\n<h3 id=\"修改用户属性\" style=\"position:relative;\"><a href=\"#%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E5%B1%9E%E6%80%A7\" aria-label=\"修改用户属性 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>修改用户属性</h3>\n<ul>\n<li>修改用户目录</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">usermod</span> -d /home/dd abc</code></pre></div>\n<ul>\n<li>修改用户所属的组</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">usermod</span> -g group1 abc</code></pre></div>\n<p><a name=\"Z0xtq\"></a></p>\n<h3 id=\"新建用户组\" style=\"position:relative;\"><a href=\"#%E6%96%B0%E5%BB%BA%E7%94%A8%E6%88%B7%E7%BB%84\" aria-label=\"新建用户组 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>新建用户组</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">groupadd</span> group1</code></pre></div>\n<p><a name=\"3tSb1\"></a></p>\n<h3 id=\"切换用户\" style=\"position:relative;\"><a href=\"#%E5%88%87%E6%8D%A2%E7%94%A8%E6%88%B7\" aria-label=\"切换用户 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>切换用户</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># - 表示完全切换，会切换到该用户的目录下，如果没有 - 则还会在当前目录</span>\n<span class=\"token function\">su</span> - abc</code></pre></div>\n<p><a name=\"C7SlJ\"></a></p>\n<h3 id=\"给特定用户执行某些命令的权限\" style=\"position:relative;\"><a href=\"#%E7%BB%99%E7%89%B9%E5%AE%9A%E7%94%A8%E6%88%B7%E6%89%A7%E8%A1%8C%E6%9F%90%E4%BA%9B%E5%91%BD%E4%BB%A4%E7%9A%84%E6%9D%83%E9%99%90\" aria-label=\"给特定用户执行某些命令的权限 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>给特定用户执行某些命令的权限</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">visudo\n<span class=\"token comment\"># 用上面的命令可以给某些用户赋予某些命令的权限</span></code></pre></div>\n<p><a name=\"hg4uE\"></a></p>\n<h3 id=\"etcpasswd-文件解析\" style=\"position:relative;\"><a href=\"#etcpasswd-%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90\" aria-label=\"etcpasswd 文件解析 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>/etc/passwd 文件解析</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\n\n<span class=\"token comment\"># 用户名/用户是否需要密码进行验证/uid/gid/注释/用户目录/命令解释器</span>\n<span class=\"token comment\"># sbin/nologin 是不能被登录的</span></code></pre></div>\n<blockquote>\n<p>在新建用户时可以不用 adduser 命令，直接编辑该文件也可以起到新增用户的目的</p>\n</blockquote>\n<p><a name=\"hMaFO\"></a></p>\n<h3 id=\"etcshadow-文件解析（用来保存用户和密码的关系）\" style=\"position:relative;\"><a href=\"#etcshadow-%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%EF%BC%88%E7%94%A8%E6%9D%A5%E4%BF%9D%E5%AD%98%E7%94%A8%E6%88%B7%E5%92%8C%E5%AF%86%E7%A0%81%E7%9A%84%E5%85%B3%E7%B3%BB%EF%BC%89\" aria-label=\"etcshadow 文件解析（用来保存用户和密码的关系） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>/etc/shadow 文件解析（用来保存用户和密码的关系）</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">mysql:<span class=\"token operator\">!</span>:18493424:0:99999:7:::\nuser1:<span class=\"token variable\">$6</span><span class=\"token variable\">$9JTohwDk</span><span class=\"token variable\">$baTsdfsVJRRfSds6PCdF0xBQlqslTekjWK9xT7</span>/yIoTTUv45raWwtZRpwtMn5mNwjULCvL2XRJ9Nj3kFhekJBsjgBfq.:18511:0:99999:7:::\n\n<span class=\"token comment\"># 用户名/加密后的密码</span>\n\n<span class=\"token comment\"># 相同的密码加密后是不同的</span></code></pre></div>\n<p><a name=\"gId4y\"></a></p>\n<h3 id=\"etcgroup-文件解析（用户组文件）\" style=\"position:relative;\"><a href=\"#etcgroup-%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%EF%BC%88%E7%94%A8%E6%88%B7%E7%BB%84%E6%96%87%E4%BB%B6%EF%BC%89\" aria-label=\"etcgroup 文件解析（用户组文件） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>/etc/group 文件解析（用户组文件）</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">mysql:x:116:\nuser1:x:1002:\n\n<span class=\"token comment\"># 用户组名称/是否需要密码/gid/其他组设置(一个用户可以属于多个组)</span></code></pre></div>\n<hr>\n<p><a name=\"sHutP\"></a></p>\n<h2 id=\"文件权限\" style=\"position:relative;\"><a href=\"#%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90\" aria-label=\"文件权限 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>文件权限</h2>\n<p><a name=\"Q67WC\"></a></p>\n<h3 id=\"文件权限格式\" style=\"position:relative;\"><a href=\"#%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E6%A0%BC%E5%BC%8F\" aria-label=\"文件权限格式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>文件权限格式</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">ls</span> -l\n\n-rwx------+   <span class=\"token number\">8</span> xx  staff      <span class=\"token number\">256</span> Mar  <span class=\"token number\">6</span>  <span class=\"token number\">2020</span> Movies\ndrwx------+  <span class=\"token number\">10</span> xx  staff      <span class=\"token number\">320</span> Mar  <span class=\"token number\">6</span>  <span class=\"token number\">2020</span> Music\n\n<span class=\"token comment\"># 第一位，表示文件类型</span>\n<span class=\"token comment\"># 后面接着的9位 rwx------ 表示权限，每三个字符为一组，分别表示用户对该文件的权限、该组对文件的权限和其他用户的权限</span>\n<span class=\"token comment\"># xx 用户</span>\n<span class=\"token comment\"># staff 用户组</span></code></pre></div>\n<p><a name=\"GLJ84\"></a></p>\n<h3 id=\"文件类型\" style=\"position:relative;\"><a href=\"#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B\" aria-label=\"文件类型 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>文件类型</h3>\n<p>-普通文件<br />d目录文件<br />b块特殊文件<br />c字符特殊文件<br />l符号链接<br />f命令管道<br />s套接字文件<br /></p>\n<p><a name=\"tMZqh\"></a></p>\n<h3 id=\"文件权限的表示方法\" style=\"position:relative;\"><a href=\"#%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E7%9A%84%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95\" aria-label=\"文件权限的表示方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>文件权限的表示方法</h3>\n<p>数字权限的表示方法</p>\n<ul>\n<li>r=4</li>\n<li>w=2</li>\n<li>x=1</li>\n</ul>\n<p><a name=\"YVMtM\"></a></p>\n<h3 id=\"目录权限的表示方法\" style=\"position:relative;\"><a href=\"#%E7%9B%AE%E5%BD%95%E6%9D%83%E9%99%90%E7%9A%84%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95\" aria-label=\"目录权限的表示方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>目录权限的表示方法</h3>\n<p>x可以进入目录<br />rx显示目录内的文件名<br />wx修改目录内的文件名<br /></p>\n<p><a name=\"qqZkU\"></a></p>\n<h3 id=\"修改文件属主和属组的方法\" style=\"position:relative;\"><a href=\"#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%B1%9E%E4%B8%BB%E5%92%8C%E5%B1%9E%E7%BB%84%E7%9A%84%E6%96%B9%E6%B3%95\" aria-label=\"修改文件属主和属组的方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>修改文件属主和属组的方法</h3>\n<ul>\n<li>修改属主</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">chown</span> user1 /test</code></pre></div>\n<ul>\n<li>修改属组</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">chgrp</span> :user1 /test</code></pre></div>\n<p><a name=\"6WnKe\"></a></p>\n<h3 id=\"修改权限\" style=\"position:relative;\"><a href=\"#%E4%BF%AE%E6%94%B9%E6%9D%83%E9%99%90\" aria-label=\"修改权限 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>修改权限</h3>\n<p>u属主<br />g属组<br />o其他用户<br />a包括上述三种<br />+增加权限<br />-减少权限<br />=设置权限</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 为test的属主设置w权限</span>\n<span class=\"token function\">chmod</span> u+w ./test\n\n<span class=\"token comment\"># 为属主、属组合其他用户设置只有wr权限</span>\n<span class=\"token function\">chmod</span> <span class=\"token assign-left variable\">a</span><span class=\"token operator\">=</span>wr ./test</code></pre></div>\n<blockquote>\n<p>linux 中默认的文件权限是 644, 是 666-umask (022)=644，既 rw-r--r--</p>\n</blockquote>\n<blockquote>\n<p>如果属主权限和属组权限冲突，则以属主权限为主</p>\n</blockquote>\n<hr>\n<p><a name=\"YcwFi\"></a></p>\n<h2 id=\"特殊权限\" style=\"position:relative;\"><a href=\"#%E7%89%B9%E6%AE%8A%E6%9D%83%E9%99%90\" aria-label=\"特殊权限 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>特殊权限</h2>\n<p>SUID用户可执行的二进制文件，执行命令时获取文件属主的权限</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@master:~<span class=\"token comment\"># ls -l /usr/bin/passwd</span>\n-rwsr-xr-x <span class=\"token number\">1</span> root root <span class=\"token number\">59640</span> Mar <span class=\"token number\">23</span>  <span class=\"token number\">2019</span> /usr/bin/passwd</code></pre></div>\n<p>SGID用于目录，在该目录下新建的文件和目录，权限自动更改为该目录的属组，常用于共享文件<br />SBIT用户目录，在该目录下新建的文件和目录，只有 root 和自己可以删除</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">ls</span> -l /\ndrwxrwxrwt  <span class=\"token number\">13</span> root root       <span class=\"token number\">4096</span> Sep  <span class=\"token number\">7</span> <span class=\"token number\">18</span>:21 tmp</code></pre></div>\n<hr>\n<p><a name=\"mUdVW\"></a></p>\n<h2 id=\"网络管理\" style=\"position:relative;\"><a href=\"#%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86\" aria-label=\"网络管理 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>网络管理</h2>\n<p><a name=\"PH00x\"></a></p>\n<h3 id=\"网络状态查看工具\" style=\"position:relative;\"><a href=\"#%E7%BD%91%E7%BB%9C%E7%8A%B6%E6%80%81%E6%9F%A5%E7%9C%8B%E5%B7%A5%E5%85%B7\" aria-label=\"网络状态查看工具 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>网络状态查看工具</h3>\n<ul>\n<li>\n<p>net-tools (centos 7 之前推荐的工具)</p>\n<ul>\n<li>ifconfig-eth0 第一块网卡（根据网卡接入方式不同，名称也会不同）</li>\n<li>route</li>\n<li>netstat</li>\n</ul>\n</li>\n<li>\n<p>iproute2 (centos 7 之后推荐的工具)</p>\n<ul>\n<li>ip</li>\n<li>ss\n<a name=\"IeLiC\"></a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"修改网卡名称为-eth0\" style=\"position:relative;\"><a href=\"#%E4%BF%AE%E6%94%B9%E7%BD%91%E5%8D%A1%E5%90%8D%E7%A7%B0%E4%B8%BA-eth0\" aria-label=\"修改网卡名称为 eth0 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>修改网卡名称为 eth0</h3>\n<p>网卡命名规则受 biosdevname 和 net.ifnames 两个参数影响</p>\n<ol>\n<li>编辑 etc/default/grub 文件，增加 biosdevname=0 和 net.ifnames=0</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token assign-left variable\">GRUB_CMDLINE_LINUX</span><span class=\"token operator\">=</span><span class=\"token string\">\"net.ifnames=0 biosdevname=0\"</span></code></pre></div>\n<ol start=\"2\">\n<li>更新 grub</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">grub2-mkconfig -o /boot/grub2/grub.cfg</code></pre></div>\n<ol start=\"3\">\n<li>重启 (reboot)</li>\n</ol>\n<p><a name=\"eOhvM\"></a></p>\n<h3 id=\"查看网卡物理连接情况\" style=\"position:relative;\"><a href=\"#%E6%9F%A5%E7%9C%8B%E7%BD%91%E5%8D%A1%E7%89%A9%E7%90%86%E8%BF%9E%E6%8E%A5%E6%83%85%E5%86%B5\" aria-label=\"查看网卡物理连接情况 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>查看网卡物理连接情况</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">mii-tool eth0</code></pre></div>\n<p><a name=\"Iw9CY\"></a></p>\n<h3 id=\"查看网关\" style=\"position:relative;\"><a href=\"#%E6%9F%A5%E7%9C%8B%E7%BD%91%E5%85%B3\" aria-label=\"查看网关 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>查看网关</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 使用 -n 参数不解析主机名</span>\nroute -n</code></pre></div>\n<p><a name=\"I1qae\"></a></p>\n<h3 id=\"查看网卡\" style=\"position:relative;\"><a href=\"#%E6%9F%A5%E7%9C%8B%E7%BD%91%E5%8D%A1\" aria-label=\"查看网卡 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>查看网卡</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">ifconfig</span></code></pre></div>\n<p><a name=\"c8FIO\"></a></p>\n<h3 id=\"网络故障排除命令\" style=\"position:relative;\"><a href=\"#%E7%BD%91%E7%BB%9C%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4%E5%91%BD%E4%BB%A4\" aria-label=\"网络故障排除命令 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>网络故障排除命令</h3>\n<p>ping网络主机是否畅通，ping 目标主机的域名或者 ip<br />traceroute如果网络通畅，但是还是访问不通，可以通过该命令查看路由信息，跟踪当前主机到目标主机的网络状态</p>\n<ul>\n<li>traceroute -w 1 目标主机 // -w 等待超时的时间</li>\n<li>更详细、更丰富的的 traceroute 命令-> mtr 命令（推荐）</li>\n</ul>\n<p>mtr如果网络主机通畅，但是还是访问不通，可以查看是否有数据包丢失了<br />nslookup查看域名对应的 ip<br />telnet如果主机没有问题，可以查看端口是否开放(明文传输，已被 ssh 替代)</p>\n<ul>\n<li>telnet [主机][端口]</li>\n</ul>\n<p>nc:</p>\n<ul>\n<li>监听服务器端口 - 有客户端连接后，从客户端发送的数据将在终端显示。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">nc <span class=\"token operator\">-</span>l <span class=\"token punctuation\">[</span>端口<span class=\"token punctuation\">]</span>\n如\nnc <span class=\"token operator\">-</span>l <span class=\"token number\">8800</span>\n功能在本机上开启一个<span class=\"token constant\">TCP</span>服务器端口<span class=\"token number\">8800</span></code></pre></div>\n<ul>\n<li>端口扫描</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">nc <span class=\"token operator\">-</span>nvz <span class=\"token punctuation\">[</span>服务器地址<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>端口区间<span class=\"token punctuation\">]</span>\n如\nnc <span class=\"token operator\">-</span>nvz <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span> <span class=\"token number\">500</span><span class=\"token operator\">-</span><span class=\"token number\">505</span>\n功能扫描地址<span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span>上的<span class=\"token number\">500</span><span class=\"token operator\">-</span><span class=\"token number\">505</span>端口</code></pre></div>\n<ul>\n<li>连接服务器端口 - 连接成功后，可以发送数据到服务端，也可接收来自服务端的数据。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">nc <span class=\"token punctuation\">[</span>服务器地址<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>端口<span class=\"token punctuation\">]</span>\n如\nnc <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span> <span class=\"token number\">502</span>\n功能连接到<span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span><span class=\"token function\">上的502端口</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TCP</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>发送文件 发送成功后会退出 nc。-</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">nc <span class=\"token punctuation\">[</span>服务器地址<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>端口<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token punctuation\">[</span>文件名<span class=\"token punctuation\">]</span>\n如\nnc <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span> <span class=\"token number\">502</span> <span class=\"token operator\">&lt;</span> test\n功能向<span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span><span class=\"token function\">上的502端口</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TCP</span><span class=\"token punctuation\">)</span>发送test文件</code></pre></div>\n<p>tcpdump如果主机和端口都 ok，则需要抓包进行分析，tcpdump -i any -n port 80</p>\n<ul>\n<li>-i 包的类型 tcp/udp</li>\n<li>-n 如果是域名则解析成 ip</li>\n<li>port 80 本机的 80 端口的包</li>\n<li>host 10.0.0.1 本机到 10.0.0.1 的包</li>\n<li>组合port 80 and host 10.0.0.1</li>\n<li>-w [文件名]捕获下来并保存到某个文件</li>\n</ul>\n<p>netstat 和 ss检测服务监听的地址是否正确，查看本机对外服务的端口</p>\n<ul>\n<li>\n<p>netstat -ntpl</p>\n<ul>\n<li>-p 打印出进程</li>\n<li>-t 显示 tcp 协议</li>\n<li>-l 状态是正在监听</li>\n<li>-n 显示 ip 地址，不要显示域名</li>\n</ul>\n</li>\n<li>ss -ntpl\n<a name=\"YMpXF\"></a></li>\n</ul>\n<p>lsof 显示相应端口的进程</p>\n<ul>\n<li>lsof -i :1080</li>\n</ul>\n<h3 id=\"网络服务管理-centos\" style=\"position:relative;\"><a href=\"#%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86-centos\" aria-label=\"网络服务管理 centos permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>网络服务管理 (centos)</h3>\n<ul>\n<li>可以分为两种SysV 和 systemd</li>\n<li>网络配置文件ifcfg-eth0，会随着网卡的不同文件名也会不同</li>\n<li>比如 /etc/sysconfig/network-scripts/ifcfg-ens3，在这个里面可以配置 dhcp，ip 等信息</li>\n</ul>\n<hr>\n<p><a name=\"2VGNz\"></a></p>\n<h2 id=\"进程管理\" style=\"position:relative;\"><a href=\"#%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86\" aria-label=\"进程管理 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>进程管理</h2>\n<p><a name=\"QCo2v\"></a></p>\n<h3 id=\"调整优先级\" style=\"position:relative;\"><a href=\"#%E8%B0%83%E6%95%B4%E4%BC%98%E5%85%88%E7%BA%A7\" aria-label=\"调整优先级 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>调整优先级</h3>\n<p>nice范围从 - 20 到 19，值越小优先级越高，抢占的资源就越多<br />renice重新设置优先级</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 在启动前设置某一个程序的优先级</span>\n<span class=\"token function\">nice</span> -n <span class=\"token number\">10</span> ./a.sh\n\n<span class=\"token comment\"># 在程序启动后重新设置一个程序的优先级</span>\n<span class=\"token function\">renice</span> -n <span class=\"token number\">15</span> pid</code></pre></div>\n<p><a name=\"LiHs2\"></a></p>\n<h3 id=\"进程的作业控制\" style=\"position:relative;\"><a href=\"#%E8%BF%9B%E7%A8%8B%E7%9A%84%E4%BD%9C%E4%B8%9A%E6%8E%A7%E5%88%B6\" aria-label=\"进程的作业控制 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>进程的作业控制</h3>\n<p>&#x26;将任务放到后台执行</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">./a.bash <span class=\"token operator\">&amp;</span></code></pre></div>\n<p>jobs: 查看后台任务，并获取编号</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">jobs</span></code></pre></div>\n<p>ctrl + z:将前台任务停止并放到后台, 暂停进程<br />fg jobsID:将后台任务放到前台执行<br />bg jobsID:将前台任务放到后台执行<br /></p>\n<p><a name=\"c90jT\"></a></p>\n<h3 id=\"\" style=\"position:relative;\"><a href=\"#\" aria-label=\" permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><a name=\"4O3cn\"></a></p>\n<h3 id=\"进程间通信\" style=\"position:relative;\"><a href=\"#%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1\" aria-label=\"进程间通信 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>进程间通信</h3>\n<ul>\n<li>查看信号</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@848e7f64efd8 /<span class=\"token punctuation\">]</span><span class=\"token comment\"># kill -l</span>\n <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> SIGHUP     <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> SIGINT     <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> SIGQUIT     <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> SIGILL     <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> SIGTRAP\n <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> SIGABRT     <span class=\"token number\">7</span><span class=\"token punctuation\">)</span> SIGBUS     <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> SIGFPE     <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> SIGKILL    <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> SIGUSR1\n<span class=\"token number\">11</span><span class=\"token punctuation\">)</span> SIGSEGV    <span class=\"token number\">12</span><span class=\"token punctuation\">)</span> SIGUSR2    <span class=\"token number\">13</span><span class=\"token punctuation\">)</span> SIGPIPE    <span class=\"token number\">14</span><span class=\"token punctuation\">)</span> SIGALRM    <span class=\"token number\">15</span><span class=\"token punctuation\">)</span> SIGTERM\n<span class=\"token number\">16</span><span class=\"token punctuation\">)</span> SIGSTKFLT    <span class=\"token number\">17</span><span class=\"token punctuation\">)</span> SIGCHLD    <span class=\"token number\">18</span><span class=\"token punctuation\">)</span> SIGCONT    <span class=\"token number\">19</span><span class=\"token punctuation\">)</span> SIGSTOP    <span class=\"token number\">20</span><span class=\"token punctuation\">)</span> SIGTSTP\n<span class=\"token number\">21</span><span class=\"token punctuation\">)</span> SIGTTIN    <span class=\"token number\">22</span><span class=\"token punctuation\">)</span> SIGTTOU    <span class=\"token number\">23</span><span class=\"token punctuation\">)</span> SIGURG    <span class=\"token number\">24</span><span class=\"token punctuation\">)</span> SIGXCPU    <span class=\"token number\">25</span><span class=\"token punctuation\">)</span> SIGXFSZ\n<span class=\"token number\">26</span><span class=\"token punctuation\">)</span> SIGVTALRM    <span class=\"token number\">27</span><span class=\"token punctuation\">)</span> SIGPROF    <span class=\"token number\">28</span><span class=\"token punctuation\">)</span> SIGWINCH    <span class=\"token number\">29</span><span class=\"token punctuation\">)</span> SIGIO    <span class=\"token number\">30</span><span class=\"token punctuation\">)</span> SIGPWR\n<span class=\"token number\">31</span><span class=\"token punctuation\">)</span> SIGSYS    <span class=\"token number\">34</span><span class=\"token punctuation\">)</span> SIGRTMIN    <span class=\"token number\">35</span><span class=\"token punctuation\">)</span> SIGRTMIN+1    <span class=\"token number\">36</span><span class=\"token punctuation\">)</span> SIGRTMIN+2    <span class=\"token number\">37</span><span class=\"token punctuation\">)</span> SIGRTMIN+3\n<span class=\"token number\">38</span><span class=\"token punctuation\">)</span> SIGRTMIN+4    <span class=\"token number\">39</span><span class=\"token punctuation\">)</span> SIGRTMIN+5    <span class=\"token number\">40</span><span class=\"token punctuation\">)</span> SIGRTMIN+6    <span class=\"token number\">41</span><span class=\"token punctuation\">)</span> SIGRTMIN+7    <span class=\"token number\">42</span><span class=\"token punctuation\">)</span> SIGRTMIN+8\n<span class=\"token number\">43</span><span class=\"token punctuation\">)</span> SIGRTMIN+9    <span class=\"token number\">44</span><span class=\"token punctuation\">)</span> SIGRTMIN+10    <span class=\"token number\">45</span><span class=\"token punctuation\">)</span> SIGRTMIN+11    <span class=\"token number\">46</span><span class=\"token punctuation\">)</span> SIGRTMIN+12    <span class=\"token number\">47</span><span class=\"token punctuation\">)</span> SIGRTMIN+13\n<span class=\"token number\">48</span><span class=\"token punctuation\">)</span> SIGRTMIN+14    <span class=\"token number\">49</span><span class=\"token punctuation\">)</span> SIGRTMIN+15    <span class=\"token number\">50</span><span class=\"token punctuation\">)</span> SIGRTMAX-14    <span class=\"token number\">51</span><span class=\"token punctuation\">)</span> SIGRTMAX-13    <span class=\"token number\">52</span><span class=\"token punctuation\">)</span> SIGRTMAX-12\n<span class=\"token number\">53</span><span class=\"token punctuation\">)</span> SIGRTMAX-11    <span class=\"token number\">54</span><span class=\"token punctuation\">)</span> SIGRTMAX-10    <span class=\"token number\">55</span><span class=\"token punctuation\">)</span> SIGRTMAX-9    <span class=\"token number\">56</span><span class=\"token punctuation\">)</span> SIGRTMAX-8    <span class=\"token number\">57</span><span class=\"token punctuation\">)</span> SIGRTMAX-7\n<span class=\"token number\">58</span><span class=\"token punctuation\">)</span> SIGRTMAX-6    <span class=\"token number\">59</span><span class=\"token punctuation\">)</span> SIGRTMAX-5    <span class=\"token number\">60</span><span class=\"token punctuation\">)</span> SIGRTMAX-4    <span class=\"token number\">61</span><span class=\"token punctuation\">)</span> SIGRTMAX-3    <span class=\"token number\">62</span><span class=\"token punctuation\">)</span> SIGRTMAX-2</code></pre></div>\n<ul>\n<li>常用信号</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ctrl + <span class=\"token operator\">==</span> SIGINT\n\n<span class=\"token comment\"># 立即终止，不受阻塞，信号是SIGKILL</span>\n<span class=\"token function\">kill</span> -9 pid</code></pre></div>\n<hr>\n<p><a name=\"fsAWV\"></a></p>\n<h2 id=\"守护进程（daemon）\" style=\"position:relative;\"><a href=\"#%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B%EF%BC%88daemon%EF%BC%89\" aria-label=\"守护进程（daemon） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>守护进程（daemon）</h2>\n<p><a name=\"nG4aV\"></a></p>\n<h3 id=\"守护进程和一般进程的区别\" style=\"position:relative;\"><a href=\"#%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B%E5%92%8C%E4%B8%80%E8%88%AC%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%8C%BA%E5%88%AB\" aria-label=\"守护进程和一般进程的区别 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>守护进程和一般进程的区别</h3>\n<ol>\n<li>让程序脱离当前终端执行</li>\n<li>随着系统启动而启动，不用用户手动的去执行</li>\n<li>\n<p>nohup</p>\n<ul>\n<li>nohup 命令会使进程忽略 hangup（挂起）信号</li>\n<li>nohup 可以让一个命令脱离终端执行，但他不是守护进程</li>\n</ul>\n</li>\n<li>\n<p>screen 或者 tmux</p>\n<ul>\n<li>screen可以同时连接多个本地或远程的命令行会话，并在其间自由切换</li>\n<li>screen 进入 screen 环境</li>\n<li>ctrl + a d 退出(detached)screen 环境</li>\n<li>screen -ls 查看 screen 会话</li>\n<li>screen -r sessionid 恢复会话</li>\n</ul>\n</li>\n</ol>\n<br />\n<br />每个进程的依赖的环境都在 /proc/pid 的文件夹中\n```shell\ncd /proc/123\n<h1 id=\"进程执行的位置\" style=\"position:relative;\"><a href=\"#%E8%BF%9B%E7%A8%8B%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BD%8D%E7%BD%AE\" aria-label=\"进程执行的位置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>进程执行的位置</h1>\n<p>ls -l cwd</p>\n<h1 id=\"out\" style=\"position:relative;\"><a href=\"#out\" aria-label=\"out permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>out</h1>\n<p>cwd -> /</p>\n<h1 id=\"进程的输出\" style=\"position:relative;\"><a href=\"#%E8%BF%9B%E7%A8%8B%E7%9A%84%E8%BE%93%E5%87%BA\" aria-label=\"进程的输出 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>进程的输出</h1>\n<p>ls -l fd</p>\n<h1 id=\"out-1\" style=\"position:relative;\"><a href=\"#out-1\" aria-label=\"out 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>out</h1>\n<p>lrwx------ 1 root root 64 Sep 14 05:15 0 -> /dev/pts/4\nlrwx------ 1 root root 64 Sep 14 05:15 1 -> /dev/pts/4\nlrwx------ 1 root root 64 Sep 14 05:15 2 -> /dev/pts/4\nlrwx------ 1 root root 64 Sep 14 12:32 255 -> /dev/pts/4</p>\n<h1 id=\"0-是标准输入\" style=\"position:relative;\"><a href=\"#0-%E6%98%AF%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5\" aria-label=\"0 是标准输入 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0 是标准输入</h1>\n<h1 id=\"12-是标准输出\" style=\"position:relative;\"><a href=\"#12-%E6%98%AF%E6%A0%87%E5%87%86%E8%BE%93%E5%87%BA\" aria-label=\"12 是标准输出 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1,2 是标准输出</h1>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">---\n\n&lt;a name=&quot;tDHr2&quot;&gt;&lt;/a&gt;\n## 服务管理工具 - systemctl\n\n- 常用操作systemctl start|stop|restart|reload|enable|disable 服务名称\n- 软件包安装的服务单元/usr/lib/systemd/system\n   - service -&gt; /etc/init.d\n   - systemctl -&gt; /usr/lib/systemd/system\n   - cd /usr/lib/systemd/system\n   - vim sshd.service --查看服务文件\n   - cd /lib/systemd/system --服务文件目录\n   - ls -l runlevel*.target --查看服务文件映射\n\n---\n\n&lt;a name=&quot;JWOl7&quot;&gt;&lt;/a&gt;\n## SELinux\n安全增强版本的 Linux，以前的 linux 是利用用户和文件的权限来进行安全控制既 DAC（自主访问控制）&lt;br /&gt;\n&lt;br /&gt;MAC（强制访问控制）会给用户、进程和文件都打上标签，如果三者标签不一致则不允许执行&lt;br /&gt;\n&lt;br /&gt;SElinux 是一个内核模块，也是 Linux 的一个安全子系统。SELinux 可是设置 DAC 或者是 MAC。需要注意的是开启 SELinux 会消耗服务器的性能，所以一般在生产环境下都是关闭的\n```shell\n# 查看SELinux状态\ngetenforce</code></pre></div>\n<hr>\n<p><a name=\"Hzpr9\"></a></p>\n<h2 id=\"内存和磁盘管理\" style=\"position:relative;\"><a href=\"#%E5%86%85%E5%AD%98%E5%92%8C%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86\" aria-label=\"内存和磁盘管理 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>内存和磁盘管理</h2>\n<p><a name=\"KoZsx\"></a></p>\n<h3 id=\"内存和磁盘使用率查看\" style=\"position:relative;\"><a href=\"#%E5%86%85%E5%AD%98%E5%92%8C%E7%A3%81%E7%9B%98%E4%BD%BF%E7%94%A8%E7%8E%87%E6%9F%A5%E7%9C%8B\" aria-label=\"内存和磁盘使用率查看 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>内存和磁盘使用率查看</h3>\n<ul>\n<li>内存  free -m/-g/top</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@hadoop3 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># free -m</span>\n              total        used        <span class=\"token function\">free</span>      shared  buff/cache   available\nMem:          <span class=\"token number\">64264</span>       <span class=\"token number\">51686</span>        <span class=\"token number\">2089</span>         <span class=\"token number\">140</span>       <span class=\"token number\">10488</span>       <span class=\"token number\">11807</span>\nSwap:             <span class=\"token number\">0</span>           <span class=\"token number\">0</span>           <span class=\"token number\">0</span>\n<span class=\"token punctuation\">[</span>root@hadoop3 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># free -g</span>\n              total        used        <span class=\"token function\">free</span>      shared  buff/cache   available\nMem:             <span class=\"token number\">62</span>          <span class=\"token number\">50</span>           <span class=\"token number\">2</span>           <span class=\"token number\">0</span>          <span class=\"token number\">10</span>          <span class=\"token number\">11</span>\nSwap:             <span class=\"token number\">0</span>           <span class=\"token number\">0</span>           <span class=\"token number\">0</span></code></pre></div>\n<ul>\n<li>磁盘</li>\n</ul>\n<p>fdisk</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@hadoop3 ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># fdisk -l</span>\n\nDisk /dev/vda: <span class=\"token number\">53.7</span> GB, <span class=\"token number\">53687091200</span> bytes, <span class=\"token number\">104857600</span> sectors\nUnits <span class=\"token operator\">=</span> sectors of <span class=\"token number\">1</span> * <span class=\"token number\">512</span> <span class=\"token operator\">=</span> <span class=\"token number\">512</span> bytes\nSector size <span class=\"token punctuation\">(</span>logical/physical<span class=\"token punctuation\">)</span>: <span class=\"token number\">512</span> bytes / <span class=\"token number\">512</span> bytes\nI/O size <span class=\"token punctuation\">(</span>minimum/optimal<span class=\"token punctuation\">)</span>: <span class=\"token number\">512</span> bytes / <span class=\"token number\">512</span> bytes\nDisk label type: dos\nDisk identifier: 0x0009ac89\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/vda1   *        <span class=\"token number\">2048</span>   <span class=\"token number\">104857566</span>    <span class=\"token number\">52427759</span>+  <span class=\"token number\">83</span>  Linux\n\nDisk /dev/vdb: <span class=\"token number\">214.7</span> GB, <span class=\"token number\">214748364800</span> bytes, <span class=\"token number\">419430400</span> sectors\nUnits <span class=\"token operator\">=</span> sectors of <span class=\"token number\">1</span> * <span class=\"token number\">512</span> <span class=\"token operator\">=</span> <span class=\"token number\">512</span> bytes\nSector size <span class=\"token punctuation\">(</span>logical/physical<span class=\"token punctuation\">)</span>: <span class=\"token number\">512</span> bytes / <span class=\"token number\">512</span> bytes\nI/O size <span class=\"token punctuation\">(</span>minimum/optimal<span class=\"token punctuation\">)</span>: <span class=\"token number\">512</span> bytes / <span class=\"token number\">512</span> bytes</code></pre></div>\n<p>如上图所示，共有两个磁盘/dev/vda、/dev/vdb<br />其中 /dev/vda 是分区了，因为有 /dev/vda1<br />\n<br />df 常常用来查看磁盘是否满了</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">df</span> -h\n\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/vda1        50G   16G   32G  <span class=\"token number\">34</span>% /\ndevtmpfs         32G     <span class=\"token number\">0</span>   32G   <span class=\"token number\">0</span>% /dev\ntmpfs            32G   24K   32G   <span class=\"token number\">1</span>% /dev/shm\ntmpfs            32G  <span class=\"token number\">1</span>.5M   32G   <span class=\"token number\">1</span>% /run\ntmpfs            32G     <span class=\"token number\">0</span>   32G   <span class=\"token number\">0</span>% /sys/fs/cgroup\n/dev/vdb        197G   55G  134G  <span class=\"token number\">29</span>% /data\ntmpfs           <span class=\"token number\">6</span>.3G     <span class=\"token number\">0</span>  <span class=\"token number\">6</span>.3G   <span class=\"token number\">0</span>% /run/user/0</code></pre></div>\n<p>du</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@hadoop3 elasticsearch<span class=\"token punctuation\">]</span><span class=\"token comment\"># du -h docker-compose.yaml</span>\n<span class=\"token number\">4</span>.0K    docker-compose.yaml</code></pre></div>\n<p>du -h 和 ls -lh 区别是，du 是实际占用的空间，而 ls -lh 是包含空洞空间的，其中磁盘有些位置是空的，只是声明了文件存储的位置，并没有实际存储数据<br /></p>\n<hr>\n<p><a name=\"CEe83\"></a></p>\n<h2 id=\"linux-文件系统管理\" style=\"position:relative;\"><a href=\"#linux-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86\" aria-label=\"linux 文件系统管理 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Linux 文件系统管理</h2>\n<p><a name=\"dbpPh\"></a></p>\n<h3 id=\"linux-常见的文件系统\" style=\"position:relative;\"><a href=\"#linux-%E5%B8%B8%E8%A7%81%E7%9A%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F\" aria-label=\"linux 常见的文件系统 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Linux 常见的文件系统</h3>\n<ul>\n<li>ext4</li>\n<li>xfs</li>\n<li>NTFS（需要安全额外的软件）\n<a name=\"y5ziw\"></a></li>\n</ul>\n<h3 id=\"硬链接\" style=\"position:relative;\"><a href=\"#%E7%A1%AC%E9%93%BE%E6%8E%A5\" aria-label=\"硬链接 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>硬链接</h3>\n<ul>\n<li>多个文件其实都是链接到同一个数据块，修改一个文件，其余的文件都会同步变化。</li>\n<li>硬链接是不允许跨文件系统的。</li>\n<li>创建硬链接的方式ln afile bfile</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat base</span>\naaaa\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># ln base yin</span>\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls -li</span>\n<span class=\"token comment\"># inode号是相同的，他们指向同一个inode块</span>\n<span class=\"token number\">131106</span> -rw-r--r-- <span class=\"token number\">2</span> root root <span class=\"token number\">5</span> Nov <span class=\"token number\">25</span> 09:56 base\n<span class=\"token number\">131106</span> -rw-r--r-- <span class=\"token number\">2</span> root root <span class=\"token number\">5</span> Nov <span class=\"token number\">25</span> 09:56 yin\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># rm base</span>\nrm: remove regular <span class=\"token function\">file</span> ‘base’? y\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat yin</span>\naaaa</code></pre></div>\n<p><a name=\"yYaKq\"></a></p>\n<h3 id=\"软链接\" style=\"position:relative;\"><a href=\"#%E8%BD%AF%E9%93%BE%E6%8E%A5\" aria-label=\"软链接 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>软链接</h3>\n<ul>\n<li>克服了硬链接不能跨文件系统的问题。</li>\n<li>但是实现上是不同的，软链接是创建了完全不同的一个文件，当系统读取这个文件时会发现这个文件是个链接文件，所以就会读取它链接的那个原文件</li>\n<li>对软链接文件设置权限并不会改变该文件的权限，而是改变的是原文件。</li>\n<li>创建软链接的方式ln -s afile bfile</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat base</span>\naaaa\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># ln -s base ruan</span>\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls -li</span>\n<span class=\"token comment\"># inode号不同</span>\n<span class=\"token number\">131103</span> -rw-r--r-- <span class=\"token number\">1</span> root root <span class=\"token number\">5</span> Nov <span class=\"token number\">25</span> 09:59 base\n<span class=\"token number\">131104</span> lrwxrwxrwx <span class=\"token number\">1</span> root root <span class=\"token number\">4</span> Nov <span class=\"token number\">25</span> <span class=\"token number\">10</span>:00 ruan -<span class=\"token operator\">></span> base\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat ruan</span>\naaaa\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># rm base</span>\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls -li</span>\ntotal <span class=\"token number\">0</span>\n<span class=\"token number\">131104</span> lrwxrwxrwx <span class=\"token number\">1</span> root root <span class=\"token number\">4</span> Nov <span class=\"token number\">25</span> <span class=\"token number\">10</span>:00 ruan -<span class=\"token operator\">></span> base\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat ruan</span>\n<span class=\"token comment\"># 当删除了原始文件，因为软连接是指向的原始文件，并没有指向inode号，所以访问不到原始文件</span>\ncat: ruan: No such <span class=\"token function\">file</span> or directory\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo dddd >> ruan</span>\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls -li</span>\n<span class=\"token comment\"># 向软连接里写内容，就相当于在原始文件里写内容，所以原始文件就重新出现了</span>\n<span class=\"token number\">131103</span> -rw-r--r-- <span class=\"token number\">1</span> root root <span class=\"token number\">5</span> Nov <span class=\"token number\">25</span> <span class=\"token number\">10</span>:00 base\n<span class=\"token number\">131104</span> lrwxrwxrwx <span class=\"token number\">1</span> root root <span class=\"token number\">4</span> Nov <span class=\"token number\">25</span> <span class=\"token number\">10</span>:00 ruan -<span class=\"token operator\">></span> base\n<span class=\"token punctuation\">[</span>root@VM-0-16-centos test<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat base</span>\ndddd</code></pre></div>\n<hr>\n<p><a name=\"1hXit\"></a></p>\n<h2 id=\"硬盘分区与挂载\" style=\"position:relative;\"><a href=\"#%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA%E4%B8%8E%E6%8C%82%E8%BD%BD\" aria-label=\"硬盘分区与挂载 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>硬盘分区与挂载</h2>\n<ul>\n<li>硬盘分区fdisk /dev/vdb，如果是 2T 以上的硬盘需要用 parted 命令</li>\n<li>格式化设置分区文件系统mkfs.文件系统 /dev/vdb</li>\n<li>分区挂载到目录下mount /dev/vdb /xx</li>\n<li>这样挂载只是将数据写到了内存中，如果想要重启后还是挂载到该目录，需要修改文件 /etc/fstab</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@max-master:~<span class=\"token comment\"># cat /etc/fstab</span>\n<span class=\"token assign-left variable\">UUID</span><span class=\"token operator\">=</span>e1d5f0dc-9df2-421e-a87b-f761f5db8947 / ext4 defaults <span class=\"token number\">0</span> <span class=\"token number\">0</span>\n<span class=\"token comment\">##/swap.img    none    swap    sw    0    0</span>\nmax-master:gfs-configs    /var/cache/zoomeye-max    glusterfs    defaults,_netdev    <span class=\"token number\">0</span>    <span class=\"token number\">0</span>\n/dev/vdb1 /xx ext4 defaults <span class=\"token number\">0</span> <span class=\"token number\">0</span></code></pre></div>\n<hr>\n<p><a name=\"NxCQD\"></a></p>\n<h2 id=\"系统日志\" style=\"position:relative;\"><a href=\"#%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97\" aria-label=\"系统日志 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>系统日志</h2>\n<p>/var/log 查看日志</p>\n<ul>\n<li>tail -f cron -- 查看定时任务</li>\n<li>tail -f messages -- 查看常规信息</li>\n<li>tail -f dmesg --查看内核启动日志</li>\n<li>tail -f secure -- 查看安全相关的日志</li>\n<li>\n<br />\n</li>\n</ul>"},{"id":"ec66dafb-aa73-5329-b72d-bb4ea83d6300","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"k8s持久化存储实现前端oem需求","path":"/oem","tags":["DevOps"],"excerpt":"前端根据licence显示不同的背景图和文字信息.","created":"2021-02-21 15:00","createdPretty":"21 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"21 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJElEQVQozwEZA+b8ALCNXufixuXhx+Xix+XiyePUqeHFiOLSqOTjyuXiyOXhxuXhxuXgxOXgxOXgwuXfweXfweXfweXduuPUqACjfU/j2bXk3sDk4MTk17HgwHzfu3LeuHDk2rbk3sDl38Ll4MTm4sfm4sXm4sXm4sPm4cHn4cDk27fWv48AjGEz1K5q48F74MB93bp21rJu4MB83bhv3Lhu28KN6ObL5Ny64M+h4M+i3caT2r+G2Lp+0rF2z6turYFIAJBlN9OrZcylYtawadGoYcKYWN68d9y2bdOsZL2aY9fEl9y+f9GmXc6jWdGmXcygWMWcV7uOTMGVUruQTwCUZjSzh0u3jlHbtWvMo164jk/euXHft2zTrGW3jE3Tq2PasWbOpFzQplzRqGDKn1nTrWfHnVnEl1TDllMAh1UsgFEsilsyq31EroJIqX5Fs41Vr4hQsohOpnpFsIZMtYtPrIFIsIVLsohNsYRKqXxGsINIsINItIhLAEoiI00jI1IoI1guJVctJVkxJl45LF42KlgvJ10zKVwzKVUtJl82KmM8LmY8K1UsJlkuJF00KVQsJlEqJQBZLSQ+HSI8GSFIISN4UDmddUqxi1mge1ZbNC1DGx9GHB9sRTajf1e1j1qme0lgNys9GSE7GCBRKSWNYj0AdD8lOBsiNRYgUisno3hFu45N2rJnyZ9aYzgtSyEiSyIif1Y8xplTx5pTyp5XcEMwUyUiQRshaT8tm29BAHpJKkMlJTAUIEUjJZ9+WNCsa9u4c8eiZV42LE0jIz4ZIF05MdOxct68etOydG1EM1kpIz0aIVY0LnVQOQCWXi9kPy4oDB5jPC7RsHTjwnzhv3reuXCMZUI/GB9DHSCTcU7p0Zbn0JfnzIyfdkpMICE5FR91TjakekcAXS8kRCAhOhkgWTIom3RFqoJLq4NMimI4WjQoQh4jQRwgf15BwKRvxKdzpINVYT0tQBwgQSAkWTMpgVcyAHVJMJlzSpVwSqF/VKGAVauKWqODV5d5Uph7V5t7Vpd5VJt9VrGRXbKRXp9/VY50VIJnTZF2VpF2V5R5WdJzgcS6sLzOAAAAAElFTkSuQmCC","aspectRatio":1.5625,"src":"/static/67770bd9ce3b813d3f9c5e3fbab1e18f/0853f/bridge.png","srcSet":"/static/67770bd9ce3b813d3f9c5e3fbab1e18f/14156/bridge.png 125w,\n/static/67770bd9ce3b813d3f9c5e3fbab1e18f/d6e47/bridge.png 250w,\n/static/67770bd9ce3b813d3f9c5e3fbab1e18f/0853f/bridge.png 500w,\n/static/67770bd9ce3b813d3f9c5e3fbab1e18f/ce627/bridge.png 750w,\n/static/67770bd9ce3b813d3f9c5e3fbab1e18f/9dbcf/bridge.png 1000w,\n/static/67770bd9ce3b813d3f9c5e3fbab1e18f/87046/bridge.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"技术栈\" style=\"position:relative;\"><a href=\"#%E6%8A%80%E6%9C%AF%E6%A0%88\" aria-label=\"技术栈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>技术栈</h2>\n<ul>\n<li>react，docker，k8s</li>\n</ul>\n<h2 id=\"需求\" style=\"position:relative;\"><a href=\"#%E9%9C%80%E6%B1%82\" aria-label=\"需求 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>需求</h2>\n<ul>\n<li>前端实现界面的 licence 控制，根据 licence 显示不同的背景和文字信息，并且不用重新编译前端镜像，达到可以在宿主机上随时都可以定制的需求</li>\n</ul>\n<h2 id=\"需求分析\" style=\"position:relative;\"><a href=\"#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90\" aria-label=\"需求分析 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>需求分析</h2>\n<ul>\n<li>创建一个 oem 文件夹，存放不同的 licence 的 index.json 和图片，前端通过 ajax 可以直接请求本地的文件（这里是 index.json） k8s 在宿主机上持久化本地存储的方式来进行需求开发再合适不过。）</li>\n</ul>\n<h2 id=\"目前官方支持的-3-种本地存储方案如下：\" style=\"position:relative;\"><a href=\"#%E7%9B%AE%E5%89%8D%E5%AE%98%E6%96%B9%E6%94%AF%E6%8C%81%E7%9A%84-3-%E7%A7%8D%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8%E6%96%B9%E6%A1%88%E5%A6%82%E4%B8%8B%EF%BC%9A\" aria-label=\"目前官方支持的 3 种本地存储方案如下： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>目前官方支持的 3 种本地存储方案如下：</h2>\n<h3 id=\"emptydir\" style=\"position:relative;\"><a href=\"#emptydir\" aria-label=\"emptydir permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>emptyDir</h3>\n<ol>\n<li>pod 在节点上运行时初始化的空卷，pod 中的所有容器都可以访问到该卷。</li>\n<li>pod 从节点上删除时，该卷也会被删除(注意：容器奔溃不会导致 pod 从节点上删除，因此容器奔溃时 emptyDir 是安全的）。</li>\n</ol>\n<p>pod 示例：</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>pod\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>image\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>app\n      <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /cache   // pod中的emptyDir路径\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cache<span class=\"token punctuation\">-</span>volume\n  <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cache<span class=\"token punctuation\">-</span>volume\n      <span class=\"token key atrule\">emptyDir</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"hostpath（适合我的需求）\" style=\"position:relative;\"><a href=\"#hostpath%EF%BC%88%E9%80%82%E5%90%88%E6%88%91%E7%9A%84%E9%9C%80%E6%B1%82%EF%BC%89\" aria-label=\"hostpath（适合我的需求） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>hostPath（适合我的需求）</h3>\n<ol>\n<li>pod 中的文件夹与宿主机上的文件夹相互映射，如果宿主机没有则到 pod 映射，如果 pod 没有则到宿主机映射，如果都没有则默认空文件夹</li>\n<li>宿主机上映射的文件夹的修改会自动同步到 pod 中。</li>\n<li>pod 即使从节点上被删除了（比如：pod 重启），该卷还是会持久化在宿主机上。</li>\n</ol>\n<p>pod 示例：</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>pod\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>image\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>image\n      <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /opt/nginx/oem  // pod路径\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> oem   // 映射宿主机的volume名称\n  <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> oem\n      <span class=\"token key atrule\">hostPath</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> /data/oem    // 宿主机路径</code></pre></div>\n<p>但是还有一点问题，就是 pod 每次重启了，会重新创建 pod 中的 oem 文件夹，这里就是/opt/nginx/oem,那么宿主机上的文件夹/data/oem 也会随着 pod 的重启而替换，所以这需要在 pod 重启的容器中添加一个 command 指令<br /></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>image\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> my<span class=\"token punctuation\">-</span>app<span class=\"token punctuation\">-</span>image\n      <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">[</span>\n          <span class=\"token string\">\"sh\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"-c\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"cp -r -n /opt/assets/public/oem /opt/nginx/ &amp;&amp; nginx -g 'daemon off;'\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span>\n      <span class=\"token key atrule\">volumeMounts</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">mountPath</span><span class=\"token punctuation\">:</span> /opt/nginx/oem\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> oem</code></pre></div>\n<ol>\n<li>/opt/assets/public/oem 是容器中的模版文件夹</li>\n<li><code class=\"language-text\">cp -r -n</code> 如果 pod 中存在/opt/nginx/oem 就不复制（保证每次重启 pod 都是用的宿主机上的 oem 文件夹），也就是初始化 pod 的时候会创建该文件夹</li>\n<li>镜像的 cp 命令升级：\n<code class=\"language-text\">RUN sed -i &#39;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&#39; /etc/apk/repositories \\ &amp;&amp; apk add --no-cache coreutils</code>\n（如果 nginx:1.17-alpine 的版本太老，没办法 cp -n）</li>\n<li>至此，需求完成。</li>\n</ol>\n<h3 id=\"local-persistent-volume\" style=\"position:relative;\"><a href=\"#local-persistent-volume\" aria-label=\"local persistent volume permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Local Persistent Volume</h3>\n<p>指的就是利用机器上的磁盘来存放业务需要持久化的数据，和远端存储类似，此时数据依然独立于 Pod 的生命周期，即使业务 Pod 被删除，数据也不会丢失。</p>\n<h2 id=\"local-persistent-volume-和-hostpath-的区别\" style=\"position:relative;\"><a href=\"#local-persistent-volume-%E5%92%8C-hostpath-%E7%9A%84%E5%8C%BA%E5%88%AB\" aria-label=\"local persistent volume 和 hostpath 的区别 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Local Persistent Volume 和 hostPath 的区别</h2>\n<ol>\n<li>HostPath:调度程序可能会将引用 HostPath 卷的 pod 移至其他节点，从而导致数据丢失。</li>\n<li>Local Persistent: 调度程序可确保始终将使用本地持久卷的容器调度到同一节点。</li>\n</ol>\n<h2 id=\"图形化\" style=\"position:relative;\"><a href=\"#%E5%9B%BE%E5%BD%A2%E5%8C%96\" aria-label=\"图形化 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>图形化</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 638px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a8a1e63f4096f24083f3fc17f70493a2/41be6/volumes.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/klEQVQoz5WP/2sScRjH75+q/RDUMogIahT0YzHcFlswTBexqXO2iL79sB9i6c473SJkUJHBtDvNb0vnSueZuDZZ3cfpfU5y80tN0DvvvD4mGxP2Sw8vHt4PPC8eHqz/Lvg/NOCsbveSPn9uooCptOCCDqh04LwWdDMKXVQn0a9hB8wFh29fPcdjp0bZK1PghhlcnmSvm8BVA0B9wACuGdm+O+zpsR76xli0f0a7O/qieFHPYSYSmh1wdgnOLkKTnZuxd8IMWUDdSMApnJsmod7GGXDORPIoTBOckeQncV5P8FhbFmWpQ1sSa/XG2/XsPM3Me76+pBlXfCeT37P6GAuVsNIbFi+TZIuKIrVlAVmKLGKCKB5RPmg8eBcfIcL3nOtDePjxh2RoszBoDWhfxxC3LH4PwyptuSkI3X1MPFaVg+YjV2LYFtK8igzbgs9XmMgWHMID40ufEeqFgDeVQ/I/t1M9cq3efPg+cdu+en85NkKuPu3InBoP6pyxCWdscCFApcAJMpqklgjL9eXgFuH5tkilbe7Um/B2NM3h7pSDSiOsK0w0w8mSdOgeyg1BVJTWXLL0bK0UzZZd8XwkW7Fu7N+k4dqPP26Gp9NF73btyZdfR2d7LiuSmCnVP7LVUK7qBxXfzz3qe969mf+0UwrkqkFQ8edqMfi7dezNv2/b5msmRtbiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"volumes\"\n        title=\"volumes\"\n        src=\"/static/a8a1e63f4096f24083f3fc17f70493a2/41be6/volumes.png\"\n        srcset=\"/static/a8a1e63f4096f24083f3fc17f70493a2/5a46d/volumes.png 300w,\n/static/a8a1e63f4096f24083f3fc17f70493a2/0a47e/volumes.png 600w,\n/static/a8a1e63f4096f24083f3fc17f70493a2/41be6/volumes.png 638w\"\n        sizes=\"(max-width: 638px) 100vw, 638px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://segmentfault.com/a/1190000022860937\">Kubernetes 本地持久化方案</a></li>\n</ul>"},{"id":"736f8c60-1d67-5367-8d6a-04b2b25bc521","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"react使用websocket通信","path":"/websocket","tags":["Network"],"excerpt":"react使用websocket通信","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAC4jAAAuIwF4pT92AAADEklEQVQozw2N7VMSCQCH97+4qTsrShBXFpZlgX3fhWWBXRAEEdB0PCBJSRIMLzMyhG6sAJVSeQ0zo5LLzrzJ3mYub7KppvrQf3R8eGZ+X57fA+gpAsNQBO6jDGoGhzG012FCFia8/2xmv+83fr7a/nGw9eNl89v+1tcXzS97D47b9Q9PKgfVlWx8HOjtkcGQHIWVGtU5GJIN2rDlZKiRu/K2fufL8+r3l1udi89/1Y7btU/t+sfd2n/Pah9alfZqNteRYVW3sueMQv4bBHb5JDJ/NVb9c/719vpRu378vHn0uPR+5/7x3sPO/vdJpdM8elp7t7N52FjNJSKATHZCIf9V03dK4tHrsdH8fKy1cnO/VjhsFouzgfmAYXlCqKdDe/cyb1u1N4+rh9sbrx+VDxprN6bHAaX8pBrssrKa6IgjlwiVl2aflbIvNpczUbcHO+3EZcMmxaSonHb23Zly7Fdu//1gY7e8tlO6m03FAUQtk3gk5BcS4cF0bLi4MHV/MV7PpfwcNMaTETtNQ7+I+tNhN5f0YsX40G7lXmu9sF3Kr2TSAIv32ggwMeJeiAbi4eDtazP59OzSYtbrcvXj2qid8bDw1eSVfH59Y22jWii2yuXmamElc31xNg5YJBuhBVkdxOM6n394MpaMRKcvz90cDU3ByrMY2DXiHQyHYpELM5HYXO5WsVFubhZXi7dyufQNANQoFSrFWVAhV3WDiLbf1S9YBa8vGBge10AgS+IBX1DkzW7R4Rsa9YxNTqQyhVLtUvIPI28BUExjJHQ4rjKQCEdDJI1SpMblksYnZhzOAY9ot3MUR5MMw9AWK+XwiGOTF1JL84vLTqcDMBrVar2GNPZoMa2JkOuMkF4vFy1oOHo5HLrotNlYCufMfAeU4TCLjR3wu0LT0bml1Nw1ANUp1VolS6sxGpNEDtaeIyidxy04XQOS6GBIHDeiBInrCQIhKT3DGcwCKbntgd/PRxMAolVAULfZZDBbOKfEWwWKFzh/cEiwWewWFkMhjiZYjqVMpk5cz7AIQSEUjQmi1Rv8H1OrJKaXHwWoAAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/dc6da965afbecc04f53ba4eeafaf5c6b/0853f/girl.png","srcSet":"/static/dc6da965afbecc04f53ba4eeafaf5c6b/14156/girl.png 125w,\n/static/dc6da965afbecc04f53ba4eeafaf5c6b/d6e47/girl.png 250w,\n/static/dc6da965afbecc04f53ba4eeafaf5c6b/0853f/girl.png 500w,\n/static/dc6da965afbecc04f53ba4eeafaf5c6b/ce627/girl.png 750w,\n/static/dc6da965afbecc04f53ba4eeafaf5c6b/9dbcf/girl.png 1000w,\n/static/dc6da965afbecc04f53ba4eeafaf5c6b/87046/girl.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"浏览器自带的-api\" style=\"position:relative;\"><a href=\"#%E6%B5%8F%E8%A7%88%E5%99%A8%E8%87%AA%E5%B8%A6%E7%9A%84-api\" aria-label=\"浏览器自带的 api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>浏览器自带的 api</h2>\n<blockquote>\n<p>如果是 https 则采用 wss</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// 这里的转发标识为/ws</span>\n<span class=\"token keyword\">const</span> wsPath <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">ws://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>host<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/ws/system</span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token keyword\">const</span> socket <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebSocket</span><span class=\"token punctuation\">(</span>wsPath<span class=\"token punctuation\">)</span>\nsocket<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"open\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// send可以传递字符串或者二进制</span>\n  socket<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nsocket<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMessage<span class=\"token punctuation\">)</span>\nsocket<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"close\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  socket<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMessage<span class=\"token punctuation\">)</span>\n  socket<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><a name=\"0BRMq\"></a></p>\n<h2 id=\"开发环境配置：\" style=\"position:relative;\"><a href=\"#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%EF%BC%9A\" aria-label=\"开发环境配置： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>开发环境配置：</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">devServer<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      proxy<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 普通http请求</span>\n        <span class=\"token string\">'/api'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            target<span class=\"token operator\">:</span> <span class=\"token string\">'http://localhost:8099/'</span><span class=\"token punctuation\">,</span>\n            changeOrigin<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n            secure<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">// websocket请求配置</span>\n        <span class=\"token string\">'/ws'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          target<span class=\"token operator\">:</span> <span class=\"token string\">'ws://localhost:8099/'</span><span class=\"token punctuation\">,</span><span class=\"token comment\">// 可以写http或者ws开头</span>\n          ws<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 代理使用websokcet协议</span>\n          secure<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n          changeOrigin<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br />\n<p><a name=\"UDtcL\"></a></p>\n<h2 id=\"生产环境配置：\" style=\"position:relative;\"><a href=\"#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%EF%BC%9A\" aria-label=\"生产环境配置： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>生产环境配置：</h2>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre class=\"language-nginx\"><code class=\"language-nginx\"><span class=\"token operator\">/</span><span class=\"token operator\">/</span> 这里是websocket相关的配置\n<span class=\"token keyword\">location</span> <span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>ws <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">proxy_pass</span> <span class=\"token keyword\">http</span><span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span><span class=\"token number\">192.168</span><span class=\"token number\">.233</span><span class=\"token number\">.238</span><span class=\"token punctuation\">:</span><span class=\"token number\">8090</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">proxy_next_upstream</span> error <span class=\"token keyword\">timeout</span> invalid_header http_500 http_502 http_503<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">proxy_set_header</span> Host <span class=\"token variable\">$host</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">proxy_http_version</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">proxy_set_header</span> X<span class=\"token operator\">-</span>Real<span class=\"token operator\">-</span>IP <span class=\"token variable\">$remote_addr</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">proxy_set_header</span> X<span class=\"token operator\">-</span>Forwarded<span class=\"token operator\">-</span>For <span class=\"token variable\">$proxy_add_x_forwarded_for</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">proxy_set_header</span> X<span class=\"token operator\">-</span>Forwarded<span class=\"token operator\">-</span>Proto <span class=\"token keyword\">https</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">proxy_set_header</span> Upgrade <span class=\"token variable\">$http_upgrade</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">proxy_set_header</span> Connection <span class=\"token string\">\"upgrade\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">proxy_set_header</span> Origin <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">proxy_redirect</span> off<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span></code></pre></div>\n<br />\n<h2 id=\"我的-nginx-配置：\" style=\"position:relative;\"><a href=\"#%E6%88%91%E7%9A%84-nginx-%E9%85%8D%E7%BD%AE%EF%BC%9A\" aria-label=\"我的 nginx 配置： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>我的 nginx 配置：</h2>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre class=\"language-nginx\"><code class=\"language-nginx\"><span class=\"token keyword\">location</span> <span class=\"token operator\">~</span> <span class=\"token operator\">/</span>ws<span class=\"token operator\">/</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">rewrite</span> <span class=\"token operator\">^</span><span class=\"token operator\">/</span>ws<span class=\"token operator\">/</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span>api<span class=\"token operator\">/</span>v1<span class=\"token operator\">/</span>$<span class=\"token number\">1</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">proxy_pass</span> <span class=\"token keyword\">http</span><span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>ginapp<span class=\"token operator\">-</span>service<span class=\"token punctuation\">:</span><span class=\"token number\">8686</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">proxy_http_version</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">proxy_set_header</span> Upgrade <span class=\"token variable\">$http_upgrade</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">proxy_set_header</span> Connection <span class=\"token string\">\"upgrade\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li>nodejs 后端非常好用的 websocket 通信包：<a href=\"https://socket.io/\">https://socket.io/</a></li>\n<li>基于 socket.io 衍生出的前端 websocket 通信工具：<a href=\"https://socket.io/docs/client-api/\">https://socket.io/docs/client-api/</a></li>\n<li>注意：socket.io.client 必须与 socker.io 配合使用</li>\n</ul>"},{"id":"a513e280-6db8-5f38-b32e-aea5070ca6cf","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"webpack中五个容易混淆的知识点","path":"/webpack","tags":["JavaScript"],"excerpt":"webpack中五个容易混淆的知识点","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADFklEQVQozxXO7U/TCADH8b7UHA926x7ade3abd06242Wjm7rYMCeYGwMcBeYW3ZmMDQD9bLzeBhwM27yNCdMFBUkKCZGhuaCBi+od4nmLvfCy/1NluT39pPvD1A2n0MUP+DqFhIGzTqQQpU2HLIbNRwFuxisWzD3ddqHQp7USP/VK2O3rl+7vTi3tbnVaLz99PEPQNF0DpaxptWkAy16pRWDWELVboZdNp2PJ4IuOuLlEhHfT2Ox/GRmsVhYr1ae7j5pNN4cHx8DUMt5WNGkVzUbtC2yP8Okmqe0glUn0obRuC034cym3JPZ4cLP+Tvl4v366vbu1v6LvZcHLwAUaiK0LYS2VcYk3EqhoM0AsSZNF68bDBNDMTyRILJZYTwXKi5EllcLtc272zv3H+/UH21vADKT39I4ZMUUZhSU4yYUNCKKXlE7Moh4PepwAMtN87lpLpe3L6+Pr1bLG1vL9Ydr1VrlDFsxJUtqHEa1nVQxBETpFZQelHgo4tfHw4bBAUPiEpVOtY0l7ber4fVauraxUFlZWFwqAJi62YIp20xakUZcNkSktZxJxVFqX4fK0w51Cmq76YJAwyEfHhsiJ67TK2vhYnFqdiY/dS0NGBHQTmrcNCJd1HkZuJNFPBcRidGHJTbWJ/R4CVJ33unAhyJt3W50OE6Uyj3z82P58dFMIgKwhMZpgWXcxSABDgkJaKAdCzgto1FHNMhwFNgtGvp72/1eR0iyxMPk5bRhItN5OdabCLoBhwkWrWdZWUY9+qhEDIjGETfe52j1kE1d9IV+CZ0cdSZHpGgfH/GzA36mp4MZkNioh5HLkGhRdzFan10TFHRBHgtwWLJDn2yDUzz+I4fngvx8OpC65PL7TD7RLFjRDhvstiHdLAbMTqXnplNz+WTxRqY8c3Vt6WbtzkzpZva36cytdHw2M7y3UdmplXYfrzy4t1ivLtUqM2ulQrX0S/nXSeBwb/No/+HB9vrrZ/WTw/2/3h+e7d3h36fH//558u3L6f//fP7v6+nnd69OjvY+HD0/ffvyQ+P5+1fPfj949B0NpOhRHZ8n2AAAAABJRU5ErkJggg==","aspectRatio":1.5060240963855422,"src":"/static/87f90b87c54b86eb166522b63f27a280/0853f/bonsai.png","srcSet":"/static/87f90b87c54b86eb166522b63f27a280/14156/bonsai.png 125w,\n/static/87f90b87c54b86eb166522b63f27a280/d6e47/bonsai.png 250w,\n/static/87f90b87c54b86eb166522b63f27a280/0853f/bonsai.png 500w,\n/static/87f90b87c54b86eb166522b63f27a280/ce627/bonsai.png 750w,\n/static/87f90b87c54b86eb166522b63f27a280/9dbcf/bonsai.png 1000w,\n/static/87f90b87c54b86eb166522b63f27a280/87046/bonsai.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"1webpack-中，module，chunk-和-bundle-的区别是什么？\" style=\"position:relative;\"><a href=\"#1webpack-%E4%B8%AD%EF%BC%8Cmodule%EF%BC%8Cchunk-%E5%92%8C-bundle-%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F\" aria-label=\"1webpack 中，module，chunk 和 bundle 的区别是什么？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.webpack 中，<code class=\"language-text\">module</code>，<code class=\"language-text\">chunk</code> 和 <code class=\"language-text\">bundle</code> 的区别是什么？</h2>\n<p><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 657px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/be2141af3283bf7c9127ae8874c0ba52/a1253/img.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVQozwGfAmD9AN7u6avi2K3j2qDe08Lo497i5rjBxbrCx7nBxr/Hy7vDx7rDx7a/xNHV197q8rvY6r3a673a67jY6t/q7wCd3soixo47zJoIvX1U26OamJcKHSUaLDQ4Rk1cZWtCT1UXKjIJHylhY2Of0eVSsNhvudpwuttGqtibzucAm93IAJG+DI7fAInWF5flQprXM36ePoKZQ4edQoacQoacP4OZMHKJU4aiZ7frDI3cG5TdHJPeDpDZnM/nAJvcyQWQsyKPzRaKxhaK2y+s+lnN/WPf/1/e/2De/2He/2Hf/1/V/DC5/wCH/wR5/QeA/wmA/wB78ZvN5gCb3MmY0Cfk4R/V3BDk4ETB2b5sy+ld1vlk1/h72vZs2Pdc1/ldyet8t8mHwMc6n6lFo6dHpKUum7Kcz+cAmNzLbMM7s9AmoMskwdVNzuC0gdXrXdX6Xtf6Xtf6X9f6XNf6bdLvuNzI8+Jl9dsN9N4S/+MJuMY1nc3mAJjcyojKL9ndLMbVGdLbR7/KpWKdrEORq0WRqkSRqkWRqkWSqz+DmoKcma/RvkunllerlVutkzmipJvO5wCX3MuKxyvg2RnO0hLc2ULM16x/zeFd2v9o3P593/1u3P9e2/9q1PWp2NPj3Hzm1x7n2yT04R2uxEOdzuUAl9zKXsM9oNEyjMopstldtsGlSoGQN4CYOoCYQIGYO4GYOYGZMnSLfpeWs9O+SqaUV6uTXK2ROqGjm87nAN3t6Iva04nb2YTb17Tq6tzb4aqtsLKys7Gxs6+xs7Cxs7KytKuusMvLzNzq+KPS86nU9KbT86fT8N/p7wD08vP88O7/8e7/8/D78/H29vT9/f37/f37/f38/f37/f37/f38/f34+fj28/D/9u/99e368ur48ery8fDrA7XUJdQeIQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1604373359405.jpg\"\n        title=\"1604373359405.jpg\"\n        src=\"/static/be2141af3283bf7c9127ae8874c0ba52/a1253/img.png\"\n        srcset=\"/static/be2141af3283bf7c9127ae8874c0ba52/5a46d/img.png 300w,\n/static/be2141af3283bf7c9127ae8874c0ba52/0a47e/img.png 600w,\n/static/be2141af3283bf7c9127ae8874c0ba52/a1253/img.png 657w\"\n        sizes=\"(max-width: 657px) 100vw, 657px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br />看这个图就很明白了：<br /></p>\n<ol>\n<li>对于一份同逻辑的代码，当我们手写下一个一个的文件，它们无论是 ESM 还是 commonJS 或是 AMD，他们都是 module ；</li>\n<li>当我们写的 module 源文件传到 webpack 进行打包时，webpack 会根据文件引用关系生成 chunk 文件，webpack 会对这个 chunk 文件进行一些操作；</li>\n<li>webpack 处理好 chunk 文件后，最后会输出 bundle 文件，这个 bundle 文件包含了经过加载和编译的最终源文件，所以它可以直接在浏览器中运行。</li>\n</ol>\n<p><br />一般来说一个 chunk 对应一个 bundle，比如上图中的 utils.js -> chunks 1 -> utils.bundle.js；但也有例外，比如说上图中，我就用 MiniCssExtractPlugin 从 chunks 0 中抽离出了 index.bundle.css 文件。<br /><code class=\"language-text\">module</code>，<code class=\"language-text\">chunk</code> 和 <code class=\"language-text\">bundle</code> 其实就是同一份逻辑代码在不同转换场景下的取了三个名字：<br />我们直接写出来的是 module，webpack 处理时是 chunk，最后生成浏览器可以直接运行的 bundle。<br />\n<br /></p>\n<h2 id=\"2filename-和-chunkfilename-的区别\" style=\"position:relative;\"><a href=\"#2filename-%E5%92%8C-chunkfilename-%E7%9A%84%E5%8C%BA%E5%88%AB\" aria-label=\"2filename 和 chunkfilename 的区别 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.<code class=\"language-text\">filename</code> 和 <code class=\"language-text\">chunkFilename</code> 的区别</h2>\n<p><br /><code class=\"language-text\">filename</code> 指<strong>列在</strong> <code class=\"language-text\">entry</code> 中，打包后输出的文件的名称。<br /><code class=\"language-text\">chunkFilename</code> 指<strong>未列在</strong> <code class=\"language-text\">entry</code> 中，却又需要被打包出来的文件（如懒加载的文件）的名称。<br /></p>\n<h2 id=\"3webpackprefetch、webpackpreload-和-webpackchunkname-到底是干什么的？\" style=\"position:relative;\"><a href=\"#3webpackprefetch%E3%80%81webpackpreload-%E5%92%8C-webpackchunkname-%E5%88%B0%E5%BA%95%E6%98%AF%E5%B9%B2%E4%BB%80%E4%B9%88%E7%9A%84%EF%BC%9F\" aria-label=\"3webpackprefetch、webpackpreload 和 webpackchunkname 到底是干什么的？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.<code class=\"language-text\">webpackPrefetch</code>、<code class=\"language-text\">webpackPreload</code> 和 <code class=\"language-text\">webpackChunkName</code> 到底是干什么的？</h2>\n<p><br /><code class=\"language-text\">webpackChunkName</code> 是为预加载的文件取别名，<code class=\"language-text\">webpackPrefetch</code> 会在浏览器闲置下载文件，<code class=\"language-text\">webpackPreload</code> 会在父 chunk 加载时并行下载文件。<br />\n<br /><code class=\"language-text\">webpackChunkName</code>打包出来的 bundle 会有 vendors~这种前缀<br />原因是其实 webpack 懒加载是用内置的一个插件 <strong>SplitChunksPlugin</strong> 实现的，这个插件里面有些<strong>默认配置项</strong>，比如说 <code class=\"language-text\">automaticNameDelimiter</code>，默认的分割符就是 <code class=\"language-text\">~</code><br />\n<br /></p>\n<h2 id=\"4hash、chunkhash、contenthash-有什么不同？\" style=\"position:relative;\"><a href=\"#4hash%E3%80%81chunkhash%E3%80%81contenthash-%E6%9C%89%E4%BB%80%E4%B9%88%E4%B8%8D%E5%90%8C%EF%BC%9F\" aria-label=\"4hash、chunkhash、contenthash 有什么不同？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.<code class=\"language-text\">hash</code>、<code class=\"language-text\">chunkhash</code>、<code class=\"language-text\">contenthash</code> 有什么不同？</h2>\n<p><br />hash 计算与整个项目的构建相关；<br />chunkhash 计算与同一 chunk 内容相关；<br />contenthash 计算与文件内容本身相关。<br /></p>\n<h2 id=\"5sourse-map-中-eval、cheap、inline-和-module-各是什么意思？\" style=\"position:relative;\"><a href=\"#5sourse-map-%E4%B8%AD-eval%E3%80%81cheap%E3%80%81inline-%E5%92%8C-module-%E5%90%84%E6%98%AF%E4%BB%80%E4%B9%88%E6%84%8F%E6%80%9D%EF%BC%9F\" aria-label=\"5sourse map 中 eval、cheap、inline 和 module 各是什么意思？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.<code class=\"language-text\">sourse-map</code> 中 <code class=\"language-text\">eval</code>、<code class=\"language-text\">cheap</code>、<code class=\"language-text\">inline</code> 和 <code class=\"language-text\">module</code> 各是什么意思？</h2>\n<table>\n<thead>\n<tr>\n<th align=\"left\">参数</th>\n<th align=\"left\">参数解释</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">eval</td>\n<td align=\"left\">打包后的模块都使用 <code class=\"language-text\">eval()</code>执行，行映射可能不准；不产生独立的 map 文件，速度很快(不需要复杂转换和打包)，不能映射到原始代码（没有从 loader 中获取 source map）</td>\n</tr>\n<tr>\n<td align=\"left\">cheap</td>\n<td align=\"left\">map 映射只显示行不显示列（只看得到哪行错了），忽略源自 loader 的 source map,即没有源码的映射</td>\n</tr>\n<tr>\n<td align=\"left\">inline</td>\n<td align=\"left\">映射文件以 base64 格式编码，加在 bundle 文件最后，不产生独立的 map 文件</td>\n</tr>\n<tr>\n<td align=\"left\">module</td>\n<td align=\"left\">增加对 loader source map 和第三方模块的映射，即源码的映射</td>\n</tr>\n<tr>\n<td align=\"left\"><code class=\"language-text\">hidden</code><br /><code class=\"language-text\">nosources-source-map</code></td>\n<td align=\"left\">和<code class=\"language-text\">source-map</code>基本相同，但是不会有<code class=\"language-text\">sourceMappingURL</code>注释，这样你就无法定位到源文件，这样你在开发环境能看到具体的目录结构，基本上就是生产环境能用，开发环境不能用，</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"原文链接\" style=\"position:relative;\"><a href=\"#%E5%8E%9F%E6%96%87%E9%93%BE%E6%8E%A5\" aria-label=\"原文链接 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>原文链接</h2>\n<p><a href=\"https://mp.weixin.qq.com/s/H5KeOIKoJ1r3K8-EbKmdLA\">点这里！</a></p>"},{"id":"e3adc98b-f391-5d5e-9301-40a59aabb8ce","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"深入浅出防抖和节流","path":"/throttle","tags":["JavaScript"],"excerpt":"深入浅出防抖和节流，原理及其实现","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJElEQVQozwEZA+b8AHdrPYuDYsHHz8/b8c/a8cvZ8cvY8s3a8svX7cjZ9cPT7cHS8L7P6rzM5rrL57bK56/G5qfA46C84Zi33wDIkxirfxm2lVLYxafy6N3nzZ7RrmbNrm/TqlfVuILFspDRvJXx6uf29//y8vjw8Pfu7/br7PXl6PHg5PAAoHkgtIkpo3wqvY0qn3kuiGUUkmoOpHcbonYZgl0LeloUfFwSpYVG18Sp+fT0+PX3+fb4+Pb5+vn++Pb6AMCOHbuLGbCCHaV6HqmAI513Jq6AIIpnHndcIHlbFW9UGFRDG2FJFH9fG8Gqhvr5+/v6//f09urj3uro7ACkdwuhdRPAihfcnRO3hRqtgByjdhJqTRBoThzHp3rFoGB0Vg6HZyVrUx+RdDvDsZXGtJm4mV61izjAn2IAgWUtkWoTbVAPj2gQgmEYdlsYn3sryqt32b2cv6CNqo1wnHIdnHIcaVEglW8il3AgdFokgF4clG4jnngsAGtaSn1jL31jLLqLKLKBFbeDDta2iebPx9S3obCPeLeVZqV8IoFgIINkIYJkJ2pSJFNDImVOIn5fIHZZHwBdUTVjVzpfUzmWdjiVcy6ediXCn3SWe2CWeVt3X0mSc0aLaix2XCluViWTcS13XzRMPCZfSh1aRh1QPhkAgHJEd2c9YVYyWE4tknhLjHdKh3FLaVY2VEMqRTUge2hWh3RpcmFVcGJWb1xEfmpSeGFHf2ZBZ1IvcVoqAGNeMW5jOIZ4RIF3PYV2QoBvP4t4SH1tQXZkPltOMExEKmVZPn5sVG9cSWBONoBqSIRsSn9nR2hVPW1ZQAA4Pxs9RR9cWytYWChYWChdWCteWC1fVi92aDl0ZDtdUi96ZzyIdUWLeESMe0eIeEN8aUBoWDlyYEBxXkMANkUYM0EXLzsVREkbc3Avb2ktWVglVlYkRkchMTQYb2M4q49Zk39KjoJDjoREhXxBgnlBiX9HfnFEfG1FAElTIThDGT1IGVldI2hnJoB3NXdyMnZxMFpdJFNWJJmCQ7SUUZ6JSIx+PoV+Oo6GQY6FQoqBQ4Z9Q4B3QYwzbEDSMTK5AAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/d99d21ec126a5af8d06217620c9096c0/0853f/sheep.png","srcSet":"/static/d99d21ec126a5af8d06217620c9096c0/14156/sheep.png 125w,\n/static/d99d21ec126a5af8d06217620c9096c0/d6e47/sheep.png 250w,\n/static/d99d21ec126a5af8d06217620c9096c0/0853f/sheep.png 500w,\n/static/d99d21ec126a5af8d06217620c9096c0/ce627/sheep.png 750w,\n/static/d99d21ec126a5af8d06217620c9096c0/9dbcf/sheep.png 1000w,\n/static/d99d21ec126a5af8d06217620c9096c0/87046/sheep.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<blockquote>\n<p>连续尝试进行过多的 DOM 相关操作时，这很可能会导致浏览器挂起，有时候甚至崩溃<br>\n此时，就需要节流和防抖来使某些代码不可以在没有间断的情况下连续重复的执行。</p>\n</blockquote>\n<h2 id=\"节流\" style=\"position:relative;\"><a href=\"#%E8%8A%82%E6%B5%81\" aria-label=\"节流 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>节流</h2>\n<blockquote>\n<p><strong>节流</strong>：让事务在一段时间间隔内周期性的执行（举个栗子：就好像不让水龙头一直不停的流，而是把水龙头揪紧一丢丢，让它一滴一滴周期性的流下去，以此达到节流的效果）\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 783px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f3e802c8fe48caf53a3ad297851151c8/e51a6/throttle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABBElEQVQoz12RaQqDMBCFvf+l1BP4Q6lYEMTWfV9wj9O8oZHagYfxy6wZ7TxPgmBCiEtgQhy0LAvN80zrun2ZYDZNE0v5Kmn0tW3bKE1Ter1CqpuG2bHvF6uqWrnKc0VR9KY4junfNFTP85z6vqe6rqkoCirLksIw5MC2bVlgvu+zL86NLJokCfshMc7HcZCG9l3XlRUjvsiyjLtyHIe/EBgEhiIqoed5FAQBjeNIXdfx+BoudF2/tQ1mGMaNoft/ZlkWJ72NjOymaXInV0IZbNs2P7pa2DAM5D4e1MuvYkjmPZ88KuxaCsC6rldCPAMKLT8MSwPDm8tIjuFty/9dLg/jgn0AO2MYJklAzCUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"throttle\"\n        title=\"throttle\"\n        src=\"/static/f3e802c8fe48caf53a3ad297851151c8/e51a6/throttle.png\"\n        srcset=\"/static/f3e802c8fe48caf53a3ad297851151c8/5a46d/throttle.png 300w,\n/static/f3e802c8fe48caf53a3ad297851151c8/0a47e/throttle.png 600w,\n/static/f3e802c8fe48caf53a3ad297851151c8/e51a6/throttle.png 783w\"\n        sizes=\"(max-width: 783px) 100vw, 783px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">throttle</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">func<span class=\"token punctuation\">,</span>wait</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> timeoutID<span class=\"token punctuation\">;</span>                                <span class=\"token comment\">//初始化定时器</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>                            <span class=\"token comment\">//调用throttle则返回此闭包</span>\n        <span class=\"token keyword\">let</span> args<span class=\"token operator\">=</span>arguments<span class=\"token punctuation\">;</span>                       <span class=\"token comment\">//保存传给闭包的参数(比如：event对象)</span>\n        <span class=\"token keyword\">let</span> context<span class=\"token operator\">=</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>                         <span class=\"token comment\">//保存闭包的执行环境</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>timeoutID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>                             <span class=\"token comment\">//如果定时器不存在</span>\n            timeoutID<span class=\"token operator\">=</span><span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>        <span class=\"token comment\">//则创建一个新的定时器</span>\n                <span class=\"token function\">func</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>            <span class=\"token comment\">//绑定func的执行环境为调用闭包的this环境，传入func的参数为调用闭包的参数</span>\n                timeoutID<span class=\"token operator\">=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>                     <span class=\"token comment\">//执行完func重置timeout</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>wait<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                             <span class=\"token comment\">//在wait时间后将匿名函数插入执行队列</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token number\">1.</span>函数的目的是：定义一个定时器，如果定时器不存在，则创建一个新的定时器，并执行函数func；\n<span class=\"token number\">2.</span>函数返回闭包的原因：为了保持timeoutID变量一直在内存中<span class=\"token punctuation\">,</span>调用throttle函数返回的都是<span class=\"token operator\">**</span>执行过后<span class=\"token operator\">**</span>的闭包函数来访问timeoutID<span class=\"token punctuation\">,</span>通过timeoutID来判断调用throttle时是否存在定时器<span class=\"token punctuation\">;</span>\n<span class=\"token number\">3.</span>注意：apply和call不仅会绑定函数的执行环境和传入参数，还会立即执行函数</code></pre></div>\n<h2 id=\"防抖\" style=\"position:relative;\"><a href=\"#%E9%98%B2%E6%8A%96\" aria-label=\"防抖 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>防抖</h2>\n<blockquote>\n<p><strong>持续防抖</strong>：如果持续触发事务，则不执行，在停止持续触发事务一段时间后，再执行事务（举个栗子：坐电梯时，如果在电梯内持续有人按电梯的楼层号，那么电梯是不会启运行的，当没人按楼层号时，电梯会在一小段时间间隔之后才会运行.以此达到持续防抖的效果）\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 545px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4cda95ff862e24da35e4bc7a2c4670cf/3ddad/allthetime.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSElEQVQoz31S24rCMBDt/3+GSBEFn/yC9YKIl1VLLwou9UWxVVtTtNjas5lZUmrKOnDIZJKcmTkZA9KKoqjh9XrV9nmel6CYels1QwXSNMX3YoHJZIKFXKfTKay1hd3Pjs+PxwPWqxUc18FoNEIQhBwnckqmYFDw+Xzy5j/7dKaboaqjrJvNBq7rvoFiw+EQy+USnufBcRwMBgPYts2+DkMxt9ttWJYFIQTO5zMulwuu1yv74/EYYRgiiiLZ+pGJyac7OpgwjmP0ej1st9taC3TWbDaZnCwIAnS73c8t51n2RqgEVnI0Gg0kScJ73/dhmmb50zqY8CarmMlfnc3nuN8ff+NAxPIREXQ6Hfj7PcdPpxNarVZZUXV8SkI9S/WyEDfWlUBGmvb7XzhILaM4qs2ioQ9mNYFu1GaaPlh8qlQkohz4TMpG/i+JQvkj4FsVqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"allthetime\"\n        title=\"allthetime\"\n        src=\"/static/4cda95ff862e24da35e4bc7a2c4670cf/3ddad/allthetime.png\"\n        srcset=\"/static/4cda95ff862e24da35e4bc7a2c4670cf/5a46d/allthetime.png 300w,\n/static/4cda95ff862e24da35e4bc7a2c4670cf/3ddad/allthetime.png 545w\"\n        sizes=\"(max-width: 545px) 100vw, 545px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">debounce</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">func<span class=\"token punctuation\">,</span> wait</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> timeoutID\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> context <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span>\n    <span class=\"token keyword\">let</span> args <span class=\"token operator\">=</span> arguments\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>timeoutID <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span>timeoutID<span class=\"token punctuation\">)</span> <span class=\"token comment\">//如果存在定时器，则将清除定时器</span>\n    timeoutID <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">//再次创建新的定时器</span>\n      <span class=\"token function\">func</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> wait<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"立即防抖\" style=\"position:relative;\"><a href=\"#%E7%AB%8B%E5%8D%B3%E9%98%B2%E6%8A%96\" aria-label=\"立即防抖 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>立即防抖</h2>\n<blockquote>\n<p><strong>立即防抖</strong>：让事务开始触发时立即执行，然后持续触发事务时不执行，当停止触发事务一段时间后再将事务插入任务队列。（再举个栗子：一直按住弹簧，它不会弹起来，如果突然松手之后，它就会立刻弹起，如果在弹起的过程中又持续按住了弹簧，又突然松手，它就会在一段微小的时间间隔之内再次弹起。以此达到立即防抖的效果。）\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 730px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/66cf8900150119788e4a359330310bb9/e9beb/rightnow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCElEQVQoz3VSyaqFMAz1/79Id36ALkTsQsER6zwhvD5EzW1yqahXA4c0AzkZqu37DgpP8hQ72/eYdnZWVQmMeeD7PgRBAPM8H4l1XUMYhjKnuhDdod0Ztm2DTfpQnwULcp6THsYB3oQ6ROaiKAhlWR5Am3MOnufRO89zshljkGXZEVexpmm+BTEBHcMwQNd1F4zjCI7jQBzHME0TdH0HrusSYd/3R17btpRLBQ3DoGJvous6EZ7tZVneR7Ysi9jvl1R7tG2bxlI7Nk2TGljX9fcoyIQXjaIIUrmXJE0hlVCnQiLcF+1ZjomCu0qS5GjiUhAZhRAg/sVXiz/ST3/s6Q/Sr5DAblF/AElktFB1Q5NcAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"rightnow\"\n        title=\"rightnow\"\n        src=\"/static/66cf8900150119788e4a359330310bb9/e9beb/rightnow.png\"\n        srcset=\"/static/66cf8900150119788e4a359330310bb9/5a46d/rightnow.png 300w,\n/static/66cf8900150119788e4a359330310bb9/0a47e/rightnow.png 600w,\n/static/66cf8900150119788e4a359330310bb9/e9beb/rightnow.png 730w\"\n        sizes=\"(max-width: 730px) 100vw, 730px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">debounce</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">func<span class=\"token punctuation\">,</span> wait</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> timeoutID\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> context <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span>\n    <span class=\"token keyword\">let</span> args <span class=\"token operator\">=</span> arguments\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>timeoutID <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span>timeoutID<span class=\"token punctuation\">)</span> <span class=\"token comment\">//如果存在定时器，则清除定时器</span>\n\n    timeoutID <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      timeoutID <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span> <span class=\"token comment\">//定时器在wait时间后清零</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> wait<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>timeoutID <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">//如果不存在定时器(timeout=null)，则执行函数</span>\n      <span class=\"token function\">func</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>因此个人认为，防抖和节流的共同作用都是让浏览器节约成本的操作，区别是实现和节约成本的方式不同。</p>\n</blockquote>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"http://blog.poetries.top/2018/12/21/js-debounce/#at?hmsr=toutiao.io&#x26;utm_medium=toutiao.io&#x26;utm_source=toutiao.io\">一个写的很好的博客</a></li>\n</ul>"},{"id":"6c104644-1560-571c-a653-aa9d93a0a4dc","headings":[{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"TCP服务端和浏览器端的三次握手和四次分手","path":"/tcp","tags":["Network"],"excerpt":"TCP服务端和浏览器端的三次握手和四次分手","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3klEQVQozxXQ+U/TABQH8P4LEmVXt64dTA4vHBhAMgkTGfFABAyoQdQEVMADPH4y/ED8BQUThIRIBFFuI45zAyZsZaO03cqOHqNd143ThN/8CyzffPJ+ee/98B7w8UNXX2/f6OCQbWxi8bdtdcGOOle9Lg/mxXHMR/kCfsJP4WQAJ3wYseYlVlHMvuKZW3ZP251AR09f99cfA+NTU/OOpRXUs47LYzwvfO7uzr2QU3KleHRkJB6TOJqOsnSUDm0FKNqPB3Av7nEBnYPDX37aRu3Oaff6Mk6hVAgLMmExXnarIi//ormw8ElT887fQzoiMLzIbPFhltsMhUnKv45jwI/J0RnH/B+P20viZJCi6CDNR6hgIC09rbbuwdPGJoVSueRc3tnb5aOCIEZ5UeC2OJoNbQZJYHZuAkUdPhINBQmG2WS5oBDl5Cuzs03JyckajQZBEOeyY38/IUq8JAmStBWLsaIQEjgCmJn+5l6dIoml0KabDWMRjohwvkScqa6uUiiUIAiazQVSjE0kIgmJ3ZaYRCwcFwNxnhQZFHANvMMmO0lbLzXXH3IMimvjh4EFt+2rwWDQ6XRqtcZkyhL8zkNhY18gDqKyjQPRuy+gO6wdwL+1hn+1M7NdorNPdA1EXUOia+huuTVZoUJgGAS1melG0f39X3jmMGjb9U3ubIxsY98TaH9ssQMYaiiZby1ffFvtaqtzt9cvtDXWl5WcUKphGNZDkEqtNueYxtpeT7a/mX/fQn9qlXpaDvpf7A0//2trASxZ52/n59VfsTyyWp/dLHtVVXE2zQhqdRCkMyAGPQxnnkyrthQ/Li1pLi1qr7R21Fg775W+rb3x8v51IP10tjEzK1WWITsHGzPkPRhGtCCYXWAx5V3S6nRFlQ/h9FPHVaokFXhMoU5SaiDjmUyTGdAfBdJDWj2kk8FHVY5e/ta1Ow2Xb9TI7QLL1RRDigGGU5EjKQiMwFBObv5/em2D0Ey6GTsAAAAASUVORK5CYII=","aspectRatio":1.6025641025641026,"src":"/static/f1c2b97eb13574766d32aacd28ee9c75/0853f/couple.png","srcSet":"/static/f1c2b97eb13574766d32aacd28ee9c75/14156/couple.png 125w,\n/static/f1c2b97eb13574766d32aacd28ee9c75/d6e47/couple.png 250w,\n/static/f1c2b97eb13574766d32aacd28ee9c75/0853f/couple.png 500w,\n/static/f1c2b97eb13574766d32aacd28ee9c75/ce627/couple.png 750w,\n/static/f1c2b97eb13574766d32aacd28ee9c75/9dbcf/couple.png 1000w,\n/static/f1c2b97eb13574766d32aacd28ee9c75/87046/couple.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1031px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6b51daad90009cb69b9edc04b133994d/23592/tcp.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlklEQVQY042QSw4DIQxDuf9Zp6IzfJMw0KemYtFFVWEEcbBjEe55/4kuvbbqKLW03gI7PuNcC/wW55Jt2LgHdzWlDGzErdeUk5jup3NNx2aYRsn78zq5UAbCcIjJ8ThEFRZvgLewTL0ELiYzevcKn5kq+G0BgIxnTDnrMGeudH3H5sAMyhve89iLj5i6k78/rDAQoET1AsSWX4lcrCKoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"tcp\"\n        title=\"tcp\"\n        src=\"/static/6b51daad90009cb69b9edc04b133994d/23592/tcp.png\"\n        srcset=\"/static/6b51daad90009cb69b9edc04b133994d/5a46d/tcp.png 300w,\n/static/6b51daad90009cb69b9edc04b133994d/0a47e/tcp.png 600w,\n/static/6b51daad90009cb69b9edc04b133994d/23592/tcp.png 1031w\"\n        sizes=\"(max-width: 1031px) 100vw, 1031px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>有图可知，由于 HTTP 只有请求和响应的概念，信道连接需要通过 TCP 来完成的，因此让我们先来谈谈 TCP 的三次握手和四次分手吧</p>\n</blockquote>\n<h2 id=\"三次握手\" style=\"position:relative;\"><a href=\"#%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B\" aria-label=\"三次握手 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>三次握手</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 543px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a98fd5b57c7cb69e93dd4c06df8f1eee/fcee8/3times.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFAv/EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAGi6o4jJNFD/8QAGRAAAgMBAAAAAAAAAAAAAAAAAQIAAxET/9oACAEBAAEFAqie0RmypSLYiHP/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwEn/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAECMf/aAAgBAgEBPwG2pf/EABsQAAIBBQAAAAAAAAAAAAAAAAABEAIDETFR/9oACAEBAAY/ArmW42yt9hn/xAAdEAADAAICAwAAAAAAAAAAAAAAARExUSFBYZHR/9oACAEBAAE/IWEMLpXyeyxc2xppPo52L0mT/9oADAMBAAIAAwAAABCEL//EABcRAAMBAAAAAAAAAAAAAAAAAAABETH/2gAIAQMBAT8QyKw//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8QUV//xAAbEAEAAwADAQAAAAAAAAAAAAABABEhMVFh8f/aAAgBAQABPxA+BWxIa46glzre3q25REcsNU7ygfCCi23F88n/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3times\"\n        title=\"3times\"\n        src=\"/static/a98fd5b57c7cb69e93dd4c06df8f1eee/fcee8/3times.jpg\"\n        srcset=\"/static/a98fd5b57c7cb69e93dd4c06df8f1eee/f93b5/3times.jpg 300w,\n/static/a98fd5b57c7cb69e93dd4c06df8f1eee/fcee8/3times.jpg 543w\"\n        sizes=\"(max-width: 543px) 100vw, 543px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li>客户端首先要 SYN=1,表示要创建连接</li>\n<li>服务端接收到后，要告诉客户端：我接受到了！所以加个 ACK=1 表示确认跟客户端创建连接，因为 TCP 连接是双向的，然后还需要发送 SYN=1 表示我也想跟你连接</li>\n<li>理论上这时就创建连接成功（也就是半连接状态）了，但是要防止一个意外(也就是下面的为什么需要三次握手)，所以客户端要再发一个消息给服务端确认一下，这时只需要 ACK=1 就行了</li>\n<li>三次握手完成</li>\n</ol>\n<blockquote>\n<ul>\n<li>SYN：代表请求创建连接，所以在三次握手中前两次要 SYN=1，表示这两次用于建立连接；</li>\n<li>ACK：代表确认接受，不管是三次握手还是四次分手，在回应的时候都会加上 ACK=1，表示消息接收到了，并且在建立连接以后的发送数据时，都需加上 ACK=1,来表示数据接收成功；</li>\n<li>seq：序列号，什么意思呢？当发送一个数据时，数据是被拆成多个数据包来发送，序列号就是对每个数据包进行编号，这样接受方才能对数据包进行再次拼接。初始序列号是随机生成的，这样不一样的数据拆包解包就不会连接错了。（例如：两个数据都被拆成 1，2，3 和一个数据是 1，2，3 一个是 101，102，103，很明显后者不会连接错误）</li>\n<li>ack:这个代表下一个数据包的编号，这也就是为什么第二请求时，ack 是 seq+1，</li>\n<li>\n<p>为什么需要三次握手？</p>\n<ul>\n<li>如果一个连接请求在网络中跑的慢，超时了，这时客户端会重发请求，但是这个跑的慢的请求最后还是跑到了，然后服务端就接收了两个连接请求，然后全部回应就会创建两个连接，浪费资源！如果加了第三次客户端确认，服务端在接受到一个客户端连接确认请求后，后面再接收到的连接确认请求就可以抛弃不管了。<br /></li>\n<li>还有一个原因是：因为 TCP 连接时双向的，所以不仅需要连接客户端和服务端的单向连接，还需要连接服务端和客户端的单向连接，在第二次服务端发送了 SYN=1 请求连接的时候还需要客户端发送 ACK=1 来确认连接才能成功双向连接。</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"四次分手\" style=\"position:relative;\"><a href=\"#%E5%9B%9B%E6%AC%A1%E5%88%86%E6%89%8B\" aria-label=\"四次分手 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>四次分手</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 564px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/263613d85ce82dc31dc9281013861de6/7723c/4times.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAADBf/EABYBAQEBAAAAAAAAAAAAAAAAAAECA//aAAwDAQACEAMQAAAB6aRsQNnaT//EABkQAAIDAQAAAAAAAAAAAAAAAAABAgMRBP/aAAgBAQABBQKicpCelds2ufUIqTz/xAAWEQEBAQAAAAAAAAAAAAAAAAAAATH/2gAIAQMBAT8BmI//xAAYEQACAwAAAAAAAAAAAAAAAAAAAQIRMf/aAAgBAgEBPwGWjo//xAAbEAABBAMAAAAAAAAAAAAAAAAAAQIRMRIhQf/aAAgBAQAGPwJ2Slm1HzNnSlP/xAAcEAACAgIDAAAAAAAAAAAAAAAAARExIVFBcYH/2gAIAQEAAT8htZDhYE0kMb5NC4BOg0qvRLzZo//aAAwDAQACAAMAAAAQaA//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEDAQE/ENhnD//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAgEBPxDIwhq//8QAGhABAQEBAQEBAAAAAAAAAAAAAREhADFBwf/aAAgBAQABPxATxPAQ3jlLSXPT51taMMGQ47SCVFN5WwKmJ+cCeblXkO//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"4times\"\n        title=\"4times\"\n        src=\"/static/263613d85ce82dc31dc9281013861de6/7723c/4times.jpg\"\n        srcset=\"/static/263613d85ce82dc31dc9281013861de6/f93b5/4times.jpg 300w,\n/static/263613d85ce82dc31dc9281013861de6/7723c/4times.jpg 564w\"\n        sizes=\"(max-width: 564px) 100vw, 564px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li>首先客户端请求关闭客户端到服务端方向的连接，这时客户端就要发送一个 FIN=1，表示要关闭一个方向的连接（见上面四次分手的图）</li>\n<li>服务端接收到后是需要确认一下的，所以返回了一个 ACK=1,现在处于半关闭状态，服务端还可以发送数据给客户端（关闭了客户端向服务端发送数据的信道，但 TCB 还未销毁，仍可发送 ACK）</li>\n<li>这时只关闭了 TCP 一个方向，另一个方向也需要关闭,如果服务端没有数据发送给客户端了，服务端也向客户端发了一个 FIN=1 ,ACK=1，当然也要有 seq 和 ack</li>\n<li>客户端接收到后发送 ACK=1，表示接受成功</li>\n<li>服务端接收到客户端发来的 ACK=1 后关闭 TCP 连接，销毁 TCB（什么是 TCB 见下）</li>\n<li>客户端等到 2MSL 后再销毁 TCB（什么是 2MSL 见下）</li>\n<li>四次分手完成！</li>\n</ol>\n<blockquote>\n<ul>\n<li>FIN：表示请求关闭连接，在四次分手时，我们发现 FIN 发了两遍。这是因为 TCP 的连接是双向的，所以一次 FIN 只能关闭一个方向。</li>\n<li><strong>注意</strong>：TCB 传输控制块是客户端和服务端在请求连接和关闭连接时都会生成的，在请求连接成功和关闭连接成功时销毁，ACK，ack，FIN，seq 等通过 TCB 发送给对方。</li>\n<li>\n<p>为什么客户端需要等到 2MSL 后才能关闭？</p>\n<ul>\n<li>服务端在要分手的时候，如果由于某些网络原因没有收到客户端说的确认，那么它会再说一次分手，也就是重发 FIN，如果客户端在说完确认之后就关闭了 TCP 连接，那么服务端是不知道客户端到底能不能和它和平分手的，那么它的端口就一直不能关闭，所以需要客户端等待 2MSL 再关闭 TCP 连接。</li>\n</ul>\n</li>\n<li>\n<p>为什么需要四次分手？</p>\n<ul>\n<li>TCP 是双向的，所以需要在两个方向分别关闭，每个方向的关闭又需要请求和确认，所以一共就 4 次。</li>\n</ul>\n</li>\n<li>\n<p>为什么服务端不一起发送 FIN 和 ACK 呢？这样才三次握手</p>\n<ul>\n<li>客户端说了分手之后，它还是可以接受数据的，只是不能发送而已，如果只有三次握手，服务端在没有发完数据的情况下就关闭了 TCP，那么客户端得到的数据是不完整的，所以服务端需要在客户端请求关闭连接的时候第一次就发送 ACK 说我收到了，但是你再等等，我还有数据没有发完给你，等发完之后，才发送 FIN 关闭 TCP 连接。</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<blockquote>\n<ul>\n<li>此文章参考链接：<a href=\"https://baijiahao.baidu.com/s?id=1593714120815701015&#x26;wfr=spider&#x26;for=pc\">TCP 的三次握手和四次分手</a></li>\n<li>2MSL 解释：<a href=\"https://blog.csdn.net/zxx2096/article/details/80286577\">2MSL 是什么？</a></li>\n</ul>\n</blockquote>"},{"id":"2e144a77-4efe-56c4-b505-9226bc0af79b","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"计算机网络-子网划分","path":"/subnet","tags":["Network"],"excerpt":"子网划分的原理和知识点，来源慕课网","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAACt0lEQVQoz0WS2U8TURTGZ7kz03am7cyUWegybYepNAJlWmmBUCy0YlgFJQpoJVEQUo1ADERigJjI5hOLiIkoJmgE5IFojGCiicHlgfBkJPEfkWdvB8TzdO93zu/ck3M/xERgPtYcdrEpTUxqksiY2krUG4ngxYhS4eVrg1K5wodlm55r87EWxW5iaQrgGI5hKIoiLtZc7GRrTkjJgJgIyJLd0qh702XawJnC6qCzKi+nO+ZN666kJkb8ko810RRBAAwGimGIbDO7eFoTrGHFkch3ujn6cnXkVnPF0vWqkabwYF3RYDI/E9e6UkU1JcG8HIahCIrAMSMQF0eHvGIkT46qUms04BNss/d6Fx/0z/RdetxTN5eunLyanBu+9nSiv7ej4aSTc/E22kQe0ohX4oJuoSEazDTF26si+Yr8/NHk548b7zaWnk0Prs6Pbm0uv12dn7rdMdzV3BIPOTkmSxuPI35njsTSBYpcXx5pTcVPl5f++L6z//vX7u7XnZ0PP/f3vmyvvh7vnbySWH8yljlfpTkYj8AZO0MRj+xgzITEMnrAVxEqKNFDb9bW/hwcrLx8MTTU19PdWaYHF++0b071fFqfHWiIxVVZFTkKYASEfW7JTpsoAugBb7QgYLVQC3MzW9tbLedqlxemcQDOlha2VYdfTdzcWxl52BxO+QUvzwg0ReEYEvaJfolFECSkuipDKjyUxWJ3+zOqR0631rsloVjzhPy578c7D74t3G85VavyKk/DNZtJgLgdVjMBIGOmSIm3YhiOopgnV1BEHroAWgGmFI4Za9RHL0Sddpq3kBIDJ8WzJsENEjWKstWQhrNiqM1CwnZQggpcD8xCkSQAAXAS3g09W43+C3D0+Rh0EQNRgCOGnuUBbIkfNjpGEBz/Dx/r8BshSwJwrAMcFhqWzvryCPkL+peGZ9ZH8rgAAAAASUVORK5CYII=","aspectRatio":1.5060240963855422,"src":"/static/3e9e92a8658157f3de441075de8873a5/0853f/concert.png","srcSet":"/static/3e9e92a8658157f3de441075de8873a5/14156/concert.png 125w,\n/static/3e9e92a8658157f3de441075de8873a5/d6e47/concert.png 250w,\n/static/3e9e92a8658157f3de441075de8873a5/0853f/concert.png 500w,\n/static/3e9e92a8658157f3de441075de8873a5/ce627/concert.png 750w,\n/static/3e9e92a8658157f3de441075de8873a5/9dbcf/concert.png 1000w,\n/static/3e9e92a8658157f3de441075de8873a5/87046/concert.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"网络部分：划分子网\" style=\"position:relative;\"><a href=\"#%E7%BD%91%E7%BB%9C%E9%83%A8%E5%88%86%EF%BC%9A%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91\" aria-label=\"网络部分：划分子网 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>网络部分：划分子网</h2>\n<p><a name=\"Nh8DI\"></a></p>\n<h2 id=\"主机部分：可以分配给-pc-的-ip-地址\" style=\"position:relative;\"><a href=\"#%E4%B8%BB%E6%9C%BA%E9%83%A8%E5%88%86%EF%BC%9A%E5%8F%AF%E4%BB%A5%E5%88%86%E9%85%8D%E7%BB%99-pc-%E7%9A%84-ip-%E5%9C%B0%E5%9D%80\" aria-label=\"主机部分：可以分配给 pc 的 ip 地址 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>主机部分：可以分配给 pc 的 ip 地址</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/215ccbbc8fb7c5b1779799a7ec27f210/f8915/net1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACI0lEQVQoz41T227TQBDNxyI+hE9AAoknnnmJeKmohIpI47QpIaU0pY3jxIlvqRO7ie+XtXcPY+fWhhdGOt6xvHM8c2amIY9GCJdLqG0JU+kC6vdzTM6+YdruQLvqQev+gNqS6jPwPIRRhCRJkKYZ4jhBGIYv0DAMA5WxMEK+WoMFAZjvEwIUcYzc2/iMLu/MpQQsiqt+cGwNXdNqR+D/LExy9NUlrmcuRk6CmS+g+SVYyWuWhq7r9UVelhCcQwixARd7f//DosDHpoS3n/v4+QScDFe4WQG/XI6s4NsMt4TPbUeys5L0ytceRBRipDu4MFM0bx7x+v0phqTE3UocCCsNheDQplOYho40juoPSZqDkeiMiFgQglN2NTmhM/Nxcq3hXHbRm2fo2/mB0CTCkO7e2SFu5z4Uj+G3FeHNhy/o9eWNHLuSSZKMGCXFwdlAR+t+jo7i4nLiIi/FllDX4FFEc+Cg+1hgQI27WpT4+meBIM5w3DGxBd+iIK0LftC6YVGZ1CS8endKuswxjoFbIjXSg56MsT1Kal6WZeTnyPP8H+0bc9OAHXF8koZoXspoyw5aqod7dxOg6waUkYLxeAJ5KEOdqBgrY5imVfvV6dE87sjrDNeMyiSh+0aAnu6jS766LuqMHu4f6sA4iuHTgPs06DENfLUt1VltR5qkdeYvxqYkHfhzjehREVqWhTVtkE/b4ywd2LaNJW3Kwl7U78cl/wXXmY1J9kutRAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/215ccbbc8fb7c5b1779799a7ec27f210/f8915/net1.png\"\n        srcset=\"/static/215ccbbc8fb7c5b1779799a7ec27f210/5a46d/net1.png 300w,\n/static/215ccbbc8fb7c5b1779799a7ec27f210/0a47e/net1.png 600w,\n/static/215ccbbc8fb7c5b1779799a7ec27f210/f8915/net1.png 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<p><a name=\"lNg98\"></a></p>\n<h2 id=\"掩码的作用主要是划分子网：\" style=\"position:relative;\"><a href=\"#%E6%8E%A9%E7%A0%81%E7%9A%84%E4%BD%9C%E7%94%A8%E4%B8%BB%E8%A6%81%E6%98%AF%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91%EF%BC%9A\" aria-label=\"掩码的作用主要是划分子网： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>掩码的作用主要是划分子网：</h2>\n<p><a name=\"E3IS8\"></a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">例如：192.168.1.1 的子网掩码是：255.255.255.0\n\n子网缺省表示：192.168.1.1/24(24 表示有 24 位网络位，如果划分了子网，该 c 类地址的网络位不为 24)</code></pre></div>\n<br />\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3f856c9a2c6ca3004d17aba275333e21/f8915/net2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVQ4y41TiW7aUBDk//+nUqVKrao2PYBADC0x+MQX2MjG2H42Pqe7D0KlKG3ypGHN4je7M7uMYs+HO7mHP3tAoCxhfPgI7d172F++ocgLiFJAiAuKongVo6FtUaUnQoqaElWcoDocICh2XSfRX+NbzqgrS1i2jfvZHLphwAsC7KIImq5DfVShKAtoGw2e6+F8PqOqKjRN8yLZMAwYNVkOyzAxI0K+uFbXWEiSDQwqsFlvsFws4ZM1yoOCyXiC1Wol5bWsjgpkWXZTQB1W+LVcYjqZyo6YbE7k459j3H29kwVUVYWzdeC6LhzHkbBMC0mSwPM82QgXkIT8IQqB4/F4qxbH8Q0H8pOlvuVIyUwSkWcpDeV0OiHwA4n9bo8wDBHuQyl3a29hmqaM7KelG7DJKtdxYVs2dsHu0iGvg+/7iMJISuALDJbIRByfwDL5MpNYugmbsL3mb4Q2TdikSjpNNacB8e6lxxQl2dDUDfJTJvMVeX0m5FmBkiwQuUByiJHQuwmtGNt28/D56foew3N/rrEmT+NPn1FsXeSajuP3H2hF+ddDubTkY0dVu3Mtn3t+pm46evGSo+91jZ7WpKcdbOiPwCS8ci0pGK4rIwlbWuycDBbkS2E7yNQNMs1A9vsR6XQOQbmCvBKujyo8/HfC/5T82mq8hKff/gD2ztt/biv08AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/3f856c9a2c6ca3004d17aba275333e21/f8915/net2.png\"\n        srcset=\"/static/3f856c9a2c6ca3004d17aba275333e21/5a46d/net2.png 300w,\n/static/3f856c9a2c6ca3004d17aba275333e21/0a47e/net2.png 600w,\n/static/3f856c9a2c6ca3004d17aba275333e21/f8915/net2.png 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a name=\"FN3Xs\"></a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">单播：点对点通信，一个发送者，一个接收者。\n\n&lt;a name=&quot;Qr4R3&quot;&gt;&lt;/a&gt;\n\n广播：路由器隔绝广播的传播。接收到的包的 mac 地址全是 f,ip 地址全是 1 的为广播通信。全网广播\n\n&lt;a name=&quot;aE4RA&quot;&gt;&lt;/a&gt;\n\n组播：一个组播源，多个组播接受者，组播的包只会发送到组播接受者去。充分利用了带宽。iptv</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c056dbc19313c4ac6aa0a5300e25b6fa/f8915/net3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1UlEQVQ4y51T32+TUBjlX/fBxFcT3/TBqA8mLnN7WVysRru17lcnKe3KbEthTu4tAaSDwuVy6RHawIDuQb3JlxDO9517ON9B0r7LUNvHUL+0cX3cgXrUgdZXMLcsEEJAKf2nkmLHxVI34PQHcAdXcJUhlibB/x4p8n1oug7RAFar1YP10Kni0tJ2cDWZIgiCNZim6QZsNObvC5zzBKkQCFmMGXVrpFL4ywRtfQb3gxLI2Qo1TWUv9zrYOTxHyiOMtFs8ftOqKZVExMAzz9Ik2VJVJfv0bYTL/hgs5oi4KAkCz8WqSvg3RoeOg/3WOWT5Go45x+IuRBKG8Lw79CakrhC5iswXY/4bUeajv/BB7QVYsESUDdmWCzrTy6G3B2d4/+EUzKJQRxM82+sWbPcKozjBo1ct3Iw1GGMdL959BdF0TNQpnjw/wK1hrmdEvpBEZLVZUJ5V+eKiXGhJyDnHUBmAZ5vLbyLTWamIZcPWzU8wx22GBTzzM45jCCHqhHkUPG+xbpoRB0932puGIipZ4+vdI3RPFAibYvfjGQ570+JL79ORB7sZVjfzsDccl7krcPmHCcO0188nl0N0e8pWrEqF239CpalCWqi1KMGcmGCM1S7Nzx/lFOPCF8LACAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/c056dbc19313c4ac6aa0a5300e25b6fa/f8915/net3.png\"\n        srcset=\"/static/c056dbc19313c4ac6aa0a5300e25b6fa/5a46d/net3.png 300w,\n/static/c056dbc19313c4ac6aa0a5300e25b6fa/0a47e/net3.png 600w,\n/static/c056dbc19313c4ac6aa0a5300e25b6fa/f8915/net3.png 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<p><a name=\"M3wO9\"></a></p>\n<h2 id=\"ip-地址的类型：\" style=\"position:relative;\"><a href=\"#ip-%E5%9C%B0%E5%9D%80%E7%9A%84%E7%B1%BB%E5%9E%8B%EF%BC%9A\" aria-label=\"ip 地址的类型： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IP 地址的类型：</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ad1493ce9aa03715447a9fcd663601e7/f8915/net4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACEElEQVQ4y6VTi27aQBDk/z+pUdUicABTGmwKIdjYGPw6P84GAsYYe7J3IW1plEpVTxr2nuOZ3aXF0xTOtxGMdgfL7j2WSg9Zlv0VeZ5/eNYCjWr/jIMX4BgyFFGE/xmtpqqQxwmy/R4xqQ2JMCL4no/F0wK6pkPXdUynU2y3W7k2DEOeGQsDs+kM7saVZE3TvCo8lyVSIjscDjgej1L6+XxGXde4XC4SYi4eVLQv90hIdYU4uyHc7XZQugrW6zUsy8agr4LznC7XKMszoZKxrpsPrQoyaVn8MMqdOlAxouJY5hOS2EfEPNjWguzYci5iwkLw/gAZWc3HGnbaBBW5koRXlZJQ2J3oE8znTzDNHjZuD56vSvj+EJ6nYuV06UNrMGcD13GwZRHq4vROpSTkKZfJFgm2LQdhECHwGRUmJDC5djcB8ozSwBhKcnTmGQrbRuF5Mpac/1Lo+z7aX9tke4gg0JAk30nNA2EsI0812lcRRyus+kMYyj0iw8SS3piUglWni5I65SehqCyjLwuEoUtFiqlFYmQ8pCaOsJPzAEVxuLF4IYsXivWflj3Xw92nOygdhSzPaD0n1QuMRm3qtwdSZ8JaamBRAJ/uuFRA5/MXZMMR5bF4XxTRsKZpYmU7RPQDSTolzMCzR6R8RkV7JOVjusewf37t05ze1NdWaX6LrbfF2zidqn/4ozU3ZGK8AA8+1pmpYnvmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/ad1493ce9aa03715447a9fcd663601e7/f8915/net4.png\"\n        srcset=\"/static/ad1493ce9aa03715447a9fcd663601e7/5a46d/net4.png 300w,\n/static/ad1493ce9aa03715447a9fcd663601e7/0a47e/net4.png 600w,\n/static/ad1493ce9aa03715447a9fcd663601e7/f8915/net4.png 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<p><a name=\"4O3qn\"></a></p>\n<h2 id=\"如何进行划分子网：向主机位借位\" style=\"position:relative;\"><a href=\"#%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91%EF%BC%9A%E5%90%91%E4%B8%BB%E6%9C%BA%E4%BD%8D%E5%80%9F%E4%BD%8D\" aria-label=\"如何进行划分子网：向主机位借位 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>如何进行划分子网：向主机位借位</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/34bb128a794908b4110562fbdbf8b9d2/f8915/net5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7klEQVQoz52SDW+aUBSG/f+/ZkuWZUmna+PatSoitlWr8ilYKehAQBDQZ9fbbEu6Jt12kif3HMh9733vOQ3zoo1+1sK6vMJTNZE3Mb9eEQUBuzwny7J/olGlGWWSUKUpdV5Q7XbUu5z/jcbLD6UQ3scxpThNxvH4i+Nf0Die9gjqLCWZTHA+fMR5955ls0V9OHAQ/37yMl4V7Og+HT3EsCfMjRmak6DZ3xkYa4bulttlimpHqM4WP0rJxc3ruqYsy1cPaJx9/kL7/AJDH2OZCo6lMhldShb2AMtQuNNa6NYd/fspg77KeDSm2+nieZ4U3u/3EvmGivmEakXYj3foXlfcxGC4mD/j6gzsGbfunNHTkuVmS5ps2aw3hGFIFEWsw7WsT0jBGzvm2kywVzpW6KOuQHELuosCzT8y9E91SU+wijKKfCetVVUl1z+63Gydc9luY1lTQQ93MUBTmyi9T3iuhm0p3A+FZefZsiYsT0Tzbq5vmD5MpXAhxi0XM3t620Z3vkTRA6zlLXO3I+wLq85MWBY4U1RzLJr0wP3KxVvHJGKkTvZ835eW4ygmDEJZF0Uhuty3+TZ4xDD7zIwRSgTqWrB5Xrt9j940pifyqDi8PdhBlBPEe7bphjiNCLKaMCt/E+eESSHzoqrfHPAfFjOHxWbtQX0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/34bb128a794908b4110562fbdbf8b9d2/f8915/net5.png\"\n        srcset=\"/static/34bb128a794908b4110562fbdbf8b9d2/5a46d/net5.png 300w,\n/static/34bb128a794908b4110562fbdbf8b9d2/0a47e/net5.png 600w,\n/static/34bb128a794908b4110562fbdbf8b9d2/f8915/net5.png 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 485px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7409c8b4318879dd58a2531833213ad8/44c61/net6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxUlEQVQ4y52TbU/iQBSF+f8/Qr9pyC6igrUYEUSaAglCqwlgtesq4mLbbF/se6fHmTESFd3ATnLbSef2zJNzZgqu58GcPuCmdYbrxin0loRxRYDWPMXv/jlupQ60owa0eh3XrTZ0ScbdQIVt23AcZ6kKoCM0LfyqHECvCrgVjzHZKuK+2cK8P4ChXuKh2cbVjxK0nyW+/tjrg2QZ+xV5nn+oAnv87/gstiSY0V2jKEIcx0jTlBfJCMIg5N/fer8SWgiyhvjZR56kGI1GKJfKqB2K2N/bR0fuQGpLKG4XURNrfMM3wW8JFwsk5xTGkwHTNDH/M+fGu46L6f0Us9nsg9B34zUU20VCKRlhtVLFbnkXO6UdnNOUe90elKGCxkkDSZKsJpjRxpx6xWI3DAOWZUHXdU7J5sxTz/VACFlNMPaeKWEARVEgHAi4UC/Q7XQhCiLGo/FSsv8aXJCkGfWQwHVdTuX7PqIw4l6y+fsAViN0PKSUcEi9EoXDRbr14zpURV0SXI2QHgmPXkOWsmM7vJ7YnPq6tmD416GEPgbDIT9/2pUGWZaxubGJyWTCG1kgaxESeiuCIIBF7zV7M++Yh8zLdQhfAEvVKmsELF0zAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/7409c8b4318879dd58a2531833213ad8/44c61/net6.png\"\n        srcset=\"/static/7409c8b4318879dd58a2531833213ad8/5a46d/net6.png 300w,\n/static/7409c8b4318879dd58a2531833213ad8/44c61/net6.png 485w\"\n        sizes=\"(max-width: 485px) 100vw, 485px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/47984ba61d2bc1a635cae0cdf992b15d/f8915/net7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1UlEQVQ4y51Ti27aMBTl/39kWrdvmFgZlNFq2kahARqaF6E8EpOHY+d5du0CAoFUrZaOfJ3rXB+fc93azEx4/QGYt0DR1JB5TpCQQkBK+d9olZxDhgxFkqISEmrdVBU+OlrZeoOQWIZTE9HcwnZsQO4inWya5iqujUOudfxwmnyHhfqxruszHA5qQSXLEikXWP8Zwv50A2a5WLsLOLYL+8XWcC0HNsFxXLCAIY1TJFFynIui2BekUZNmmSyw/fUbO7q+WG1gjcbo9froEwZk2v3Pewzat3j41sZqsYTIJHjCNVLS/6ygoivI1fXrCvZkBns8QUJGXbkrUNWo6EZ5XugiB6hr64KnIpfkcp5lyHmGijZdGPKOvkdTVKB6iAchRJxAZkIzKIsShWKyh1rnMj/Gh7Wg/dW+1bQp6lTm+TA/f8GStLJuvuJlOEL3Rw/dThd33Tv0KFaz0vO23UHn+xumxhSCvz2CMw05MYuIoUKw8PHqL+G5HnyKfTpMzaHKU48G2wAb6l+FHdtphiXpelZQUXYcB4+PI8yeTTyNn2AYBibGBMO/Q8zNuS6WJAnJkV9od6GhcimlzWEYIiNj1BXiONYMoigCpyfJGNOx6ojT13Fa9B8V/+WonK8/GAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/47984ba61d2bc1a635cae0cdf992b15d/f8915/net7.png\"\n        srcset=\"/static/47984ba61d2bc1a635cae0cdf992b15d/5a46d/net7.png 300w,\n/static/47984ba61d2bc1a635cae0cdf992b15d/0a47e/net7.png 600w,\n/static/47984ba61d2bc1a635cae0cdf992b15d/f8915/net7.png 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<p><a name=\"p36om\"></a></p>\n<h2 id=\"私有-ip-地址：\" style=\"position:relative;\"><a href=\"#%E7%A7%81%E6%9C%89-ip-%E5%9C%B0%E5%9D%80%EF%BC%9A\" aria-label=\"私有 ip 地址： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>私有 IP 地址：</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2bb98d87e8c495d1dc60ad4be131cbf5/f8915/net8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQoz51S226CQBD1/z+rTVq8IHJZraCCEusiNLZahIXo6c4YDLbxwU4ymZ3Lnp05sx1oqQ7fyLcpjtkHjtqWn1/4r3RwPiPf7TBbhJiHIYL5AokGJTnrHOnpdGLblt9+E+s0iW2yxViM8TaeYBlF8H0fnuvBHtl4fnrGyBoh8AN0jS4c24HwBIQQnJ8FM+z3+0uHDWAiE1hDC8arAc/zEK9iBiTg6dTnSwTkOA4Wegq5kZjox6kmCAJkWXYLWJYlpJScSPXISqmH+eOR23yQjcII63iN/JBjs97wmEQFdUPnRuW7hCoU6qq+cn3tsHGKooBru7AtWwMvsYpWEK6A2TdhvBgcp7w5MJnDNElvmrlsueXQ2ER+v9tnoHipeXQ89ntGD0PTYtBBb8DLoBpVqvuAZCtVMX9VVaGua7bkt5Vqmjh9qT+A9/7VI8to5AdLx/hFIWLurwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/2bb98d87e8c495d1dc60ad4be131cbf5/f8915/net8.png\"\n        srcset=\"/static/2bb98d87e8c495d1dc60ad4be131cbf5/5a46d/net8.png 300w,\n/static/2bb98d87e8c495d1dc60ad4be131cbf5/0a47e/net8.png 600w,\n/static/2bb98d87e8c495d1dc60ad4be131cbf5/f8915/net8.png 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 485px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7409c8b4318879dd58a2531833213ad8/44c61/net9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxUlEQVQ4y52TbU/iQBSF+f8/Qr9pyC6igrUYEUSaAglCqwlgtesq4mLbbF/se6fHmTESFd3ATnLbSef2zJNzZgqu58GcPuCmdYbrxin0loRxRYDWPMXv/jlupQ60owa0eh3XrTZ0ScbdQIVt23AcZ6kKoCM0LfyqHECvCrgVjzHZKuK+2cK8P4ChXuKh2cbVjxK0nyW+/tjrg2QZ+xV5nn+oAnv87/gstiSY0V2jKEIcx0jTlBfJCMIg5N/fer8SWgiyhvjZR56kGI1GKJfKqB2K2N/bR0fuQGpLKG4XURNrfMM3wW8JFwsk5xTGkwHTNDH/M+fGu46L6f0Us9nsg9B34zUU20VCKRlhtVLFbnkXO6UdnNOUe90elKGCxkkDSZKsJpjRxpx6xWI3DAOWZUHXdU7J5sxTz/VACFlNMPaeKWEARVEgHAi4UC/Q7XQhCiLGo/FSsv8aXJCkGfWQwHVdTuX7PqIw4l6y+fsAViN0PKSUcEi9EoXDRbr14zpURV0SXI2QHgmPXkOWsmM7vJ7YnPq6tmD416GEPgbDIT9/2pUGWZaxubGJyWTCG1kgaxESeiuCIIBF7zV7M++Yh8zLdQhfAEvVKmsELF0zAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/7409c8b4318879dd58a2531833213ad8/44c61/net9.png\"\n        srcset=\"/static/7409c8b4318879dd58a2531833213ad8/5a46d/net9.png 300w,\n/static/7409c8b4318879dd58a2531833213ad8/44c61/net9.png 485w\"\n        sizes=\"(max-width: 485px) 100vw, 485px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>"},{"id":"0dc9adc1-5ec9-5f1b-aa6a-91ce8470b627","headings":[{"depth":2},{"depth":2}],"frontmatter":{"title":"前端性能优化之回流和重绘","path":"/redraw","tags":["JavaScript"],"excerpt":"前端性能优化之回流和重绘","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJElEQVQozwEZA+b8AGVDL3ZQP4lhTJtvWah7Z6yAa76Re82fh9mpkOa+qNmyl9W/pvb697u8rp6YhqSejqqikL2wm7qrlbiqlABRLx5uRTKGWEWZalakc1+yg27JmIHdrJLltpvqwqvsybHs2MH9///Iy8Ccl4WknY2popG+s568rZW6rJUASSgZYjgne0o2j1xIonFct4hz1aWN6Lmg7sKq8Mu08dS/9ObZ////19rQnJeFoZqKq6SUwrajva6YvKyWAEQnGkklGWc4KnhDNYZPQZZdTsSJd+m6o/DJs/PUv/Tbyfft4////+Tm35+ciqCYiKukk8G2o76wmb2ulwCnb1pmHBxjBQtwCg95CxF8CA9zBw21Vlj20r/12sr24NL48ev////u8Oulo5GblIKnoZG9sqHBspy+r5gAklFCTQsJQQABRQYKUgsQZQ4TgQAM0j5N98668tS/68qt9+/l////9/j0raybl497o5yMu7Kjw7Wgvq+YAJJcSU8PDDYBBD0DBVIDBGQJDLUYKfhSY+S4oa2ajdS6qv78+v////v9+7a2p5WNep6Xhbu0o8W4o7+wmQCmb1ldKyFVCgxJAwVlCw2QDhWpDhjtR1jUoJHetKHw2Mv////////+//6+vrGTjHmknYvGv63GvKW+sJgAi1RFUxUSnCMlIA8PXhETnR0hgDIrqko/t4Ft57+t8dXI/v79////////xci+lI15oJiGvbalxbumvbCYADoGCjoGCkgCBk8FB1cKB2YoG5tkTap4XKppUOSvlPXXx/39/P///////8/Ty5aQfpWNeqihkMO6pruvlwA4HBQ5GRMzEQxCFg9TJRV9SzSdZ1CzgGi9hWvYnoDv1sL6/Pz////////Z3NWXkoGSiXaemIbCuKW7rpcAPy8YSSwcTy0dVjEiYzQhf044nGpTsX5lwo5y1p6C4sm09Pf0////////4ePcmJSEj4d0mJF/vrWjuq6XADgmE0EqF1k6KW5JN3FELo5dRqNuV7qDaNmihOeujuDIr+3w7P///////+Xn4JqXiI2FcpGKeLiwnrqulaUlv3RaB75BAAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/87fda446656eadb4e66da3852be9cdc0/0853f/child.png","srcSet":"/static/87fda446656eadb4e66da3852be9cdc0/14156/child.png 125w,\n/static/87fda446656eadb4e66da3852be9cdc0/d6e47/child.png 250w,\n/static/87fda446656eadb4e66da3852be9cdc0/0853f/child.png 500w,\n/static/87fda446656eadb4e66da3852be9cdc0/ce627/child.png 750w,\n/static/87fda446656eadb4e66da3852be9cdc0/9dbcf/child.png 1000w,\n/static/87fda446656eadb4e66da3852be9cdc0/87046/child.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"回流和重绘优化\" style=\"position:relative;\"><a href=\"#%E5%9B%9E%E6%B5%81%E5%92%8C%E9%87%8D%E7%BB%98%E4%BC%98%E5%8C%96\" aria-label=\"回流和重绘优化 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>回流和重绘优化</h2>\n<ol>\n<li>translate 替代 top 改变</li>\n<li>opacity 替代 visibility</li>\n<li>不要一条一条的修改 DOM 的样式，预先定义好 class，然后修改 DOM 的 className</li>\n<li>把 DOM 离线后修改，比如：先把 DOM 给 display:none（有一次 reflow），然后你修改 100 次，然后再把它显示出来</li>\n<li>不要把 DOM 节点的属性值放在一个循环里面当成循环里的变量</li>\n<li>不要使用 table 布局，可能一个很小的改动都会造成整个 table 的布局</li>\n<li>动画实现的速度选择</li>\n<li>对于动画新建图层</li>\n<li>启用 GPU 硬件加速</li>\n</ol>\n<h2 id=\"chrome-创建图层的的条件\" style=\"position:relative;\"><a href=\"#chrome-%E5%88%9B%E5%BB%BA%E5%9B%BE%E5%B1%82%E7%9A%84%E7%9A%84%E6%9D%A1%E4%BB%B6\" aria-label=\"chrome 创建图层的的条件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chrome 创建图层的的条件</h2>\n<blockquote>\n<p>图层的作用是让回流和重绘都在一个区域里进行，也就是硬件加速</p>\n</blockquote>\n<ol>\n<li>3D 或透视变换（prespective transform）CSS 属性</li>\n<li>使用加速视频解码的<code class=\"language-text\">&lt;video&gt;</code>节点</li>\n<li>拥有 3D（webGL）上下文或加速的 2D 上下文的<code class=\"language-text\">&lt;canvas&gt;</code>节点</li>\n<li>混合插件（如：flash）</li>\n<li>对自己的 opacity 做 CSS 动画或使用动画 webkit 变换的元素</li>\n<li>拥有加速 CSS 过滤器的元素</li>\n<li>元素有一个包含复合层的后代节点（一个元素拥有一个子元素，该子元素在自己的层里）</li>\n<li>元素有 z-index 较低且包含一个复合层的兄弟元素（换句话说就是该元素在复合层上面渲染）</li>\n</ol>"},{"id":"6e03c2e8-4be5-5000-b64d-272808c3eb69","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":4},{"depth":2},{"depth":2}],"frontmatter":{"title":"nginx 部署 react 项目","path":"/nginx-deployment","tags":["DevOps"],"excerpt":"nginx部署react单页面应用并实现静态文件下载","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADHUlEQVQozxXSS2/aBgAAYP+TaUsNfmEMBowxYGyMzcsmYCB1iGMgTeYIQsOrYaUkS2m2pU3TCW1LQpN02tZuU5s+tEp7tGqbNt1hrTQtx6mbpqpTD71Uk3bYbZv0/YQPeHLrzMPP6offdp9enfyk4S2GIYODdRY2Qkjea1U9cJFDSzxiSrZJHpNsI4PFxs6yWY44FBcKvP7zyatfb/92sHbjQ7UYtuQYJEPBWQoS4JES55iLUgUv2lCw2ZhNY8BmQb4+PDc4zm80ghvzQeD5Lzf/evX7H4/Xhh02Rx8ZdYFZt7USR+ujxFmdKbixwBvgDI91NbKaxI0o8/EJeX9LvbYirZteYH+n+OLny69fHj77cfPW+ezlvnJjNfFot/DTp9pJhYyCIPcmeCyE/7AeuVAN7Pak7wfSxRa9OE4YHArs75YfDrMvDq/+8/fL54/6T7+cvD/MPdhSr/QkjURTGJSAIRG0fGBQt8+F7wySdy7Ev+j6O3kiTcLAwbZ2dyAfbI8/e7B6b0vbOeHf7nDfrccvLUSLjENGobQdjYDWEuf56kzym+XUXjt8qcsNZqmTmgO42AxsN33np8kri/znPeFaP7K3Iuy9H9/s5FtZdk5mjo8GaqlARfF3J4WeIa1VgxvvcO9VvB3NDpQ4eD4JL6jYZtXz9buRYTO4OuVemRbKkn8i5Dpdlk7pQkfjSwI1E6NrGWY561niHXXJbaZdQNJuKbNQMWCtiMhywd5I2cocumSEa2m+lhFO6WIrH2qP8RXZPxPzzsfIRRI3bVjNR6xOs0AAtIw6LWnSMu6DWil0XkbbKtmfEvvHEj0j2siwVYWpq2xDZWcTdDGE626sHSI+iruXxpyAGcNLHGKw0DgDmSJSDEF61FaOuqpJ2kz4ZuP0/2RfSaRyNG4INs2P6TikU2ghhAKnJ5x1xbaQwd8WUDOC1FO2WpqMELDswTWWnBIpnXcdpZ0KirFW8L98RwPIBIekPZDqgYA5hVCcUCNFnJ12tTJ4WyWaOTJHIR7wyNgIUsPtERwRISj6ljUIgiJqSTmhAoPkaThBWP8Fw/saak00bPoAAAAASUVORK5CYII=","aspectRatio":1.5060240963855422,"src":"/static/073fbe2ee018008edad106e739f88045/0853f/easter.png","srcSet":"/static/073fbe2ee018008edad106e739f88045/14156/easter.png 125w,\n/static/073fbe2ee018008edad106e739f88045/d6e47/easter.png 250w,\n/static/073fbe2ee018008edad106e739f88045/0853f/easter.png 500w,\n/static/073fbe2ee018008edad106e739f88045/ce627/easter.png 750w,\n/static/073fbe2ee018008edad106e739f88045/9dbcf/easter.png 1000w,\n/static/073fbe2ee018008edad106e739f88045/87046/easter.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<blockquote>\n<p>我用的是 create-react-app 在 nginx 上部署的前端项目，并使用 nginx 实现了下载文件的功能</p>\n</blockquote>\n<h2 id=\"nginx-的根目录是usrshare\" style=\"position:relative;\"><a href=\"#nginx-%E7%9A%84%E6%A0%B9%E7%9B%AE%E5%BD%95%E6%98%AFusrshare\" aria-label=\"nginx 的根目录是usrshare permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nginx 的根目录是/usr/share</h2>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre class=\"language-nginx\"><code class=\"language-nginx\"><span class=\"token keyword\">location</span> <span class=\"token operator\">/</span>pkg<span class=\"token operator\">/</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">-</span>f <span class=\"token variable\">$request_filename</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">404</span> <span class=\"token string\">'文件不存在'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># 可以看到，下载升级包的页面路径是/upgrade</span>\n<span class=\"token keyword\">location</span> <span class=\"token operator\">/</span>upgrade <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try_files</span> <span class=\"token variable\">$uri</span> <span class=\"token variable\">$uri</span><span class=\"token operator\">/</span> <span class=\"token operator\">/</span>upgrade<span class=\"token operator\">/</span><span class=\"token keyword\">index</span><span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a name=\"k0wDy\"></a></p>\n<h2 id=\"项目部署上线结果白屏问题\" style=\"position:relative;\"><a href=\"#%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E4%B8%8A%E7%BA%BF%E7%BB%93%E6%9E%9C%E7%99%BD%E5%B1%8F%E9%97%AE%E9%A2%98\" aria-label=\"项目部署上线结果白屏问题 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>项目部署上线结果白屏问题</h2>\n<ol>\n<li>react 项目配置页面路由的 basename(前端路由的/等于 nginx 的根目录/use/share)</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Router</span></span> <span class=\"token attr-name\">basename</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/upgrade<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Switch</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">exact</span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Main</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Route</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">exact</span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/404<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NotFoundPage</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Route</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NotFoundPage</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Route</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Switch</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Router</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"2\">\n<li>pakage.json 中配置</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"homepage\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/upgrade\"</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>如果是 webpack 而不是脚手架 create-react-app,则配置 publicPath,目的是让 html 中引用的 js,css 文件的路径是以/upgrade 开头的，那么路由就可以找到他们了，homepage 只会影响项目中引用的静态资源的路径</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/upgrade/static/js/2.c8c300b5.chunk.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/upgrade/static/js/main.529d8b95.chunk.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><a name=\"ztjd1\"></a></p>\n<h4 id=\"需求：前端实现下载文件，如果文件不存在则使用-react-router-跳转到-404-页面\" style=\"position:relative;\"><a href=\"#%E9%9C%80%E6%B1%82%EF%BC%9A%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%96%87%E4%BB%B6%E4%B8%8D%E5%AD%98%E5%9C%A8%E5%88%99%E4%BD%BF%E7%94%A8-react-router-%E8%B7%B3%E8%BD%AC%E5%88%B0-404-%E9%A1%B5%E9%9D%A2\" aria-label=\"需求：前端实现下载文件，如果文件不存在则使用 react router 跳转到 404 页面 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>需求：前端实现下载文件，如果文件不存在则使用 react-router 跳转到 404 页面</h4>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// head请求文件是否存在，如果存在才创建a标签触发浏览器的下载行为</span>\naxios<span class=\"token punctuation\">.</span><span class=\"token function\">head</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">validateStatus</span><span class=\"token operator\">:</span> <span class=\"token parameter\">status</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status <span class=\"token operator\">>=</span> <span class=\"token number\">200</span> <span class=\"token operator\">&amp;&amp;</span> status <span class=\"token operator\">&lt;</span> <span class=\"token number\">300</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span>\n      a<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> path\n      a<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">\"none\"</span>\n      a<span class=\"token punctuation\">.</span>rel <span class=\"token operator\">=</span> <span class=\"token string\">\"noopener noreferrer\"</span>\n      a<span class=\"token punctuation\">.</span>target <span class=\"token operator\">=</span> <span class=\"token string\">\"_blank\"</span>\n      a<span class=\"token punctuation\">.</span>download <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>key<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.pkg</span><span class=\"token template-punctuation string\">`</span></span>\n      a<span class=\"token punctuation\">.</span>type <span class=\"token operator\">=</span> <span class=\"token string\">\"application/octet-stream\"</span>\n      document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n      a<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status <span class=\"token operator\">===</span> <span class=\"token number\">404</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      props<span class=\"token punctuation\">.</span>history<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/404\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><a name=\"YM84e\"></a></p>\n<h2 id=\"为什么使用-head-先请求一次？\" style=\"position:relative;\"><a href=\"#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-head-%E5%85%88%E8%AF%B7%E6%B1%82%E4%B8%80%E6%AC%A1%EF%BC%9F\" aria-label=\"为什么使用 head 先请求一次？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>为什么使用 head 先请求一次？</h2>\n<p><strong>HTTP <code class=\"language-text\">HEAD</code> 方法</strong> 请求资源的头部信息, 并且这些头部与 HTTP <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/GET\"><code class=\"language-text\">GET</code></a> 方法请求时返回的一致. 该请求方法的一个使用场景是在下载一个大文件前先获取其大小再决定是否要下载, 以此可以节约带宽资源.</p>\n<p><a name=\"hzhvb\"></a></p>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://blog.csdn.net/jingtian678/article/details/90239919\">HashRouter 和 BrowserRouter 的区别</a></li>\n<li><a href=\"https://www.thinktxt.com/react/2017/02/26/react-router-browserHistory-refresh-404-solution.html\">React-Router browserHistory 浏览器刷新出现页面 404 解决方案</a></li>\n<li><a href=\"https://segmentfault.com/a/1190000023327242\">create-react-app 一些常用的自定义配置</a></li>\n</ul>"},{"id":"f0bee727-cb38-5774-a97b-3b8c4bf028bf","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":2}],"frontmatter":{"title":"react性能优化之代码分割","path":"/code-spliting","tags":["React"],"excerpt":"react性能优化之代码分割动态导入","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJElEQVQozwEZA+b8AEl3lk5+oWqUtpCrxp6wyKO0yaS2zIupx3qgwmSRt0uCqlSFq6a4zpOpwouhvZGiwEhvmStagyhUeihNbwBCbY1Hd5lPfqBqkLCWrMOywtS3yduDqMlxm79jkrdWhqtylrWZrMStucuirsSOoL1jgalNcZtJaY9MaY4AKUdeOF59a4ypi6W9k63CeZ25aZa4VIuxVYitWoirZIipb4yqnau8s7jGeIqnXnaaVXGXU3GXSWeMNVFyAERbcFRuh4ietbG/zai4x3STrFmDokl3lk12lGaFno6crqSosLOztqakp4aJlYqQnqCfq3V4iWJqgVlgdQCSo7Oyu8fJztTV2dzS1trO09jFzNO5wMekrLaVnqaho6e4s67a0cjr4djm29Lr49z07enbz8jDta7Kv7sAn6mwsbi9wMPFycvM09PT397b4N/b393Z3dzZ19TP0svF08rCw7mxwriu0MfBx7uxyruwyryzsqeitq2qAE5ZYlpodXGCkn6OnIWUooaXpYSYqISWpnmFkH2FjoCDiXt6fGNhZFJTVVtbXV9gX2xpZ11bXVNXXEdJTgAnMThBUF1KV2NXYWpnbHNlcn1icoFpe45bbIBNV2Y2OkFFSU9ZX2dYXWRLU1pHTVNNUVg3O0EsLjI7QUgAKzU8PUhRNz0/QUhKS05PR0hIU15jSFBWX216ZnaKNTpBMzc8Q0hNVl1jV1xhRktRNTc5GhobFxcXFRYVACAmKy02PUlUXGFudltoblJcYGZxd2Vrb11gYFxka1lhaEJFRjk6OVlbXmtucVJXXFBVW0JHTTc9RS0zOAAaHSAoLzQzO0I6Q0tGT1RgaXB2f4ZweoBye4F7goaFiY1MS00uMDQ+QUQ8QEVIS09oam9dYGhIUFo5Q00AHSAjICUqKS81QkZOXF9lbGxyY2JpYmRpaGpvdnd8b21xSElNU1VaY2RpW1pef3p7rqejmZKRcW5xTk1UABgZHBocIBweISEiJDU1OTs6PkxKUE1MUFFPU1hUWFxaXV5dYWxrboB/gYaDhJOPjpCNjYiCg3NtcVpUWyR3cmNMxJPGAAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/194ac1e7e3b229f5476b4f73c92ffbdf/0853f/sea.png","srcSet":"/static/194ac1e7e3b229f5476b4f73c92ffbdf/14156/sea.png 125w,\n/static/194ac1e7e3b229f5476b4f73c92ffbdf/d6e47/sea.png 250w,\n/static/194ac1e7e3b229f5476b4f73c92ffbdf/0853f/sea.png 500w,\n/static/194ac1e7e3b229f5476b4f73c92ffbdf/ce627/sea.png 750w,\n/static/194ac1e7e3b229f5476b4f73c92ffbdf/9dbcf/sea.png 1000w,\n/static/194ac1e7e3b229f5476b4f73c92ffbdf/87046/sea.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"引言\" style=\"position:relative;\"><a href=\"#%E5%BC%95%E8%A8%80\" aria-label=\"引言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>引言</h2>\n<blockquote>\n<p>衡量网站的性能的指标有很多，其中有项重要的指标就是网站的首屏时间，而代码分割却是优化首屏时间最通用的方法</p>\n</blockquote>\n<h2 id=\"三种通用的代码拆分方法（基于-webpack）\" style=\"position:relative;\"><a href=\"#%E4%B8%89%E7%A7%8D%E9%80%9A%E7%94%A8%E7%9A%84%E4%BB%A3%E7%A0%81%E6%8B%86%E5%88%86%E6%96%B9%E6%B3%95%EF%BC%88%E5%9F%BA%E4%BA%8E-webpack%EF%BC%89\" aria-label=\"三种通用的代码拆分方法（基于 webpack） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>三种通用的代码拆分方法（基于 webpack）</h2>\n<ol>\n<li>入口点：使用<a href=\"https://webpack.js.org/configuration/entry-context\"><code class=\"language-text\">entry</code></a>配置手动拆分代码</li>\n<li>防止重复：使用<a href=\"https://webpack.js.org/plugins/split-chunks-plugin/\"><code class=\"language-text\">SplitChunksPlugin</code></a>重复数据删除和拆分块</li>\n<li>动态导入：通过模块内的内联函数调用拆分代码</li>\n</ol>\n<h2 id=\"动态导入（react-loadable）有以下概念\" style=\"position:relative;\"><a href=\"#%E5%8A%A8%E6%80%81%E5%AF%BC%E5%85%A5%EF%BC%88react-loadable%EF%BC%89%E6%9C%89%E4%BB%A5%E4%B8%8B%E6%A6%82%E5%BF%B5\" aria-label=\"动态导入（react loadable）有以下概念 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>动态导入（<strong>react-loadable</strong>）有以下概念</h2>\n<blockquote>\n<ol>\n<li>动态导入的组件自动进行性能优异的代码分割</li>\n<li><strong>所支持的是组件的动态导入，而不是路由的动态导入</strong></li>\n<li>基本思想是组件的按需加载</li>\n<li>注意：要在 react 中使用 import()，需要安装@babel/plugin-syntax-dynamic-import 插件，并在 babel 配置中引入</li>\n<li>注意：import 的路径是相对路径，不能添加绝对路径</li>\n<li>注意：要使用魔法注释需要配置（webpack 的 SplitChunkPlugin 插件，webpack 默认已配置，开箱即用）</li>\n<li>react 中的动态导入还有：react 原生 React.lazy（v16.6），原生 Suspense，库 Loadable Component</li>\n</ol>\n</blockquote>\n<p><a name=\"xRYgO\"></a></p>\n<h2 id=\"实现\" style=\"position:relative;\"><a href=\"#%E5%AE%9E%E7%8E%B0\" aria-label=\"实现 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>实现</h2>\n<h3 id=\"配合-react-router-dom-实现-react-的路由组件按需加载\" style=\"position:relative;\"><a href=\"#%E9%85%8D%E5%90%88-react-router-dom-%E5%AE%9E%E7%8E%B0-react-%E7%9A%84%E8%B7%AF%E7%94%B1%E7%BB%84%E4%BB%B6%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD\" aria-label=\"配合 react router dom 实现 react 的路由组件按需加载 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>配合 react-router-dom 实现 react 的路由组件按需加载</h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> Loadable <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-loadable\"</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 懒加载路由</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">AsyncComponent</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">component</span> <span class=\"token operator\">=></span>\n  <span class=\"token function\">Loadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    loader<span class=\"token operator\">:</span> lazyLoad<span class=\"token punctuation\">[</span>component<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 加载promise来加载组件</span>\n    loading<span class=\"token operator\">:</span> MyLoadingComponent<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 当加载进行中或者错误时加载的组件</span>\n    delay<span class=\"token operator\">:</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 加载loading组件之前的延迟，防止闪屏</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> lazyLoad <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">home</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    <span class=\"token comment\">// webpackChunkName（代码分割后的代码块名）</span>\n  \t<span class=\"token comment\">// 添加webpackPrefetch：（未来可能需要的资源）</span>\n  \t<span class=\"token comment\">//   这将导致将&lt;link rel=\"prefetch\" href=\"home.js\">其附加在页面的开头</span>\n    <span class=\"token comment\">//   这将指示浏览器在空闲时间预取home.js文件</span>\n    <span class=\"token comment\">// 不配置预加载和预取提取则按需加载</span>\n    <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* webpackChunkName: \"home\" */</span> <span class=\"token comment\">/* webpackPrefetch: true */</span> <span class=\"token string\">'./home'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">detail</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  \t<span class=\"token comment\">// webpackPreload（当前导航期间可能需要的资源）</span>\n    <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* webpackChunkName: \"detail\" /* webpackPreload: true */</span>  <span class=\"token operator\">*</span><span class=\"token operator\">/</span> <span class=\"token string\">'./detail'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Switch</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/app/home<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">component</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">AsyncComponent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"home\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/app/detail<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">component</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">AsyncComponent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"detail\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Switch</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://webpack.js.org/guides/code-splitting/\">webpack 代码分割官网</a></li>\n<li><a href=\"https://github.com/jamiebuilds/react-loadable#preloading\">react-loadable 仓库</a></li>\n<li><a href=\"https://webpack.js.org/api/module-methods/#import-1\">import()文档</a></li>\n<li><a href=\"https://zh-hans.reactjs.org/docs/code-splitting.html\">react 的 lazy 代码分割</a></li>\n</ul>"},{"id":"0f7de314-0120-518f-a104-d679ed063ce6","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"深入浅出nginx","path":"/nginx","tags":["DevOps"],"excerpt":"极客时间的nignx核心，个人学习笔记","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGElEQVQozw3S609ScQDG8fOftDYLOedwfufyOzfO4cABuYZBmJioIAiKFmlXzFyiYJGlpM2KWelsNnNlWStrWZlbs5VdzGzrslrpuqz1pllb7+J59X31vPogAOhwHKVJHUsTOh0GSB1JEhzEICTMqlK0cWMxhgEKCBKn2mTVYRJNCifxvJ4XJQa5nbdv8ThQjUZkAIlj64u0IgslnnUozES6rqLcG/GU7A17DFZJdRhls1GxqrJZlRVBURhk6XLZwoOsxEGOAVV+a+5IPJeNRcPOaG1pf8x9Jhlr87uG2usjtVuiQXdlhUswiIxAywbGpPLIowtNfz/PPJ7puzXZkx8InR2sPtkXiIT0namy3KFYc6V3oH3nnoS/LuyOx7wenyUWqz50YM/x7gMTJ+qQldmDv798/Pvxzr/Vdw+n07ub7Tu2+8I1UqSaS4TV+oC3tdHf0VpVUbOpvzd17lTf1NjZ4Xxudfnl4rUk8mHSu7bybG1l9dfrJz/fzX57Mz918WRNFUzU821xYzIcHMqkBw4HurprJ0Zy7+fuLcxM92ePnc5m2nfFkRej7h9P8i+u9C7eGF779Gr50c2e7vj4SLaxQe1pc+0PWAa7Ws6fD27f5QqFfMPdnddPZ2ZHk/UBO0GjyNyF5vlB9v6g8+n4jrmR0MJ0/uuHN9/fL6dbtzZFqESD6veDnUlhk89EMzIkQchjyyQ8zZHSQLkbWbp79dqJxFgqsDBaeqmLaImri/Mzfz4tv72ZWro3/vz+lH+b3uTaIEgUQ4ssR0ABLTHLwUp3pc+JtAQ2D6cahvbqp3vF/n10uUcTDcKxnobO6NbD+3ZnOlpYETIcWjBQ4MRAQAAcxYspVksyWqTWDc90+INexiJjEq+1mNjGmMvnpQUBiPw6Tih22EWnTQ8LF5AAFEVBFlCFIHiWQJxmnivAxLW4DqMILceSiSbn0XRVmZezlOhsVuC2806rXpShpIiqkdMbaE7CCqJJgCGQRDkapwBm0lMmiS7SaLT4BlHUmlUMxVDIErYSUpJpyVAwSKmKYDCykC9GC8PQ/2GFKYYlhDnDAAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/6c11eac41632db7b79638d863740f3ab/0853f/easter.png","srcSet":"/static/6c11eac41632db7b79638d863740f3ab/14156/easter.png 125w,\n/static/6c11eac41632db7b79638d863740f3ab/d6e47/easter.png 250w,\n/static/6c11eac41632db7b79638d863740f3ab/0853f/easter.png 500w,\n/static/6c11eac41632db7b79638d863740f3ab/ce627/easter.png 750w,\n/static/6c11eac41632db7b79638d863740f3ab/9dbcf/easter.png 1000w,\n/static/6c11eac41632db7b79638d863740f3ab/87046/easter.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<p><a name=\"a64a14c8\"></a></p>\n<h2 id=\"1-热部署：升级-nginx-到新的版本\" style=\"position:relative;\"><a href=\"#1-%E7%83%AD%E9%83%A8%E7%BD%B2%EF%BC%9A%E5%8D%87%E7%BA%A7-nginx-%E5%88%B0%E6%96%B0%E7%9A%84%E7%89%88%E6%9C%AC\" aria-label=\"1 热部署：升级 nginx 到新的版本 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 热部署：升级 nginx 到新的版本</h2>\n<ul>\n<li>也就是用新的 nginx 命令替换老的 nginx 命令即可，注意做好备份</li>\n<li>kill -RSR2  pid(nginx 的进程号) :发送消息给老的 master 进程，让后面的接口平滑的过渡到新的 nginx 进程中</li>\n<li>kill -WINCH pid :请优雅的关闭老的 woker 进程</li>\n<li>老的 master 进程会保留，可以重新 reload，保证可以版本回退</li>\n</ul>\n<p><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9533848abd9c6a4f1c74c652c3cce59a/2551b/nginx1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAACBv/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAWvG45OxH//EABYQAQEBAAAAAAAAAAAAAAAAAAQ0AP/aAAgBAQABBQIk+fUObNo//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAgMAAAAAAAAAAAAAAAAAAAEDEHH/2gAIAQEABj8CjymR5TP/xAAdEAAABQUAAAAAAAAAAAAAAAAAARFRsRAhYYHw/9oACAEBAAE/IdpcgjcJssUDkzV//9oADAMBAAIAAwAAABCwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQABAwUAAAAAAAAAAAAAAAEAESGhQVGBsfH/2gAIAQEAAT8QsU9SXwS8xquE04zvabTAJ//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx1\"\n        title=\"nginx1\"\n        src=\"/static/9533848abd9c6a4f1c74c652c3cce59a/2551b/nginx1.jpg\"\n        srcset=\"/static/9533848abd9c6a4f1c74c652c3cce59a/f93b5/nginx1.jpg 300w,\n/static/9533848abd9c6a4f1c74c652c3cce59a/b4294/nginx1.jpg 600w,\n/static/9533848abd9c6a4f1c74c652c3cce59a/2551b/nginx1.jpg 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<p><a name=\"fea20a4b\"></a></p>\n<h2 id=\"2-root-和-alias-的区别：\" style=\"position:relative;\"><a href=\"#2-root-%E5%92%8C-alias-%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9A\" aria-label=\"2 root 和 alias 的区别： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. root 和 alias 的区别：</h2>\n<ul>\n<li>root 会受 location 后面的字符串所影响，访问 location 路径会将 location 的路径添加到 root 后返回结合的路径资源给用户，</li>\n<li>而 alias 是不受字符串的影响，访问 location 就是访问的 alias 路径的资源</li>\n</ul>\n<p><a name=\"d1415702\"></a></p>\n<h2 id=\"3-nginx-的进程间是通过信号的方式进行通信\" style=\"position:relative;\"><a href=\"#3-nginx-%E7%9A%84%E8%BF%9B%E7%A8%8B%E9%97%B4%E6%98%AF%E9%80%9A%E8%BF%87%E4%BF%A1%E5%8F%B7%E7%9A%84%E6%96%B9%E5%BC%8F%E8%BF%9B%E8%A1%8C%E9%80%9A%E4%BF%A1\" aria-label=\"3 nginx 的进程间是通过信号的方式进行通信 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Nginx 的进程间是通过信号的方式进行通信</h2>\n<p><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/246a2bbf354ead9127689634cf59c462/2551b/nginx2.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAACBv/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAWtO05GzH//EABkQAAMAAwAAAAAAAAAAAAAAAAAENAIREv/aAAgBAQABBQJXHa/A/SnKO0f/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAbEAABBAMAAAAAAAAAAAAAAAAAAQIDcRAxkf/aAAgBAQAGPwKOjbui0R1hT//EAB0QAAEEAgMAAAAAAAAAAAAAAAEAESFhEDGBsfD/2gAIAQEAAT8hf5J5WtFGRF4dL0Xl/wD/2gAMAwEAAgADAAAAEJgP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qp//EABsQAQEAAgMBAAAAAAAAAAAAAAERAKEQITGx/9oACAEBAAE/ECFYPog9ZQDdwAYAbbYM3n1xoGf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx2\"\n        title=\"nginx2\"\n        src=\"/static/246a2bbf354ead9127689634cf59c462/2551b/nginx2.jpg\"\n        srcset=\"/static/246a2bbf354ead9127689634cf59c462/f93b5/nginx2.jpg 300w,\n/static/246a2bbf354ead9127689634cf59c462/b4294/nginx2.jpg 600w,\n/static/246a2bbf354ead9127689634cf59c462/2551b/nginx2.jpg 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<p><a name=\"910b6c3b\"></a></p>\n<h2 id=\"4指令合并规则\" style=\"position:relative;\"><a href=\"#4%E6%8C%87%E4%BB%A4%E5%90%88%E5%B9%B6%E8%A7%84%E5%88%99\" aria-label=\"4指令合并规则 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.指令合并规则</h2>\n<p><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f4f04e57b8c51921875c3c40d8f432c4/2551b/nginx3.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBv/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAb6U0GWFh//EABwQAAEDBQAAAAAAAAAAAAAAAAQAATQCAxEkM//aAAgBAQABBQIRtWnLo+SHFtovt//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EAB0QAAICAQUAAAAAAAAAAAAAAAABAhFxAzFRcoH/2gAIAQEABj8C08DuT3HXBDA+zPD/xAAeEAEAAQMFAQAAAAAAAAAAAAABABExYSFBUXHwsf/aAAgBAQABPyGqgo8O5mgNohdCUW6nuzLPTWfBP//aAAwDAQACAAMAAAAQiw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAdEAACAgEFAAAAAAAAAAAAAAABEQAhMRBBUaGx/9oACAEBAAE/EFWog0u3IiWDHQwBraH4FJJiOy9a8d//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx3\"\n        title=\"nginx3\"\n        src=\"/static/f4f04e57b8c51921875c3c40d8f432c4/2551b/nginx3.jpg\"\n        srcset=\"/static/f4f04e57b8c51921875c3c40d8f432c4/f93b5/nginx3.jpg 300w,\n/static/f4f04e57b8c51921875c3c40d8f432c4/b4294/nginx3.jpg 600w,\n/static/f4f04e57b8c51921875c3c40d8f432c4/2551b/nginx3.jpg 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<p><a name=\"b64cd4bf\"></a></p>\n<h2 id=\"5nginx-11-个阶段：\" style=\"position:relative;\"><a href=\"#5nginx-11-%E4%B8%AA%E9%98%B6%E6%AE%B5%EF%BC%9A\" aria-label=\"5nginx 11 个阶段： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.Nginx 11 个阶段：</h2>\n<ul>\n<li>除了 http 过滤模块和提供变量的模块外，其余模块必须经过这 11 个阶段</li>\n<li>一个阶段如果不把请求向下传递，下面的阶段是不会执行的</li>\n<li>前一个阶段的模块可以传递给他下下个阶段模块进行处理，那么下个阶段模块也就没法执行</li>\n</ul>\n<blockquote>\n<ul>\n<li>post_read:在读取了 http 头部后，在加工头部前</li>\n<li>server_rewrite:</li>\n<li>find_config:进行 location 的匹配</li>\n<li>post_rewrite:在 rewrite 之后</li>\n<li>pre_access:在访问到请求之前做连接或者请求数量的限制</li>\n<li>access:在访问时，比如说身份验证</li>\n<li>post_access:</li>\n<li>pre_content:发送响应之前执行的操作,比如让一个请求产生多个子请求</li>\n<li>content:响应阶段，比如反向代理</li>\n<li>log:日志记录阶段</li>\n</ul>\n</blockquote>\n<p><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d6ff5f16b0b18f1efabb4b1775b60e00/2551b/nginx4.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGgAAAQUBAAAAAAAAAAAAAAAAAAECAwQFBv/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAFIdm6nFjhf/8QAHBAAAQMFAAAAAAAAAAAAAAAAAQIDBAASIzM0/9oACAEBAAEFAmlYVOu3ySSuHy1L3f/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABYRAAMAAAAAAAAAAAAAAAAAAAEQIf/aAAgBAgEBPwERf//EAB8QAAIBAgcAAAAAAAAAAAAAAAABAgMQERIhMTJxgf/aAAgBAQAGPwKOr4jwlITe+VFPq3h//8QAHBAAAwABBQAAAAAAAAAAAAAAAAERgRAhYbHw/9oACAEBAAE/IYLnNkyLoSVGO1qPB7OdOof/2gAMAwEAAgADAAAAENTP/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAh/9oACAEDAQE/EDV//8QAFxEBAAMAAAAAAAAAAAAAAAAAARAhMf/aAAgBAgEBPxC5dj//xAAeEAABBAEFAAAAAAAAAAAAAAABABEhMXEQUWGhsf/aAAgBAQABPxAsWQg9r4J5fEDOEQgZEsncu49aWq//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx4\"\n        title=\"nginx4\"\n        src=\"/static/d6ff5f16b0b18f1efabb4b1775b60e00/2551b/nginx4.jpg\"\n        srcset=\"/static/d6ff5f16b0b18f1efabb4b1775b60e00/f93b5/nginx4.jpg 300w,\n/static/d6ff5f16b0b18f1efabb4b1775b60e00/b4294/nginx4.jpg 600w,\n/static/d6ff5f16b0b18f1efabb4b1775b60e00/2551b/nginx4.jpg 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br />\n<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/77ca5acb74ec4696397323dd0b9730ce/2551b/nginx5.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQDBQb/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAFqwUfMkRh//8QAGRABAAIDAAAAAAAAAAAAAAAABDM0ADFB/9oACAEBAAEFAjVt4+yODq5v/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGxAAAgEFAAAAAAAAAAAAAAAAAHEBAgMQIYH/2gAIAQEABj8Cto0SihY4f//EAB8QAQACAAYDAAAAAAAAAAAAAAEAESExQWFxscHh8P/aAAgBAQABPyFFFX7RwGqIWESmXE+/eeE6E//aAAwDAQACAAMAAAAQuM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhYRAxobH/2gAIAQEAAT8Qcs0t1tGmV2zTqIqFKrHCe/8AfN3/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx5\"\n        title=\"nginx5\"\n        src=\"/static/77ca5acb74ec4696397323dd0b9730ce/2551b/nginx5.jpg\"\n        srcset=\"/static/77ca5acb74ec4696397323dd0b9730ce/f93b5/nginx5.jpg 300w,\n/static/77ca5acb74ec4696397323dd0b9730ce/b4294/nginx5.jpg 600w,\n/static/77ca5acb74ec4696397323dd0b9730ce/2551b/nginx5.jpg 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<p><a name=\"0cd0d167\"></a></p>\n<h2 id=\"6-error_page-和-rewrite-阶段的-return-指令的区别：\" style=\"position:relative;\"><a href=\"#6-error_page-%E5%92%8C-rewrite-%E9%98%B6%E6%AE%B5%E7%9A%84-return-%E6%8C%87%E4%BB%A4%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9A\" aria-label=\"6 error_page 和 rewrite 阶段的 return 指令的区别： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. error_page 和 rewrite 阶段的 return 指令的区别：</h2>\n<ul>\n<li>return ：返回相应的状态码和注释</li>\n<li>error_page：根据相应的状态码返回相应的页面</li>\n<li>return 指令执行了 error_page 指令就不会执行<br />\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 722px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2b1bbf028a2078505765b4f690042eb4/d44c9/nginx6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdElEQVQoz4VSXUvDMBTd/xdffBFx+OKDMBH8ANEHXwRhwvYo+2B07bp17dqmbdo0aZKmHjc/Npx4uYTkJveec89NqyiY4648Px5N5g9P/Sim3jJeLKNubzAYu03TGGOajW02mR/aI8t20jRtlWWZUZYXZRRnlu0XjNOcIeIuwjDOamO0rpttU6JiQGRSyhbnvNm1DRQrRfv8sXP9fHx2f3X30uyzlhD8i5HZvqgq2e0NX/tjrNNZsD8ZyHVt8BT0wDMmlCSUC4lSSvIk8cKIoqnvlvckp1mhtbZsz7KXaF4pjSClRZIky4BAiEqqP5EBKHAvdVWpGue1TnDGRLAijhugaLBK5G6Jz2SS5JxXeAqd4VJqA+SckZS6ixUiQkgAoPT28Pao/TMUpYuCu/MQY0uzHPOPSeb50dTxgfdPMtjneWnP/LehA86D8WxieRHJFj45PDi6vOh8fBLQUEqZ32quwaEFZi4rhRUORRA/PWnfXt+8A/nvc7aMFnjSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx6\"\n        title=\"nginx6\"\n        src=\"/static/2b1bbf028a2078505765b4f690042eb4/d44c9/nginx6.png\"\n        srcset=\"/static/2b1bbf028a2078505765b4f690042eb4/5a46d/nginx6.png 300w,\n/static/2b1bbf028a2078505765b4f690042eb4/0a47e/nginx6.png 600w,\n/static/2b1bbf028a2078505765b4f690042eb4/d44c9/nginx6.png 722w\"\n        sizes=\"(max-width: 722px) 100vw, 722px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 722px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/600b6b3317b75ca09bc12d8268700df0/d44c9/nginx7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfklEQVQoz32S7U6DMBSGuXUTE2/DzOgFmOwW/LEf/jBz6KbuQ7YBBfrdUgrMF5hmajJy2pQe3p7nvDQwxmS5KKgI55uHSaiUTTNGMj55nE/DVZZzxhUXmmSsbdsDHkXYdhltd4LzwBhbUIn4WMXTcK1NmRAK/etbNJ0tn2bL1SZZvO+ewzVOYcLyNI0/t+vN3lobYBz+PUOROCleFlHdNDVGPyOqukGOMuV9fU6MdkCLI6Id2cc54NFU2zZIgaITA7s/sq4q7ypf+RrhnEepvODwgjJZIGjnC1JD40ex1oZxqXSptKVclc5rowRPnKvROQompJDSgBN2HD07qdwlgIScMSXAtLFSyaZp4aItnSsriEtXCWmsdX/FYPY9akfuqn7usAEspBZCA3jY+akMRnx2NOx785dhEFvbt0Ml0PpXB4OQ5dL4ujnnNsk5Lgk0We8cIs95SljB1Oj6bnw/DqyB+y3I25PqwxpN4j8hUlyblA7rJC3g4OXF1e3o5gs9E3NTgGmgaAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx7\"\n        title=\"nginx7\"\n        src=\"/static/600b6b3317b75ca09bc12d8268700df0/d44c9/nginx7.png\"\n        srcset=\"/static/600b6b3317b75ca09bc12d8268700df0/5a46d/nginx7.png 300w,\n/static/600b6b3317b75ca09bc12d8268700df0/0a47e/nginx7.png 600w,\n/static/600b6b3317b75ca09bc12d8268700df0/d44c9/nginx7.png 722w\"\n        sizes=\"(max-width: 722px) 100vw, 722px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></li>\n</ul>\n<p><a name=\"E3z7U\"></a></p>\n<h2 id=\"7if-语句1602255750004jpg\" style=\"position:relative;\"><a href=\"#7if-%E8%AF%AD%E5%8F%A51602255750004jpg\" aria-label=\"7if 语句1602255750004jpg permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7.if 语句<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIDBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHXZ4ksAD//xAAZEAACAwEAAAAAAAAAAAAAAAAQMQABAhH/2gAIAQEAAQUCcro2h//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABkQAAEFAAAAAAAAAAAAAAAAABEAASAiMf/aAAgBAQAGPwJ6gLY//8QAGhABAAMAAwAAAAAAAAAAAAAAAQARMSFBUf/aAAgBAQABPyFpnkWpssmjyYQO4FT/2gAMAwEAAgADAAAAEJQP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAAMAAgMAAAAAAAAAAAAAAQARITFRYXGx/9oACAEBAAE/EK0xCYMvDGtJBw0l3IXtILDy/GCAFEcqUKtfbP/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1602255750004.jpg\"\n        title=\"1602255750004.jpg\"\n        src=\"/static/81b5d8729748e5f3d6340c99eaac4e5f/2551b/nginx8.jpg\"\n        srcset=\"/static/81b5d8729748e5f3d6340c99eaac4e5f/f93b5/nginx8.jpg 300w,\n/static/81b5d8729748e5f3d6340c99eaac4e5f/b4294/nginx8.jpg 600w,\n/static/81b5d8729748e5f3d6340c99eaac4e5f/2551b/nginx8.jpg 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></h2>\n<p><a name=\"OaqOp\"></a></p>\n<h2 id=\"8反向代理和负载均衡：\" style=\"position:relative;\"><a href=\"#8%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E5%92%8C%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%EF%BC%9A\" aria-label=\"8反向代理和负载均衡： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8.反向代理和负载均衡：</h2>\n<p><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/26df677e65cb88cdfb9ce480c797d52c/2551b/nginx9.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB2yRUYrC//8QAGhAAAQUBAAAAAAAAAAAAAAAAAQACEBESQf/aAAgBAQABBQI0tT1xOv/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAAxASAy/9oACAEBAAY/AkZmjP/EABsQAAICAwEAAAAAAAAAAAAAAAERAFEQMZHR/9oACAEBAAE/IRA7l1AnjEKycIuz/9oADAMBAAIAAwAAABDMD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/EKf/xAAdEAEAAgICAwAAAAAAAAAAAAABABEhQRAxYcHw/9oACAEBAAE/EBTuml+5QAoDHxnicD01CGExgRon/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx9\"\n        title=\"nginx9\"\n        src=\"/static/26df677e65cb88cdfb9ce480c797d52c/2551b/nginx9.jpg\"\n        srcset=\"/static/26df677e65cb88cdfb9ce480c797d52c/f93b5/nginx9.jpg 300w,\n/static/26df677e65cb88cdfb9ce480c797d52c/b4294/nginx9.jpg 600w,\n/static/26df677e65cb88cdfb9ce480c797d52c/2551b/nginx9.jpg 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1098ea92b7653cf7947e088499ad2a64/2551b/nginx10.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEEAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHstxJSZA//xAAbEAEAAgIDAAAAAAAAAAAAAAABAAMEERIxMv/aAAgBAQABBQI2qMCyWeMTu1ef/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHRAAAgIBBQAAAAAAAAAAAAAAAAECESEiMXGBkf/aAAgBAQAGPwJ3CjThmXHwlwT6N2f/xAAcEAEAAwACAwAAAAAAAAAAAAABABEhMUFRYaH/2gAIAQEAAT8hYtQ4b5lBz5Emq1H1IlsV9mGwGdM//9oADAMBAAIAAwAAABA3L//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABYRAQEBAAAAAAAAAAAAAAAAABEQIf/aAAgBAgEBPxAxn//EABsQAQADAQADAAAAAAAAAAAAAAEAESFBYXHw/9oACAEBAAE/EBsu1D3yGJJoMHmGLReJx9cSMKJoeoMiGLGsZRjKYoT/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx10\"\n        title=\"nginx10\"\n        src=\"/static/1098ea92b7653cf7947e088499ad2a64/2551b/nginx10.jpg\"\n        srcset=\"/static/1098ea92b7653cf7947e088499ad2a64/f93b5/nginx10.jpg 300w,\n/static/1098ea92b7653cf7947e088499ad2a64/b4294/nginx10.jpg 600w,\n/static/1098ea92b7653cf7947e088499ad2a64/2551b/nginx10.jpg 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/17aacf7ac0c4be8ffd0ce1f8a423f445/2551b/nginx11.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMBAgQF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB6jKSjjOD/8QAGRABAQEAAwAAAAAAAAAAAAAAAQIAAyEz/9oACAEBAAEFAnurxr9eRdCp/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAgMBAQAAAAAAAAAAAAAAAAIBEUEhgf/aAAgBAQAGPwLRbmjPBBTsn//EABoQAQADAQEBAAAAAAAAAAAAAAEAESFBUTH/2gAIAQEAAT8hvjS3uRU3Uvsum9wRygmnYyU++z//2gAMAwEAAgADAAAAEBfv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAAAH/2gAIAQIBAT8QV//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQXHB0fH/2gAIAQEAAT8QRgAlDE9WY8zSBFUz7l6lZUqz7FBCu3qXsMm8DyRBlx2OCf/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx11\"\n        title=\"nginx11\"\n        src=\"/static/17aacf7ac0c4be8ffd0ce1f8a423f445/2551b/nginx11.jpg\"\n        srcset=\"/static/17aacf7ac0c4be8ffd0ce1f8a423f445/f93b5/nginx11.jpg 300w,\n/static/17aacf7ac0c4be8ffd0ce1f8a423f445/b4294/nginx11.jpg 600w,\n/static/17aacf7ac0c4be8ffd0ce1f8a423f445/2551b/nginx11.jpg 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c9a1b88c27176e8a441210635568fdf7/2551b/nginx12.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHYiwChIf/EABkQAQEAAwEAAAAAAAAAAAAAAAIBEBITIf/aAAgBAQABBQJeSNcxdjhqxf/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABsQAAICAwEAAAAAAAAAAAAAAAESABECEDFR/9oACAEBAAY/AiUuMhvyWcV32f/EABsQAQACAgMAAAAAAAAAAAAAAAEAERAhMVFh/9oACAEBAAE/IXTNHBrctaY83HuC6cpQQT//2gAMAwEAAgADAAAAEIsv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qp//EABsQAAMAAwEBAAAAAAAAAAAAAAERIQBBcRCx/9oACAEBAAE/ENHllXq/cLIcEzLq4InwkTfZ6IUEgODP/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nginx12\"\n        title=\"nginx12\"\n        src=\"/static/c9a1b88c27176e8a441210635568fdf7/2551b/nginx12.jpg\"\n        srcset=\"/static/c9a1b88c27176e8a441210635568fdf7/f93b5/nginx12.jpg 300w,\n/static/c9a1b88c27176e8a441210635568fdf7/b4294/nginx12.jpg 600w,\n/static/c9a1b88c27176e8a441210635568fdf7/2551b/nginx12.jpg 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>"},{"id":"b8cebd4b-095d-5296-8486-dbe90ac2be90","headings":[{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":3},{"depth":2}],"frontmatter":{"title":"在React项目中，如何优雅的优化长列表","path":"/virtual-list","tags":["React"],"excerpt":"react的长列表的优化方案-react-virtualized","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJElEQVQozwEZA+b8AE1ST3N9daWvpq+3sLzCvtbZ1sjMyLm+ur/Ev8/SztbX1MXJxauyrqOsqba9u7e+u7a8upylonF6dkdMSwBzenWLlIyyubK3vLa6v7vFysa1u7arsa2xtrLa3Nnp6ujR1NG2vLeqsa3M0M2+xMGVoJyUn5uVoJ1gaWYAwMa/xcrEys7Jx8rF0dPQ2t3a0NPQ3N7b4uThiIWBiISA4eLf0tXSyc7Jub66uL68lJ6amaOfprCugo2MAMrPyd/i3uPl4dXX09DTzubn5uzs6+3u7NfX1FVSSkxIP7m6tNPV0MzOyra7uK21s6mxrqatq5+pp3J8ewDBxsDV19Pa3Nnc3tnb3dng4d7n5+Tu7+3T09Bub2ZydGqztbC+w76prqqqsa6Sm5iRnJqYo6OMl5htd3cAsrexvsK9xsjF0dPQ3+De3+De1NfU4ePg5ebjhod+gYJ619jUzdDNoqqmnKakq7a3rrq8j5ydbHp7eoiIAJyjm6itqK6zr7vAvdTW1OHi39LU0c3QzLq8t4KCen5/d7W4s9ba17e9u7S+vq25u7K9v6SsrJihn5iinwB9g32oraXFyMHZ3NfQ1M/KzsjJzcfDxsKlqKGGhn6DhHx6fXbAwr/m6efU2NbS1tXg4+Hh4+DZ29bM0MgARElJVl1beoF8i4+Ki42Hf4F6mp6XqKymsrewm5yUnZ6Yj4+FqqykrK6ns7ezwMO+nJ2Wf4B5l5uSeoF6AEtRTFRcVjM1LSsrJDU0KTo3LDY1LlZXTnt4bXh1aoJ8a2FdUElHPjgxI1BJO1dPQUM6Kz82KEtDNzo2LQAoKSQtLihBPzM6OTAyMy09OS48OzA3Ni1jV0IzMCc0MCc2MykdGxYsKyYxLSVBOS1PRDdFPTErKCEiIBwAJCQgIyQfKSkjMzApTEQ3R0E1WVA+YFZDW1JCYlVBb19Igm1PgGxOfGhMYFM/RT4xPDcsOzguKCgkGxwbACcoIjg2K0tGNl1SP25dRXxpT4FvVHlpT3BiSm1gSW9hSHJgRnxmSIpyUI92U4JsTG5dQ1xRPT05LicnIdMWtzE9/lFiAAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/f9f9b2a1795030300fd5b848021e67e9/0853f/land.png","srcSet":"/static/f9f9b2a1795030300fd5b848021e67e9/14156/land.png 125w,\n/static/f9f9b2a1795030300fd5b848021e67e9/d6e47/land.png 250w,\n/static/f9f9b2a1795030300fd5b848021e67e9/0853f/land.png 500w,\n/static/f9f9b2a1795030300fd5b848021e67e9/ce627/land.png 750w,\n/static/f9f9b2a1795030300fd5b848021e67e9/9dbcf/land.png 1000w,\n/static/f9f9b2a1795030300fd5b848021e67e9/87046/land.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"一、虚拟列表优化长列表的原理\" style=\"position:relative;\"><a href=\"#%E4%B8%80%E3%80%81%E8%99%9A%E6%8B%9F%E5%88%97%E8%A1%A8%E4%BC%98%E5%8C%96%E9%95%BF%E5%88%97%E8%A1%A8%E7%9A%84%E5%8E%9F%E7%90%86\" aria-label=\"一、虚拟列表优化长列表的原理 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>一、虚拟列表优化长列表的原理</h2>\n<h3 id=\"优化长列表的原理很简单，基本原理可以一句话概括\" style=\"position:relative;\"><a href=\"#%E4%BC%98%E5%8C%96%E9%95%BF%E5%88%97%E8%A1%A8%E7%9A%84%E5%8E%9F%E7%90%86%E5%BE%88%E7%AE%80%E5%8D%95%EF%BC%8C%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E5%8F%AF%E4%BB%A5%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%A6%82%E6%8B%AC\" aria-label=\"优化长列表的原理很简单，基本原理可以一句话概括 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>优化长列表的原理很简单，基本原理可以一句话概括</h3>\n<blockquote>\n<p>用数组保存所有列表元素的位置，只渲染可视区内的列表元素，当可视区滚动时，根据滚动的 offset 大小以及所有列表元素的位置，计算在可视区应该渲染哪些元素。</p>\n</blockquote>\n<h3 id=\"具体实现步骤如下所示\" style=\"position:relative;\"><a href=\"#%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4%E5%A6%82%E4%B8%8B%E6%89%80%E7%A4%BA\" aria-label=\"具体实现步骤如下所示 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>具体实现步骤如下所示</h3>\n<ol>\n<li>首先确定长列表所在父元素的大小，父元素的大小决定了可视区的宽和高</li>\n<li>确定长列表每一个列表元素的宽和高，同时初始的条件下计算好长列表每一个元素相对于父元素的位置，并用一个数组来保存所有列表元素的位置信息</li>\n<li>首次渲染时，只展示相对于父元素可视区内的子列表元素，在滚动时，根据父元素的滚动的 offset 重新计算应该在可视区内的子列表元素。这样保证了无论如何滚动，真实渲染出的 dom 节点只有可视区内的列表元素。</li>\n<li>假设可视区内能展示 5 个子列表元素，及时长列表总共有 1000 个元素，但是每时每刻，真实渲染出来的 dom 节点只有 5 个。</li>\n<li>补充说明，这种情况下，父元素一般使用 position：relative，子元素的定位一般使用：position：absolute 或 sticky</li>\n</ol>\n<p><a name=\"PXTg1\"></a></p>\n<h2 id=\"二、通过-react-virtualized-来优化长列表\" style=\"position:relative;\"><a href=\"#%E4%BA%8C%E3%80%81%E9%80%9A%E8%BF%87-react-virtualized-%E6%9D%A5%E4%BC%98%E5%8C%96%E9%95%BF%E5%88%97%E8%A1%A8\" aria-label=\"二、通过 react virtualized 来优化长列表 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>二、通过 react-virtualized 来优化长列表</h2>\n<h3 id=\"react-virtualized-的基础组件包含：\" style=\"position:relative;\"><a href=\"#react-virtualized-%E7%9A%84%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6%E5%8C%85%E5%90%AB%EF%BC%9A\" aria-label=\"react virtualized 的基础组件包含： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>react-virtualized 的基础组件包含：</h3>\n<ul>\n<li>Grid：用于优化构建任意网状的结构，传入一个二维的数组，渲染出类似棋盘的结构。</li>\n<li>List：List 是基于 Grid 来实现的，但是是一个维的列表，而不是网状。</li>\n<li>Table：Table 也是基于 Grid 来实现，表格具有固定的头部，并且可以在垂直方向上滚动</li>\n<li>Masonry：同样可以在水平方向，也可以在垂直方向滚动，不同于 Grid 的是可以自定义每个元素的大小，或者子元素的大小也可以是动态变化的</li>\n<li>Collection：类似于瀑布流的形式，同样可以水平和垂直方向滚动。</li>\n</ul>\n<p><br />值得注意的是这些基础组件都是继承于 React 中的 PureComponent，因此当 state 变化的时候，只会做一个浅比较来确定重新渲染与否 。<br />\n<br />除了这几个基础组件外，react-virtualized 还提供了几个高阶组件，比如 ArrowKeyStepper 、AutoSizer、CellMeasurer、InfiniteLoader 等，本文具体介绍常用的 AutoSizer、CellMeasurer 和 InfiniteLoader。<br /></p>\n<ul>\n<li>AutoSizer：使用于一个子元素的情况，通过 AutoSizer 包含的子元素会根据父元素 Resize 的变化，自动调节该子元素的可视区的宽度和高度，同时调节的还有该子元素可视区真实渲染的 dom 元素的数目。(子元素会随父元素的长、宽自适应)</li>\n<li>CellMeasurer：这个高阶组件可以动态的改变子元素的高度，适用于提前不知道长列表中每一个子元素高度的情况。（会损耗性能，不建议使用）</li>\n<li>InfiniteLoader：这个高阶组件用于 Table 或者 List 的无限滚动，适用于滚动时异步请求等情况。（滚动加载）</li>\n</ul>\n<p><br />作者：yuxiaoliang<br />链接：<a href=\"https://juejin.cn/post/6844903729460674567\">https://juejin.cn/post/6844903729460674567</a><br />来源：掘金<br />著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。<br />\n<br /></p>\n<p><a name=\"t7LD9\"></a></p>\n<h2 id=\"三、vlist-的实际使用\" style=\"position:relative;\"><a href=\"#%E4%B8%89%E3%80%81vlist-%E7%9A%84%E5%AE%9E%E9%99%85%E4%BD%BF%E7%94%A8\" aria-label=\"三、vlist 的实际使用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>三、Vlist 的实际使用</h2>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">List</span></span> <span class=\"token attr-name\">loading</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>loading<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">bordered</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  // antd的List组件\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> height<span class=\"token operator\">:</span> <span class=\"token number\">420</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token punctuation\">{</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    // vlist父元素的高度\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AutoSizer</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      // 可根据父元素的高度动态计算出列表项的高度\n      </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> width<span class=\"token punctuation\">,</span> height <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token operator\">&lt;</span>VList\n          width<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>width<span class=\"token punctuation\">}</span> <span class=\"token comment\">// 列表的宽度</span>\n          height<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>height<span class=\"token punctuation\">}</span> <span class=\"token comment\">// 列表的高度</span>\n          rowCount<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>pocList<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">}</span> <span class=\"token comment\">// 列表项数</span>\n          overscanRowCount<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">7</span><span class=\"token punctuation\">}</span> <span class=\"token comment\">// 不在视窗范围上下现实的列表项数</span>\n          rowHeight<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">60</span><span class=\"token punctuation\">}</span> <span class=\"token comment\">// 列表项的高</span>\n          rowRenderer<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>renderItem<span class=\"token punctuation\">}</span> <span class=\"token comment\">// 列表项渲染方式</span>\n          noRowsRenderer<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n            <span class=\"token comment\">// 空数据的渲染方式</span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Empty</span></span>\n              <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n                position<span class=\"token operator\">:</span> <span class=\"token string\">\"absolute\"</span><span class=\"token punctuation\">,</span>\n                top<span class=\"token operator\">:</span> <span class=\"token string\">\"50%\"</span><span class=\"token punctuation\">,</span>\n                left<span class=\"token operator\">:</span> <span class=\"token string\">\"50%\"</span><span class=\"token punctuation\">,</span>\n                transform<span class=\"token operator\">:</span> <span class=\"token string\">\"translate(-60%,-50%)\"</span><span class=\"token punctuation\">,</span>\n              <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n            <span class=\"token punctuation\">/></span></span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">AutoSizer</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">List</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// key：数组行中的唯一值</span>\n<span class=\"token comment\">// style: vlist的列表项的定位样式和默认样式</span>\n<span class=\"token comment\">// parent: 参考父级Grid元素（使用CellMeasurer组件要注意：该组件会不断估算每个</span>\n<span class=\"token comment\">// 列表项的最佳高度，所以会带来一定的性能损耗，个人建议不要使用该组件，可以像我一样将</span>\n<span class=\"token comment\">// 列表项的高度rowHeight写死）</span>\n<span class=\"token comment\">// index: 被渲染数据的index索引</span>\n<span class=\"token function-variable function\">renderItem</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> index<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">,</span> style<span class=\"token operator\">:</span> styles <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> pocList <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state\n  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> pocList<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">||</span> <span class=\"token string\">\"\"</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">List.Item</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>key<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Tooltip</span></span> <span class=\"token attr-name\">title</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Checkbox</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>pocList<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>poc_id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token punctuation\">{</span>React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string\">\"span\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n            <span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">highLightValue</span><span class=\"token punctuation\">(</span><span class=\"token function\">ellipsis</span><span class=\"token punctuation\">(</span>pocList<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> <span class=\"token number\">46</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Checkbox</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Tooltip</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">List.Item</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><br />其他优秀的社区库：</p>\n<ol>\n<li><a href=\"https://ali-react-table.js.org/docs/\">阿里的 ant-table 的丰富 api 虚拟表格</a></li>\n<li><a href=\"https://github.com/ctq123/ant-virtual-table\">兼容性比较好的虚拟表格</a></li>\n</ol>"},{"id":"ddca1e6f-7769-5781-8a6c-ab25892acd83","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"深入浅出HTTP","path":"/http","tags":["Network"],"excerpt":"http 重要知识点.","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEEAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAACAAH/2gAMAwEAAhADEAAAAdXwaDIkFn//xAAZEAEBAQEBAQAAAAAAAAAAAAABAhIDADH/2gAIAQEAAQUC2YonHShppy9Hz9//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAgEBPwGn/8QAGxAAAgEFAAAAAAAAAAAAAAAAAAEQESExYZH/2gAIAQEABj8Cul2MFBLUf//EABkQAQADAQEAAAAAAAAAAAAAAAEAESExQf/aAAgBAQABPyGl8hsCblNIXOI4exW2XHnk2jj/2gAMAwEAAgADAAAAELTv/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEh/9oACAEDAQE/EMR//8QAFREBAQAAAAAAAAAAAAAAAAAAERD/2gAIAQIBAT8QFP/EABsQAQACAwEBAAAAAAAAAAAAAAEAESExUUGh/9oACAEBAAE/EEIgEaM6+wnGPGlFMOOkHJWNEuR7L4YlONVFUz//2Q==","aspectRatio":1.5060240963855422,"src":"/static/a101ba1b43ab0f98316295a93ab9c5fb/ba9ae/fog.jpg","srcSet":"/static/a101ba1b43ab0f98316295a93ab9c5fb/86d0f/fog.jpg 125w,\n/static/a101ba1b43ab0f98316295a93ab9c5fb/520da/fog.jpg 250w,\n/static/a101ba1b43ab0f98316295a93ab9c5fb/ba9ae/fog.jpg 500w,\n/static/a101ba1b43ab0f98316295a93ab9c5fb/72227/fog.jpg 750w,\n/static/a101ba1b43ab0f98316295a93ab9c5fb/5c39c/fog.jpg 1000w,\n/static/a101ba1b43ab0f98316295a93ab9c5fb/b1e91/fog.jpg 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"首先让我们来了解一下-http-的请求报文和响应报文\" style=\"position:relative;\"><a href=\"#%E9%A6%96%E5%85%88%E8%AE%A9%E6%88%91%E4%BB%AC%E6%9D%A5%E4%BA%86%E8%A7%A3%E4%B8%80%E4%B8%8B-http-%E7%9A%84%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87%E5%92%8C%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87\" aria-label=\"首先让我们来了解一下 http 的请求报文和响应报文 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>首先让我们来了解一下 http 的请求报文和响应报文</h2>\n<p><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/da49442a0e71569330996cf2fcde50c1/a7a19/http.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.999999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAklEQVQY001PaY+DIBD1//+41iuKaxWwtYqAeIDnJu7b7pdNJpPhzbwDzy1u3dZlXcZp1L2a7bTtG5A/EIVhtjNWUknnrPsgwM1gvOM8dK+VVo8i94M740xIgcIp5HrTq141bRPHcckoaJAexgEdfG+apzAKSUYSkuBIdKKT3bt5+77/ql/Vk9/utyRN8kcOXV4xJOUVx8F+7B4EKKN4FGUhVQer8/uEQ5oSJIQJVq1opeyGwbjVXdeFD7RC/JIRm1cV45DllLGSUvSvPKeMf5gNpGGVEgJ1rXVvTEoy4CB61lkkH6cJ/f8wWzuMpn7XQRhGcRwEQRhFCfJkGf6vlIL0D9pJSG45vahuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"http\"\n        title=\"http\"\n        src=\"/static/da49442a0e71569330996cf2fcde50c1/c1b63/http.png\"\n        srcset=\"/static/da49442a0e71569330996cf2fcde50c1/5a46d/http.png 300w,\n/static/da49442a0e71569330996cf2fcde50c1/0a47e/http.png 600w,\n/static/da49442a0e71569330996cf2fcde50c1/c1b63/http.png 1200w,\n/static/da49442a0e71569330996cf2fcde50c1/a7a19/http.png 1323w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<p><a name=\"c76a254f\"></a></p>\n<h2 id=\"再向您献上一张-http-请求的流程图\" style=\"position:relative;\"><a href=\"#%E5%86%8D%E5%90%91%E6%82%A8%E7%8C%AE%E4%B8%8A%E4%B8%80%E5%BC%A0-http-%E8%AF%B7%E6%B1%82%E7%9A%84%E6%B5%81%E7%A8%8B%E5%9B%BE\" aria-label=\"再向您献上一张 http 请求的流程图 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>再向您献上一张 http 请求的流程图</h2>\n<p><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/226664588d9551f1dce70bbfeb894e83/f8915/httpRequest.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABBElEQVQY03VR2XKDMBDj/7+xnbZJmmDwAb69virDDE8po4H1SoLVMpVagNrqWxxs/Y+dpFIhhtYbcKpba+cR9cyYVPKUnoJLOcxCCutM710bbcwofPDLuu56LzXjzoWIKaLAW3pvZ6e2MezE5QakXJQ288pDTD5ExqX1IVHetNXOg4WGrYJKVbt5zgvIYWZc/b6WSFmo/ePrpl1wIf08XkpbF9P9yZ6Mg50XcXu8IpFQ2+f3TVs/zIlo5TxR6seFvBgbg+1a42isEUfmEbXhUXKhha/oozOBgPNaOFrDLIW2BhBSApRp7PLICWUk5Mjjy9caLzOWb60NMTrvjLUA5fz2L/4BgwvPrlvqCxAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"httpRequest\"\n        title=\"httpRequest\"\n        src=\"/static/226664588d9551f1dce70bbfeb894e83/f8915/httpRequest.png\"\n        srcset=\"/static/226664588d9551f1dce70bbfeb894e83/5a46d/httpRequest.png 300w,\n/static/226664588d9551f1dce70bbfeb894e83/0a47e/httpRequest.png 600w,\n/static/226664588d9551f1dce70bbfeb894e83/f8915/httpRequest.png 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<p><a name=\"a8b0534a\"></a></p>\n<h2 id=\"redirect（资源重定向）的-http-响应头部\" style=\"position:relative;\"><a href=\"#redirect%EF%BC%88%E8%B5%84%E6%BA%90%E9%87%8D%E5%AE%9A%E5%90%91%EF%BC%89%E7%9A%84-http-%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8\" aria-label=\"redirect（资源重定向）的 http 响应头部 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Redirect（资源重定向）的 HTTP 响应头部</h2>\n<blockquote>\n<ul>\n<li>Location:''（后面接跳转的 URI 路径）</li>\n<li>通过 response.write(302,{ Location:'/new' })返回的 xhr.status>=300&#x26;&#x26;xhr.status&#x3C;400 才能进行重定向</li>\n</ul>\n</blockquote>\n<p><a name=\"94d0159f\"></a></p>\n<h2 id=\"cache-contorl-的含义和使用的-http-响应头部\" style=\"position:relative;\"><a href=\"#cache-contorl-%E7%9A%84%E5%90%AB%E4%B9%89%E5%92%8C%E4%BD%BF%E7%94%A8%E7%9A%84-http-%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8\" aria-label=\"cache contorl 的含义和使用的 http 响应头部 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cache-Contorl 的含义和使用的 HTTP 响应头部</h2>\n<blockquote>\n<ul>\n<li>可缓存性：<br />|<strong>public</strong>|http 经过的地方都能够进行缓存  |<br />|<strong>private</strong>|只有发起请求的浏览器才能够进行缓存|<br />|<strong>no-cache</strong>|本地可以缓存，但是需要在服务端验证过后才能使用|</li>\n<li>到期：<br />|<strong>max-age=<second></strong>| 浏览器缓存多长时间到期 |<br />|<strong>s-maxage=<second></strong>|代理服务器缓存的到期时间|<br />|  <strong>max-stale=<second></strong>| 在 max-age 到期之后，在 max-stale 期限之内还是可以取缓存 |</li>\n<li>重新验证：（使用较少）<br />|<strong>must-revalidate</strong>|   在 max-age 过期之后必须到原服务端发起请求来验证此缓存是否过期了，而不能直接使用本地的缓存|<br />|<strong>proxy-revalidate</strong>|使用在缓存服务器，在缓存过期之后到原服务端请求验证缓存是否过期了，而不能直接使用本地的缓存|</li>\n<li>其他：<br />|<strong>no-store</strong>|本地和代理服务器都不能缓存，永远只能到服务端拿取新的内容才能使用|<br />|<strong>no-transform</strong>|指定代理服务器不能修改服务端返回的内容|</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>服务器缓存的验证更新机制：<br />| <strong>Last-Modified</strong> （上一次修改时间）| 在服务端返回 Last-Modified，浏览器在下一次请求的时候会带上<strong>If-Modified-Since</strong> 与服务器的 Last-Modified 对比，如果相等，那么资源没有被修改过，服务器则告诉浏览器直接使用缓存|<br />|<strong>Etag</strong>（数据签名：对静态资源进行 hash 计算的到唯一值的签名）|在服务器返回 Etag，浏览器在下一次请求的时候会带上<strong>If-None-Match</strong>与服务器的 Etag 进行对比，如果相等，那么资源没有被修改过，服务器告诉浏览器直接使用缓存|</li>\n</ul>\n</blockquote>\n<p><a name=\"5c13213b\"></a></p>\n<h2 id=\"cors-跨域请求的-http-响应头部\" style=\"position:relative;\"><a href=\"#cors-%E8%B7%A8%E5%9F%9F%E8%AF%B7%E6%B1%82%E7%9A%84-http-%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8\" aria-label=\"cors 跨域请求的 http 响应头部 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CORS 跨域请求的 HTTP 响应头部</h2>\n<p><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 748px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/157a5c1636af09bd03e30e5838a11366/f8915/cors.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7ElEQVQoz5WR646EIAyFff9X1H8z3lEBQVDEmY+wO5lsZpNd0iic9rSnbXHGU69aSqm1DmeIV8QAV7OCZzvCkfEfViitRjFy5mXej/16XNnxeDsfmYlsN+u8U6ve3BZj/C3uM7kqS6lUVVbTNFEEwf8gG2v4LXL5K+27r6+eGQlkLn73rw5JysywnJ3UObvzlniaxZXIUsuu7/thABVCoB/fKIau6+q6xms2Y51lqMk3j03T3u53govzTFth1HTOSjAQ6sNPeZXkwpMtsEi+zntk5hUWKAGFnMWgvG0bijB8mDxfs4CJ8cw1QghP+LsK6h+JDWIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cors\"\n        title=\"cors\"\n        src=\"/static/157a5c1636af09bd03e30e5838a11366/f8915/cors.png\"\n        srcset=\"/static/157a5c1636af09bd03e30e5838a11366/5a46d/cors.png 300w,\n/static/157a5c1636af09bd03e30e5838a11366/0a47e/cors.png 600w,\n/static/157a5c1636af09bd03e30e5838a11366/f8915/cors.png 748w\"\n        sizes=\"(max-width: 748px) 100vw, 748px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br /></p>\n<blockquote>\n<ul>\n<li><strong>Access-Control-Allow-Origin</strong>:支持跨域的 URI</li>\n<li><strong>Access-Control-Allow-Headers</strong>:跨域请求支持的请求头（由于 cors 跨域对请求头和请求方法存在限制，所以需要服务端来进行处理才能使用相应的请求头和请求方法）</li>\n<li><strong>Access-Control-Allow-Methods</strong>:跨域请求支持的请求方法（eg:'PUT,DELETE,POST'）</li>\n<li><strong>Access-Control-Max-Age</strong>:1000   意思是在 1000s 内的以上跨域（包括跨域支持的头部和请求方法）都不用发送 cors 预请求来验证，可以直接发送正式请求</li>\n<li><strong>注意</strong>：如果在 cors 跨域时，服务端不设定允许的请求头或者请求方法返回，浏览器虽然可以接收返回的信息，但是为了安全考虑，是不会显示内容的。</li>\n<li><strong>注意</strong>：由于浏览器会为了安全着想，在发送除了 PUT,HEAD,POST 方法，和 Content-Type 为 text-plian,multipart/form-data,application/x-www-form-urlencoded 类型以外的 cors 限制发送的请求时，会先在发送正式请求之前发送一个预请求（method 方法为 OPTION）来获取服务端允许的请求域，请求方法，请求头等信息。<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 584px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eb6dc096a0510b40f77cfc659d047aeb/e05eb/res.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0ElEQVQoz12S25KiQBBE/f/v2pjnEeXaIDTNTUBFBFFQ2IO4TuxoBVHQnZVZWbXKy9z1XNMyHeF0t26apuf4JMZpJD7JEp/TJVb90F+7q3CFihThB/4+35fHMk7iU3XKi3yfZ6EKkzTh1LKtc32myuP5eIEfQ9M23+tv3dDh52mZpvJlnMYyDEzbCKS8dl17bYlzXUP2w3zv77f7TdtoVIVWOM42MP6IryiMYNvnRd+fx2c7/fuN4/ifbErqxpbOAxnYjm1LR4/MNEmLsjhWp6JI0ky9YE+Qnypv8KW5INuwDG/nbbYbTdOiUFV1dTgeZChtIeI0adsGDtxpXgkQgKthGPq+3/k77mX7DKmIxypoyZMswTOqqFiF0Wyb8ITrCWiosuKMDD+jJIriuU/EK6VmjdOEt9eurZsLCTrfbb9mhuErZgsPQwYDGH4K+9KH53g6UhQvUFRfam4TA/9XMvfMC3isZkjCdZgWsr2daznW4j+66P/D+dttRmXZJszcY7bVuQKTZimBEGZJ4FDb4VWDhGXz3sx82upbtLFbPMtDCYzm8QwjWSw+snBLOfKl4Z8lYT03+oZuaR61a20NjFpSSVQsKzl3+5i7ZTqgeP0LFD3ReIVXndUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"res\"\n        title=\"res\"\n        src=\"/static/eb6dc096a0510b40f77cfc659d047aeb/e05eb/res.png\"\n        srcset=\"/static/eb6dc096a0510b40f77cfc659d047aeb/5a46d/res.png 300w,\n/static/eb6dc096a0510b40f77cfc659d047aeb/e05eb/res.png 584w\"\n        sizes=\"(max-width: 584px) 100vw, 584px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></li>\n</ul>\n</blockquote>\n<p><a name=\"9e50c3f6\"></a></p>\n<h2 id=\"cookie-的-http-响应头部\" style=\"position:relative;\"><a href=\"#cookie-%E7%9A%84-http-%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8\" aria-label=\"cookie 的 http 响应头部 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cookie 的 HTTP 响应头部</h2>\n<blockquote>\n<ul>\n<li>服务端通过在响应头中设置<strong>set-Cookie</strong>，设置 Cookie</li>\n<li>键值对，可以通过'[]'设置多个 cookie</li>\n<li>浏览器的下一次请求的时候会带上</li>\n<li>同域才能发送 cookie</li>\n<li>cookie 的属性：<br />|<strong>max-age</strong>和<strong>expires</strong>| 设置过期时间 |<br />|<strong>Secure</strong>|只能通过 https 发送|<br />|  <strong>HttpOnly</strong>|无法通过 document.cookie 或者其他脚本程序访问，防止 xrs 攻击  |</li>\n</ul>\n</blockquote>\n<p><a name=\"2bb7644c\"></a></p>\n<h2 id=\"connection（tcp-连接）的-http-响应头部\" style=\"position:relative;\"><a href=\"#connection%EF%BC%88tcp-%E8%BF%9E%E6%8E%A5%EF%BC%89%E7%9A%84-http-%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8\" aria-label=\"connection（tcp 连接）的 http 响应头部 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Connection（TCP 连接）的 HTTP 响应头部</h2>\n<blockquote>\n<ul>\n<li><strong>HTTP1.1</strong>一般只有 6 个 TCP 的并发链接,其他的连接会阻塞</li>\n<li><strong>Connection:'close'</strong>   没有长连接，在每一次请求完毕之后关闭 TCP 连接，有新请求时创建一个新的 TCP 连接</li>\n<li><strong>Connection:'keep-alive'</strong>   有长连接，在六个 TCP 连接中如果有一个连接完成数据传输，则将那个 TCP 连接给下一个请求用</li>\n</ul>\n</blockquote>\n<p><a name=\"8c43a26b\"></a></p>\n<h2 id=\"csp（-content-security-policy）的-http-响应头部\" style=\"position:relative;\"><a href=\"#csp%EF%BC%88-content-security-policy%EF%BC%89%E7%9A%84-http-%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8\" aria-label=\"csp（ content security policy）的 http 响应头部 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSP（ Content-Security-Policy:）的 HTTP 响应头部</h2>\n<blockquote>\n<p>作用：</p>\n<ol>\n<li>限制网页资源的获取（从哪里获取，请求发到什么地方）</li>\n<li>限制报告资源获取越权（当获取到不应该获取的资源时候，给网页一些报告）</li>\n</ol>\n</blockquote>\n<blockquote>\n<p>限制方式：</p>\n<ul>\n<li>defalut-src:(限制全局)<br />| http |   只能通过 http 进行加载|<br />|http https|只能通过 http 或者 https 进行加载|<br />| 'self' | 只能通过本域名的进行加载 |<br />|http.baidu.com|可以限定制定的网站进行加载|</li>\n<li>制定资源类型:<br />1.connet-src:请求发现的目标进行限制<br />2.img-src:图片可以从哪些网址加载<br />3.font-src:字体从哪里加载<br />4.script-src:脚本资源从哪里进行加载<br />..................网页可以从外部加载的都可以进行资源的限制</li>\n<li>.form-action   '\\self':对 form 表单提交的 action 进行限制</li>\n<li>report-uri  + 服务器的路径（可以向服务区提交加载错误的信息）</li>\n<li>Content-Security-Policy-Report-Only:（虽然检测到资源不想加载，但还是可以加载）<br />................</li>\n</ul>\n</blockquote>\n<p><a name=\"5a32a534\"></a></p>\n<h2 id=\"数据协商：客户端和服务端协商声明所需要的数据类型（以下是-http-请求头部）\" style=\"position:relative;\"><a href=\"#%E6%95%B0%E6%8D%AE%E5%8D%8F%E5%95%86%EF%BC%9A%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%92%8C%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8D%8F%E5%95%86%E5%A3%B0%E6%98%8E%E6%89%80%E9%9C%80%E8%A6%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%88%E4%BB%A5%E4%B8%8B%E6%98%AF-http-%E8%AF%B7%E6%B1%82%E5%A4%B4%E9%83%A8%EF%BC%89\" aria-label=\"数据协商：客户端和服务端协商声明所需要的数据类型（以下是 http 请求头部） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>数据协商：客户端和服务端协商声明所需要的数据类型（以下是 HTTP 请求头部）</h2>\n<blockquote>\n<ul>\n<li>Accept:浏览器能够处理的 MIME 类型</li>\n<li>Accept-Charset:浏览器能够显示的字符编码</li>\n<li>Accept-Encoding:浏览器能够处理的压缩编码</li>\n<li>Accept-Language:浏览器当前设置的语言</li>\n<li>Connection:浏览器与服务器之间连接的类型</li>\n<li>Cookie:当前页面设置的任何 cookie</li>\n<li>Host:发出请求页面所在的域</li>\n<li>Referer:发出请求页面的 URI</li>\n<li>User-Agent:浏览器的用户代理字符串</li>\n</ul>\n</blockquote>\n<p><br />延伸阅读：<br />CSP 扩展：<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP\">CSP 内容安全策略</a><br />HTTPS（图解 HTTPS，写的挺好的博客）：<a href=\"https://blog.csdn.net/forezp/article/details/89666603\">HTPPS</a><br />HTTP2：<a href=\"https://juejin.im/post/5b88a4f56fb9a01a0b31a67e\">HTTP2 网络质和量的提升</a></p>"},{"id":"c13077f7-0866-5bf7-a00a-c81a7a51b224","headings":[{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"react 高亮显示关键词","path":"/gatsby-antd","tags":["React"],"excerpt":"react 高亮显示关键词，不用库，原生显示","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJElEQVQozwEZA+b8ACgTGkcuL15GQUItMjgkLUUvMjgjJ0MnKV06NXdUSJZzY6qMe6uRgpV2ZY1tXYNkWHBPRnJSSV8+Ol0/QAAxGR1DKihcQj41HyMuGyJELCxBJyhOMC5oRTyHZlmmh3ioi3i5oZGXeWaAXk5xUEdmRj9xUEdjQTtXNzYAOh8fPSIjPiEkNh4iOCImRCorOiAlVDUycEs9qYt70LmpqIt5ood3im1ce1pPakhBXj45Xz86YT86Ti8wADUZHkUkI0YlJTQbIT8lKE0vLzsgJlc2MoVeTMOol8arnKOEdpByZoFgU39cUGRCPFc3NFQ1NFM0Mlk3NAA8Gh9AHiJFIiU5HSJDJilPLy5CJShZNzKHY1bPtafMsaShhHmMal15U0d4UkdhPjdXNzNVNTNRLy9TMTIAPxofOxsfQSAjOB0iSSkqTSwsSSkrZUE7hmRZtJmRrpWPlXZqdlJIcExCdlFGWzg1SSstRyktRSYpVC0tAFIqKkAgIkEiIzogI08uLUQmKz4gJVw3L41qW7WbhLGYgo5rXWJAOWNAPGZAO1AtLzsfJjwhKD0gJ04mKAB6TDN9Tz52Sz5WMi1aOCdpRCpzUDuefW7Kp4a2m1m7oWWujXZ6WE1ZOTJIKyhKLCxQLzBIKi5KKi1RLy8AaEIuek8zfk8vek00fVpMsZJ55cOr17OTo4ZOn4ZFmIA+gmk5tZN5yKeTlnZiclI9SSwmSSspUTAvRCYoAFg1JG9HM6B1XdawmPneyP/m0uC8l8ymW9e0ZeLBceG/btO0Z7eWXtOvkvHKr9OrjqJ6ZYJYS1QwLysWHwCjd2LSpovsxqnyz7Hwx6jGnHqbdz20kknDn1POqljbtmDKpFSbfD1vUDCFYU+cc2GLZFhqSUdDKC8kER4AvI1zypx+v5FzsIJoh19LXD8nZkoqb1AxdlgxeFkwknE5nns8fV4wZEcrSi8lUjU1NiArLxsoXEBBhGNaAHlOQ5ZpVZFjUFs4MTUfGkYwIVQ6I0kxI0oyJEIqIz8pIE0zJFQ3JzIfICUXHhwQGi8bI4FeVaiAbp54Z2aDFUbWy7m4AAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/133cf3c23846178c742207aa20a64dab/0853f/tree.png","srcSet":"/static/133cf3c23846178c742207aa20a64dab/14156/tree.png 125w,\n/static/133cf3c23846178c742207aa20a64dab/d6e47/tree.png 250w,\n/static/133cf3c23846178c742207aa20a64dab/0853f/tree.png 500w,\n/static/133cf3c23846178c742207aa20a64dab/ce627/tree.png 750w,\n/static/133cf3c23846178c742207aa20a64dab/9dbcf/tree.png 1000w,\n/static/133cf3c23846178c742207aa20a64dab/87046/tree.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"正则表达式转义，你会用到的\" style=\"position:relative;\"><a href=\"#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BD%AC%E4%B9%89%EF%BC%8C%E4%BD%A0%E4%BC%9A%E7%94%A8%E5%88%B0%E7%9A%84\" aria-label=\"正则表达式转义，你会用到的 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>正则表达式转义，你会用到的</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// 正则特殊字符转义</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> escapeRegexp <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>string <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">[\\\\^$*+?.()|[\\]{}]</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\\\$&amp;\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"针对关键词进行高亮\" style=\"position:relative;\"><a href=\"#%E9%92%88%E5%AF%B9%E5%85%B3%E9%94%AE%E8%AF%8D%E8%BF%9B%E8%A1%8C%E9%AB%98%E4%BA%AE\" aria-label=\"针对关键词进行高亮 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>针对关键词进行高亮</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> escapeRegexp <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"Utils/string\"</span>\n\n<span class=\"token comment\">// 针对关键词进行高亮</span>\n<span class=\"token comment\">// 正则匹配有可能会涉及到特定字符</span>\n<span class=\"token comment\">// targetVal 要高亮的目标字符串</span>\n<span class=\"token comment\">// 高亮关键词</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">hightLight</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">targetVal<span class=\"token punctuation\">,</span> highLightValue</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> res <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n  <span class=\"token keyword\">let</span> hasHighLight <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n  hasHighLight <span class=\"token operator\">=</span> highLightValue<span class=\"token punctuation\">.</span><span class=\"token function\">some</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> reg <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RegExp</span><span class=\"token punctuation\">(</span><span class=\"token function\">escapeRegexp</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"i\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 不区分大小写</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>reg<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>targetVal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hasHighLight<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    res <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;span style=\"color:black;background:#f6e58d\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>targetVal<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/span></span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    res <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>targetVal<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/span></span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> res\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"针对字符串进行高亮\" style=\"position:relative;\"><a href=\"#%E9%92%88%E5%AF%B9%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%9B%E8%A1%8C%E9%AB%98%E4%BA%AE\" aria-label=\"针对字符串进行高亮 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>针对字符串进行高亮</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// 根据搜索条件替换字符串关键词高亮标签</span>\n<span class=\"token comment\">// 针对长字符串的高亮显示</span>\n<span class=\"token comment\">// 返回的数组可以用React.createElement('pre',null,stringReplaceMark(targetVal,highLighValue))</span>\n<span class=\"token function-variable function\">stringReplaceMark</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">targetVal<span class=\"token punctuation\">,</span> highLightValue</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> replaceVal <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>highLightValue<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> highLightValue<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    highLightValue<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> reg <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RegExp</span><span class=\"token punctuation\">(</span><span class=\"token function\">escapeRegexp</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"i\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 高亮替换的字符</span>\n      <span class=\"token keyword\">const</span> isReplaced <span class=\"token operator\">=</span> targetVal<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span>reg<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> targetVal<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span>reg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span>\n      <span class=\"token comment\">// 将字符串从高亮的位置切割成数组，好用上面的isReplaced插入到数组的分割空位中</span>\n      <span class=\"token keyword\">const</span> replaceArr <span class=\"token operator\">=</span> targetVal<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span>reg<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">const</span> length <span class=\"token operator\">=</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>replaceArr<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> replaceArr<span class=\"token punctuation\">.</span>length\n      replaceArr<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        replaceVal<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// 在空位插入高亮标签，不在最后插入</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">!==</span> length <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> isReplaced<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          replaceVal<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>span style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> color<span class=\"token operator\">:</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">,</span> background<span class=\"token operator\">:</span> <span class=\"token string\">\"#f6e58d\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n              <span class=\"token punctuation\">{</span>isReplaced<span class=\"token punctuation\">}</span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n          <span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    replaceVal<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>targetVal<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> replaceVal\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><br />推荐：<br /></p>\n<ul>\n<li><a href=\"https://github.com/benjamingr/RegExp.escape\">正则转义相关地址</a></li>\n</ul>"},{"id":"29df326e-ad2f-54c6-a9bc-46b28ac4db68","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"Gatsby配置antd","path":"/gatsby-antd","tags":["Gatsby"],"excerpt":"想试试Gatsby配置antd吗？.","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADDklEQVQozyWS62/TZhSH/W9Amzixnfhuv3Ziv3ZSx04cN6FNaEsaVDEUiYIoUztpQ+rQAK2MbdyvgYAIEKCIcmnSbKTtUlqpodAVWjah0glpH4aQ+ALij5infTk60tHzO0dHD+LB0Xxv7sfRw/dL155O/fJ7o9Gq1Rcnq0+rk8v12uKjR6vTjddP5tZmp188/nXfrt3eAEZxAYL0ezAP4g9iI4O76zdvrcw0XjZn1540X80311vzK43HU+Xrrxdm7xTP//TdgbFv9w/v2SXKAKdwhgtiAV+b34MwLHn06/0PiqXntdqr2ZmNxYW/l1sf/lz954/62sLJd6ut8pljo1996diGFVMJGhfFoCpTfgLdhHoQWWJvHjlSPXe2euHc3I3y4vit1dq9jd/q7188/Lxx903zwVBhoCeT6rSNZBySDL7FBF3xkNts8rUjmsKN7By4c2xspnR6qVJcGS8tVS6uTZTWq9ffTFXeNipDX/QJIqVBXpZZIwIGt1m9jkrS2GYXjmmCj8QEwHU75nAhP37iwPrkpZd3T/1VPf926uy76WKz/EM+68gSk07AfLcxMuDk0zr9P2zrAs2SrMDQPAkkzojIM1cPfn5e/rh05dPy5Y/PipXjw3FDEQE9uL27Mw739tuFbASGSCKAIgbkePcqDaRsPZuKOpY6uqe3NfH93O1Dy7Wx989+PvpNvyiwLBfcmetKJyKDvbFCBnYolMDjiBpiXNi2lK6kFtHFWIdUyKXCiuTYZtzUcz1WX8ZSFMAJVCKmRnXZMUBPQqYY3Ed4ETeSE0io8kYUqCqXMMPZVAcPWC0SVjVZlLikFe1OW4JIh0O8DgFU2M4Y8Ad9ba4kKOEL0Lgc4t1UCIWIBhxT7cukdvRvSztGNm3mtjqddocImFBYVFUgySxUGH/At9nnQdoxbzvmISjMHUsyoyp8V1JPxqOWqSsQuNWORzNp04opiiLSHBmgCYLEvDj637ddy9r8XpRAXekoLggkxrFg3NQglEFIBDIfVsVU0kiYihzmXTfb/R4vgbqIu/lfBW8J6zAaKoIAAAAASUVORK5CYII=","aspectRatio":1.5060240963855422,"src":"/static/30f8dd521a640f8b2bb6aabf077ebb50/0853f/sweet.png","srcSet":"/static/30f8dd521a640f8b2bb6aabf077ebb50/14156/sweet.png 125w,\n/static/30f8dd521a640f8b2bb6aabf077ebb50/d6e47/sweet.png 250w,\n/static/30f8dd521a640f8b2bb6aabf077ebb50/0853f/sweet.png 500w,\n/static/30f8dd521a640f8b2bb6aabf077ebb50/ce627/sweet.png 750w,\n/static/30f8dd521a640f8b2bb6aabf077ebb50/9dbcf/sweet.png 1000w,\n/static/30f8dd521a640f8b2bb6aabf077ebb50/87046/sweet.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"前言\" style=\"position:relative;\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>前言</h2>\n<blockquote>\n<p>相信国内的 react 用户都是 antd 的忠实爱好者，此教程实践可行</p>\n</blockquote>\n<h2 id=\"首先安装必须的-npm-包\" style=\"position:relative;\"><a href=\"#%E9%A6%96%E5%85%88%E5%AE%89%E8%A3%85%E5%BF%85%E9%A1%BB%E7%9A%84-npm-%E5%8C%85\" aria-label=\"首先安装必须的 npm 包 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>首先安装必须的 npm 包</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install --save gatsby-plugin-antd less less-loader babel-plugin-import gatsby-plugin-less</code></pre></div>\n<h2 id=\"将以下代码添加到-gatsby-nodejs-中\" style=\"position:relative;\"><a href=\"#%E5%B0%86%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%E6%B7%BB%E5%8A%A0%E5%88%B0-gatsby-nodejs-%E4%B8%AD\" aria-label=\"将以下代码添加到 gatsby nodejs 中 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>将以下代码添加到 gatsby-node.js 中</h2>\n<ul>\n<li>babel-plugin-import 配置 antd 按需加载组件</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onCreateBabelConfig</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> actions <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  actions<span class=\"token punctuation\">.</span><span class=\"token function\">setBabelPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"babel-plugin-import\"</span><span class=\"token punctuation\">,</span>\n    options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      libraryName<span class=\"token operator\">:</span> <span class=\"token string\">\"antd\"</span><span class=\"token punctuation\">,</span>\n      style<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"将以下代码添加到-gatsby-configjs-的插件组中\" style=\"position:relative;\"><a href=\"#%E5%B0%86%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%E6%B7%BB%E5%8A%A0%E5%88%B0-gatsby-configjs-%E7%9A%84%E6%8F%92%E4%BB%B6%E7%BB%84%E4%B8%AD\" aria-label=\"将以下代码添加到 gatsby configjs 的插件组中 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>将以下代码添加到 gatsby-config.js 的插件组中</h2>\n<ul>\n<li>modifyVars 可自行修改 antd 的样式</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{\n    resolve: &quot;gatsby-plugin-antd&quot;,\n    options: {\n      style: true,\n    },\n},\n{\n    resolve: `gatsby-plugin-less`,\n    options: {\n      modifyVars: {\n          &quot;primary-color&quot;: &quot;#da3043&quot;,\n          &quot;font-family&quot;: &quot;Arial&quot;,\n          &quot;layout-body-background&quot;: &quot;#66ff79&quot;,\n      },\n      lessOptions: {\n          javascriptEnabled: true,\n      },\n    },\n}</code></pre></div>\n<h2 id=\"-最后一起康康我的-packagejson-吧\" style=\"position:relative;\"><a href=\"#-%E6%9C%80%E5%90%8E%E4%B8%80%E8%B5%B7%E5%BA%B7%E5%BA%B7%E6%88%91%E7%9A%84-packagejson-%E5%90%A7\" aria-label=\" 最后一起康康我的 packagejson 吧 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤔 最后一起康康我的 package.json 吧</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  &quot;dependencies&quot;: {\n    &quot;antd&quot;: &quot;^4.12.3&quot;,\n    &quot;babel-plugin-import&quot;: &quot;^1.13.3&quot;,\n    &quot;gatsby&quot;: &quot;^2.32.3&quot;,\n    &quot;gatsby-image&quot;: &quot;^2.11.0&quot;,\n    &quot;gatsby-plugin-antd&quot;: &quot;^2.2.0&quot;,\n    &quot;gatsby-plugin-feed&quot;: &quot;^2.13.0&quot;,\n    &quot;gatsby-plugin-google-analytics&quot;: &quot;^2.11.0&quot;,\n    &quot;gatsby-plugin-less&quot;: &quot;^4.7.0&quot;,\n    &quot;gatsby-plugin-manifest&quot;: &quot;^2.12.0&quot;,\n    &quot;gatsby-plugin-offline&quot;: &quot;^3.10.0&quot;,\n    &quot;gatsby-plugin-react-helmet&quot;: &quot;^3.10.0&quot;,\n    &quot;gatsby-plugin-sharp&quot;: &quot;^2.14.1&quot;,\n    &quot;gatsby-remark-copy-linked-files&quot;: &quot;^2.10.0&quot;,\n    &quot;gatsby-remark-images&quot;: &quot;^3.11.0&quot;,\n    &quot;gatsby-remark-prismjs&quot;: &quot;^3.13.0&quot;,\n    &quot;gatsby-remark-responsive-iframe&quot;: &quot;^2.11.0&quot;,\n    &quot;gatsby-remark-smartypants&quot;: &quot;^2.10.0&quot;,\n    &quot;gatsby-source-filesystem&quot;: &quot;^2.11.0&quot;,\n    &quot;gatsby-transformer-remark&quot;: &quot;^2.16.0&quot;,\n    &quot;gatsby-transformer-sharp&quot;: &quot;^2.12.0&quot;,\n    &quot;less&quot;: &quot;^4.1.1&quot;,\n    &quot;less-loader&quot;: &quot;^8.0.0&quot;,\n    &quot;prismjs&quot;: &quot;^1.22.0&quot;,\n    &quot;react&quot;: &quot;^16.12.0&quot;,\n    &quot;react-dom&quot;: &quot;^16.12.0&quot;,\n    &quot;react-helmet&quot;: &quot;^5.2.1&quot;,\n    &quot;typeface-merriweather&quot;: &quot;0.0.72&quot;,\n    &quot;typeface-montserrat&quot;: &quot;0.0.75&quot;\n  },\n  &quot;devDependencies&quot;: {\n    &quot;gh-pages&quot;: &quot;^3.1.0&quot;,\n    &quot;prettier&quot;: &quot;2.2.1&quot;\n  },</code></pre></div>"},{"id":"0193c843-dacc-59c6-aace-6171f9b6f549","headings":[{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"通过a标签同源和跨域下载服务器文件","path":"/download","tags":["Download"],"excerpt":"通过a标签同源和跨域下载服务器文件.","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAADmklEQVQozw3N2VMadwDA8d/CIoiCyqGJUdQk6lBtm2Smk2nsGKNJvAJRUaygMYJFQAW5bzYCsosgqJwSWREFNFbJ2VGZTNpJm+ShM+lD+//Ut+/T5wuSSGPGXbuPteeCd7fdzSnPtby/7VWw6X2UcbZZ8quPlkLYQUPtppmZc5aeotQvG1V/R5pO0bZztA24lq571JxsRP7144fDyFjY2VA8DhciXVmMtYexMr6rKXd71N6acNSc+0s/r1P/SdR8jTWco83v0BZgVlQbZ9nH+LMvxXfFoxBm4Lx9kX6Dy/ZDnUns2+deLu65ueX8JmFl/obBfwXB72s1xVXuWw/3bLURGFUtiGUo4hW/L2T/PC1kYsaDvXR+L5PP4NntcG6tA3dfizkbAhoybiacLINdCzVnaz5xcl+v1IO5aYbTzMsmPa9zyY9v8me4/Y/oyMmmMhxNZbawE/+VI5S942ZGjXDGQswipIvY1rF3DY3bpjowOUYd5QOHnnt+jAfMw+ticCiB/rWCT6Gu9MrNIzd45aflvJW4g5oyV+w46XEbJa5nhBZY/gU6EPLLBPxSiYiy4XlkXRgYuw3U96n56ZL/EFAI3DmMaXMJJBvTx+2MqPly0lEdtVJCWuaynGaXwQBTfWdT3tAruAszbP+zJ4I+bm87MPbCRTWhsCkPBhPoim89sPbc9xDVMzBTlXORYldUmOaYS0/J4KVvcN/Tv2K4Y1C0nh6lXuxsScd+lHbT4rPlqaA+Ho2v+VD/sjaAdOvmYYuaqp2jG2Rso6xONc0GBaz3YHUgifboFU1Dg5fSYenLzLrXykuHtHjItBsL5LfjeNiDGG8syYFDRzKpyrUKtkrCkAhZwDbb5FC1uqzXh3llo4/L5ZILnuXWlfgdHfiGPoQIN1xjWwG5U9tsWqRgDorLSrdpOepfasf5FUA0ShULaQIBsauTrJTUz4jLHfOkHQfRNANU0mpkqcWuarQuVNlUdS4DO+SmYQgd0V/SSDniISYYH4EG+uD7PdS+HopIUNl9FxL0A83PxCkepJikhqycLFZ+gBK8Ojqiq3RbYYsONskZmsnLU48vzvyye53EH24ReL0E4RD0qBe+10HquA3d+h7wHpAjFtZnHP6UAH4tUSMnLiogmRRSTVNko7ThhyQg6KNMjJC7foIFfEijJC3r6ufFVyZ4ZNFQyeADWDkO8nYoZyGoRQT5FDQ/R1DIoaciaGKYMNhP+B/mm1rnL6s4ygAAAABJRU5ErkJggg==","aspectRatio":1.3297872340425532,"src":"/static/24ad03741385d8cca4ad09d32942ecd9/0853f/download.png","srcSet":"/static/24ad03741385d8cca4ad09d32942ecd9/14156/download.png 125w,\n/static/24ad03741385d8cca4ad09d32942ecd9/d6e47/download.png 250w,\n/static/24ad03741385d8cca4ad09d32942ecd9/0853f/download.png 500w,\n/static/24ad03741385d8cca4ad09d32942ecd9/ce627/download.png 750w,\n/static/24ad03741385d8cca4ad09d32942ecd9/9dbcf/download.png 1000w,\n/static/24ad03741385d8cca4ad09d32942ecd9/87046/download.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"同源下载推荐\" style=\"position:relative;\"><a href=\"#%E5%90%8C%E6%BA%90%E4%B8%8B%E8%BD%BD%E6%8E%A8%E8%8D%90\" aria-label=\"同源下载推荐 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>同源下载(推荐)</h2>\n<ul>\n<li>优点是：通过浏览器的默认行为下载，不会阻塞</li>\n<li>缺点是：必须是同源下载，不过现在都是 webpack 和 nignx 代理，所以推荐这种下载方式</li>\n<li>简单说说：如果响应头添加 <code class=\"language-text\">Content-Disposition</code>，可不使用 <code class=\"language-text\">download</code>，两者都可以阻止浏览器默认打开文件，而不是下载文件的行为，但是前者优先级比后者高</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * @description: 从远程url下载文件(同源)\n * @param {string} url -远程的url和参数\n * @param {string} filename -下载到本地的文件名\n */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">downLoadFile</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">url<span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> filename<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> origin <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/api/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token keyword\">const</span> aLink <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span>\n  aLink<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">\"none\"</span>\n  aLink<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> origin\n  aLink<span class=\"token punctuation\">.</span>download <span class=\"token operator\">=</span> filename\n  aLink<span class=\"token punctuation\">.</span>target <span class=\"token operator\">=</span> <span class=\"token string\">\"_black\"</span>\n  aLink<span class=\"token punctuation\">.</span>type <span class=\"token operator\">=</span> <span class=\"token string\">\"application/octet-stream\"</span> <span class=\"token comment\">// 让浏览器知道是二进制</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>aLink<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 如果不挂载到body上，火狐浏览器会失效</span>\n  aLink<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>aLink<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"跨域下载\" style=\"position:relative;\"><a href=\"#%E8%B7%A8%E5%9F%9F%E4%B8%8B%E8%BD%BD\" aria-label=\"跨域下载 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>跨域下载</h2>\n<ul>\n<li>缺点是：要等 blob 封装完成才能下载，如果想实现前端流式下载，可参考<a href=\"https://segmentfault.com/a/1190000021367378\">fetch 方法</a></li>\n<li>优点是：可以携带 Cookie 和请求体 实现动态下载</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * @description: 获取 blob\n * @param {string} url -目标文件地址\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getBlob</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">url<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> xhr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XMLHttpRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    xhr<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n    xhr<span class=\"token punctuation\">.</span>responseType <span class=\"token operator\">=</span> <span class=\"token string\">\"blob\"</span>\n    xhr<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">.</span>status <span class=\"token operator\">===</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>xhr<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    xhr<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * @description: 下载blob工具函数\n * @param {string} blob -文件流\n * @param {string} filename -下载的文件名\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">saveAs</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">blob<span class=\"token operator\">:</span> Blob<span class=\"token punctuation\">,</span> filename<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>navigator<span class=\"token punctuation\">.</span>msSaveOrOpenBlob<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    navigator<span class=\"token punctuation\">.</span><span class=\"token function\">msSaveBlob</span><span class=\"token punctuation\">(</span>blob<span class=\"token punctuation\">,</span> filename<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> anchor <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> body <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"body\"</span><span class=\"token punctuation\">)</span>\n    anchor<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">createObjectURL</span><span class=\"token punctuation\">(</span>blob<span class=\"token punctuation\">)</span>\n    anchor<span class=\"token punctuation\">.</span>download <span class=\"token operator\">=</span> filename\n\n    anchor<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">\"none\"</span>\n    body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>anchor<span class=\"token punctuation\">)</span>\n\n    anchor<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    body<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>anchor<span class=\"token punctuation\">)</span>\n\n    window<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">revokeObjectURL</span><span class=\"token punctuation\">(</span>anchor<span class=\"token punctuation\">.</span>href<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * @description: 用户调用的下载函数\n * @param {string} url -目标文件地址（跨域）\n * @param {string} newFilename -想要保存的文件名称\n */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">download</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">url<span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> newFilename<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> blob<span class=\"token operator\">:</span> Blob <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getBlob</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\n  <span class=\"token function\">saveAs</span><span class=\"token punctuation\">(</span>blob<span class=\"token punctuation\">,</span> newFilename<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://juejin.im/post/6844903763359039501\">一个很全面的实现前端文件下载的博客</a></li>\n<li><a href=\"https://juejin.im/post/6844904069958467592\">前端下载文件的 5 中方法对比</a></li>\n<li><a href=\"https://www.npmjs.com/package/jszip\">前端 zip 压缩文件/文件夹并下载到本地</a></li>\n</ul>"},{"id":"9e74ffca-a8b2-5837-8093-b51412513be6","headings":[{"depth":2},{"depth":2}],"frontmatter":{"title":"sass常用指令和常用函数","path":"/sass","tags":["CSS"],"excerpt":"sass常用指令和常用函数,方便快速查找","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAC4jAAAuIwF4pT92AAADGElEQVQozxWQeVMSARyG93M01WRTdgAqkBzLsofAEraKCMjCLiAscuqQRpwCiqJoBYZXpFlJljqVdozllJWpXc5kkzVh9WHaZp4/3n+ed97fD3gyaNwsUnv3/b9eZH6/m/y7fefvZqmynv22GNyetq+PkI9S+nJEO3ORGO/UXPOpc258gFGlHIq4FQPWhgyfSrbvjy5VXl39vT3/58Pyn52Fyuv8/sPwl1uujWvkalp/L9w8E7xQ9KuveFTDLmXGqUjaG2I0AjzNtG5NWPYWu36u5w62Fg62lg62Fytvp3+sxjbG6Zc540pKNx8iSl2aMR8+6lZmGUVfe0OCRqMWGHic0r4ptO2WPZ+Woz83pn5tliubt/ZfDO2W/c9HDKv9uqVY8+2exumAuuBR5lwNgw4sbUMTNBwxy4HF6IW1bOvb6+SrKfu3lcj3tczX1d4vC50fStaVjI6tfhAmZoPqyQDOyiMubKAd/S9TcJiEgLs955cixMNk07Mh3c4N6+c55uNM+84U9T7ftpwglqJE+ZKm1IUXvcpRF5p1IP02JEkjMTN02SQDbgfVcVJigDk9elGSBgMtQk+TcCKgvNGpGnUi035Fya+Y9CoLbsWVDnTQgaStcMIiD5tkISMI5F1Ik+TU6WOH+NVHZLwq0ZljdScOO/CaRnE1t+pQzCS+2a2O6OuLPizHwCxZO9xHy5NmKNwGAlm7LGESJUnxgEVacMrHO+AxRl5goJsBtOSH14e1D9LN3S38gg+jMM6YCxmgwbSFRRZj5bRZMmQD8wzEOsUOmA0TbnjcDeds4KBVMsJA3Vq+F+d5NLWC6qO9JBgzSUMGiZeot+F8QMytktUcR/knMMHJ/whPnhedMsg5OtlprbQ6apL0WsCgVpg0S9tVNSkK7GwSehsFdlWdDuIABoRDK3hOFc+rqb3YLAi1COL6c/2kaJiW5p1QziGPm8RdWkGMlMRJcY++3onXUCiXwrgWjAe0QmeM8FkLyqFQjkPJ9WlqO3Aeg/PYtew5OfYLAcVchJi9TMz36uZCjRPehqtOpI+SRYySf6GtRT927de7AAAAAElFTkSuQmCC","aspectRatio":1.5060240963855422,"src":"/static/76b9aa0a66019806b9383b473f9fd1d5/0853f/ocean.png","srcSet":"/static/76b9aa0a66019806b9383b473f9fd1d5/14156/ocean.png 125w,\n/static/76b9aa0a66019806b9383b473f9fd1d5/d6e47/ocean.png 250w,\n/static/76b9aa0a66019806b9383b473f9fd1d5/0853f/ocean.png 500w,\n/static/76b9aa0a66019806b9383b473f9fd1d5/ce627/ocean.png 750w,\n/static/76b9aa0a66019806b9383b473f9fd1d5/9dbcf/ocean.png 1000w,\n/static/76b9aa0a66019806b9383b473f9fd1d5/87046/ocean.png 1920w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<p><a name=\"3e525057\"></a></p>\n<h2 id=\"scss-常用指令\" style=\"position:relative;\"><a href=\"#scss-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4\" aria-label=\"scss 常用指令 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>scss 常用指令</h2>\n<blockquote>\n<p>注意：scss 与 sass 的区别</p>\n</blockquote>\n<ul>\n<li>混合样式：<code class=\"language-text\">@mixin 名字(参数1，参数2...){...}</code></li>\n<li>取用混合样式：<code class=\"language-text\">@include 名字（@mixin的名字）</code></li>\n<li>继承样式：<code class=\"language-text\">@extend 需要继承的类、ID名、自定义的混合样式等的名字</code></li>\n<li>导入 scss 样式：<code class=\"language-text\">@import &quot;scss文件名&quot;</code></li>\n<li>条件控制指令：<code class=\"language-text\">@if 条件{...}</code></li>\n<li>循环控制指令：<br /><code class=\"language-text\">@for $var from &lt;开始值&gt; through &lt;结束值&gt; -----------包括结束值</code><br /><code class=\"language-text\">@for $var from &lt;开始值&gt; to &lt;结束值&gt; ------------不包括结束值</code></li>\n<li>循环 List 项目的控制指令：<code class=\"language-text\">@each $var in $List{}</code></li>\n<li>条件判断循环：<code class=\"language-text\">@while 条件{...}</code></li>\n<li>用户自定义的函数：<code class=\"language-text\">@function 名称(参数1，参数2...){...}</code></li>\n<li>警告和错误的提示：<br /><code class=\"language-text\">@warn &quot;...&quot;------------------------在终端输出警告</code><br /><code class=\"language-text\">@error &quot;...&quot;----------------在.css文件和终端输出错误</code></li>\n</ul>\n<p><a name=\"b468e5e2\"></a></p>\n<h2 id=\"scss-常用函数\" style=\"position:relative;\"><a href=\"#scss-%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0\" aria-label=\"scss 常用函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>scss 常用函数</h2>\n<ul>\n<li>数字函数 ：</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$theNumber:4.5;</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  percentage($theNumber)：将一个不带单位的数转换成百分比值；  //450%\n\n  round($theNumber)：将数值四舍五入，转换成一个最接近的整数；  //5\n\n  ceil($theNumber)：将大于自己的小数转换成下一位整数；   //5\n\n  floor($theNumber)：将一个数去除他的小数部分；  //4\n\n  abs($theNumber)：返回一个数的绝对值；//4.5\n\n  min($numbers…)：找出几个数值之间的最小值； //min(1,2,3) =1\n\n  max($numbers…)：找出几个数值之间的最大值； //max(1,2,3)=3\n\n  random(): 获取随机数   //随机数</code></pre></div>\n<ul>\n<li>字符串函数：</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$theString:&quot;Hello World&quot;;</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">to-upper-case($theString)：输出$theString的大写                 //HELLO WORLD\n\nto-lower-case($theString)：输出$theString的小写                 //hello world\n\nstr-length($theString):输出$theString的长度                     //11\n\nstr-index($theString,&quot;Hello&quot;):输出$theString第二个参数的开始索引          //1\n\nstr-insert($theString,&quot;.com&quot;,12):在索引为12的地方为$theString插入&quot;.com&quot; //&quot;Hello World.com&quot;</code></pre></div>\n<ul>\n<li>颜色函数</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&gt; 调整色相h的值\n\n$base-color-hsl:hsl(0,100,50%);  //\tred\n$base-color:#ff0000;  //red\n\nadjust-hue($base-color-hsl,137deg);        //#00ff48\nadjust-hue($base-color,137deg);          //#00ff48</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&gt; 调整亮度l的值\n\n$base-color:hsl(222,100%,50%);             //#004cff\n\n$light-color:lighten($base-color,30%);        //#99b8ff（变亮）\n$dark-color:darken($base-color,20%);         //#002e99（变暗）</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&gt; 调整饱和度s的值\n\n$base-color:hsl(221,50%,50%);            //#4068bf\n\n$saturate-color:saturate($color:$base-color,$amount:50%);          //#0051ff  (更饱和)\n$desaturate-color:desatudate($color:$base-color,$amount:30%);        //667699 (更不饱和)</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&gt; 调整透明度a的值\n\n$base-color:hsla(222,100%,50%,0.5);  //rgba(0, 77, 255, 0.5)\n\n$fade-in-color:opacify($color: $primary-color, $amount: 0.3);  //rgba(0, 77, 255, 0.8)\n$fase-out-color:transparentize($color: $primary-color, $amount: 0.2);  //rgba(0, 77, 255, 0.3)</code></pre></div>\n<ul>\n<li>列表函数（1px solid black：这样称为一个列表有三个项）</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">length(5px 10px)：列表长度     //2\nlength(5px 10px 0px 2px)  列表长度      //4\n\nnth(5px 10px,1)：列表第一项   //5px\nnth(5px 10px,2)：列表第二项   //10px\n\nindex(1px solid red,solid)：列表solid的项目索引  //2\n\nappend(5px 10px,5px)：列表中插入项目  //5px 10px 5px\n\njoin(5px 10px,5px 10px):列表之间连接   //5px 10px 5px 10px\njoin(5px 10px,5px 10px,参数)：列表之间条件连接  //参数为comma=5px,10px,5px,10px ---------参数为space=5px 10px 5px 10px</code></pre></div>\n<ul>\n<li>Map 函数(Map 为带有键值对的列表)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$colors:(light:#ffffff,dark:#000000);   //定义map</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">length($colors)：map的长度  //2\n\nmap-get($colors,dark):取得键值为dark的值     //#000000\n\nmap-keys($colors)：取得所有键      //(&quot;light&quot;,&quot;dark&quot;)\n\nmap-values($colors) ：取得所有值      //(#ffffff,#000000)\n\nmap-has-key($colors,light)：map是否有light键       //true\n\nmap-merge($colors,(color-red:#ff0000)) ：插入键值对到map   //(light:#ffffff,dark:#000000,color-red:#ff0000)\n\nmap-remove($colors,light,dark) :从map删除键值对      //(color-red:#ff0000)</code></pre></div>"},{"id":"1ea7be44-68c2-5520-a0ed-6170049d84e7","headings":[{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":3},{"depth":3},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2},{"depth":2}],"frontmatter":{"title":"前端大屏可视化","path":"/visualization","tags":["Echarts"],"excerpt":"从零开始的基于echarts的可视化大屏开发.","created":"2021-02-20 21:45","createdPretty":"20 February, 2021","updated":"2021-04-11T00:00:00.000Z","updatedPretty":"20 February, 2021","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwT/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAciUTlDCi//EABkQAAEFAAAAAAAAAAAAAAAAAAEAAhARMf/aAAgBAQABBQINFI7P/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAQUBAAAAAAAAAAAAAAAAAQARICIxMv/aAAgBAQAGPwIXGOuo/wD/xAAbEAACAgMBAAAAAAAAAAAAAAAAAREhEDFRYf/aAAgBAQABPyF5ltng0uCsJnL2f//aAAwDAQACAAMAAAAQ3w//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QTZv/xAAXEQADAQAAAAAAAAAAAAAAAAABEBEh/9oACAECAQE/EJpX/8QAGxABAAMAAwEAAAAAAAAAAAAAAQARQSExcdH/2gAIAQEAAT8QABcI6M9+QI09AlGxXDg0h1MnZP/Z","aspectRatio":2.232142857142857,"src":"/static/b57b22b6622b0c15a7547a6516702a5b/ba9ae/echarts.jpg","srcSet":"/static/b57b22b6622b0c15a7547a6516702a5b/86d0f/echarts.jpg 125w,\n/static/b57b22b6622b0c15a7547a6516702a5b/520da/echarts.jpg 250w,\n/static/b57b22b6622b0c15a7547a6516702a5b/ba9ae/echarts.jpg 500w,\n/static/b57b22b6622b0c15a7547a6516702a5b/72227/echarts.jpg 750w,\n/static/b57b22b6622b0c15a7547a6516702a5b/5c39c/echarts.jpg 1000w,\n/static/b57b22b6622b0c15a7547a6516702a5b/e2de3/echarts.jpg 1280w","sizes":"(max-width: 500px) 100vw, 500px"}}}},"html":"<h2 id=\"技术栈\" style=\"position:relative;\"><a href=\"#%E6%8A%80%E6%9C%AF%E6%A0%88\" aria-label=\"技术栈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>技术栈</h2>\n<blockquote>\n<p>可视化技术栈：react，echarts，react-for-echarts，sass</p>\n</blockquote>\n<p><a name=\"3gFyR\"></a></p>\n<h2 id=\"开始布局啦！\" style=\"position:relative;\"><a href=\"#%E5%BC%80%E5%A7%8B%E5%B8%83%E5%B1%80%E5%95%A6%EF%BC%81\" aria-label=\"开始布局啦！ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>开始布局啦！</h2>\n<hr>\n<ol>\n<li>设置项目的最小宽度 min-width,确保项目不会过于小导致布局混乱</li>\n<li>横向自适应宽度：采用 ant-design 的栅栏布局</li>\n<li>\n<p>纵向自适应高度，我一开始采用的是 rem 的适应方案，可是发现有如下问题</p>\n<ul>\n<li>会修改根元素的 font-size，容易导致项目的其他页面字体大小有问题（可通过修改 document.body.fontSize 来解决）</li>\n<li>如果放在大屏上，比如分辨率为 1920*1080 以上，屏幕下方会留白，这是由于 rem 是按照屏幕的比例来进行展示的</li>\n</ul>\n</li>\n<li>于是，我采用的是 vh 的方案，查看<a href=\"https://caniuse.com/?search=vh\">caniuse</a>，发现兼容性还不错，而且适合在各种比例的屏幕上进行显示</li>\n</ol>\n<p><a name=\"IF4ph\"></a></p>\n<h2 id=\"rem-布局方案\" style=\"position:relative;\"><a href=\"#rem-%E5%B8%83%E5%B1%80%E6%96%B9%E6%A1%88\" aria-label=\"rem 布局方案 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>rem 布局方案</h2>\n<blockquote>\n<p>rem 可以简单的理解为屏幕宽度的百分比</p>\n</blockquote>\n<ol>\n<li>引入<a href=\"https://github.com/amfe/lib-flexible/blob/2.0/index.js\">阿里的 flexible</a>来进行屏幕划分，这里默认是将屏幕宽度划分成十等分，如果设计稿为 1920*1080，则 html 根元素的 font-size 为 1920/10 = 192 px</li>\n<li>配置 vscode 的 cssrem 插件的 Root Font Size = 192(如果想直接写 px，可采用<a href=\"https://github.com/songsiqi/px2rem-postcss\">postcss-px2rem</a>)</li>\n</ol>\n<p>举个例子：设计稿为 1920*1080，实际投屏尺寸为 5760 * 3240</p>\n<p>设计稿:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.dom</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 200px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>代码:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.dom</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 1.0416666667rem<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>实际：</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">// 根html的font-size: 576\n.dom</span> <span class=\"token punctuation\">{</span>\n  // 1.0416666667 * 576\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"3\">\n<li>让 Echarts 图表根据屏幕宽度的大小变化而自适应，如果使用的是 react-for-echarts 就不用再添加了</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"resize\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  echartsInstance<span class=\"token punctuation\">.</span><span class=\"token function\">resize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"可视化组件的背景图片\" style=\"position:relative;\"><a href=\"#%E5%8F%AF%E8%A7%86%E5%8C%96%E7%BB%84%E4%BB%B6%E7%9A%84%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87\" aria-label=\"可视化组件的背景图片 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>可视化组件的背景图片</h2>\n<hr>\n<h3 id=\"svg-作为背景图片带来的坑\" style=\"position:relative;\"><a href=\"#svg-%E4%BD%9C%E4%B8%BA%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87%E5%B8%A6%E6%9D%A5%E7%9A%84%E5%9D%91\" aria-label=\"svg 作为背景图片带来的坑 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>svg 作为背景图片带来的坑</h3>\n<p>一开始 ued 给我的切的 svg，也没做过可视化，不太懂，也是欣然接受并使用的 svg 作为背景图片，可是发现调整屏幕的分辨率，组件自适应了，但是背景图却有问题，<b>高度和宽度一致是按照一定比例来缩放的。后来发现原来这是 svg 的特性，怪不得很适合用来做 icon。</p>\n<h3 id=\"于是改变背景图方案\" style=\"position:relative;\"><a href=\"#%E4%BA%8E%E6%98%AF%E6%94%B9%E5%8F%98%E8%83%8C%E6%99%AF%E5%9B%BE%E6%96%B9%E6%A1%88\" aria-label=\"于是改变背景图方案 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>于是改变背景图方案</h3>\n<p>使用了<a href=\"https://cloudconvert.com/svg-to-png\">svg-to-png</a>，采用 png 来设置背景图片，并通过调整 css 来实现背景图片覆盖整个组件,完美的实现了背景图跟随组件自适应。</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@mixin</span> <span class=\"token function\">background</span><span class=\"token punctuation\">(</span>$urlImg<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">background-image</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>$urlImg<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background-size</span><span class=\"token punctuation\">:</span> 100% 100%<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background-repeat</span><span class=\"token punctuation\">:</span> no-repeat<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a name=\"z2ibq\"></a></p>\n<h2 id=\"世界地图并实现地图下钻\" style=\"position:relative;\"><a href=\"#%E4%B8%96%E7%95%8C%E5%9C%B0%E5%9B%BE%E5%B9%B6%E5%AE%9E%E7%8E%B0%E5%9C%B0%E5%9B%BE%E4%B8%8B%E9%92%BB\" aria-label=\"世界地图并实现地图下钻 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>世界地图并实现地图下钻</h2>\n<hr>\n<ol>\n<li>\n<p>首先得把世界地图和各个国家的地图找到，这是一个很庞大的工作。而且以前的地图和现在的地图并非一致，请合理使用（毕竟地球的板块是在不断的运动中的）。</p>\n<ul>\n<li><a href=\"http://datav.aliyun.com/tools/atlas/#&#x26;lat=30.332329214580188&#x26;lng=106.72278672066881&#x26;zoom=3.5\">中国->国、省、市地图 Json</a>（由于有 datav 官方维护，地图数据新）</li>\n<li><a href=\"https://hxkj.vip/demo/echartsMap/\">中国->省、市、区/县地图 Json</a>（地图数据新）</li>\n<li><a href=\"https://github.com/pissang/starbucks/tree/gh-pages/json\">世界->各个国家的地图 Json（包括世界地图）</a>(地图数据旧)</li>\n<li><a href=\"https://geojson-maps.ash.ms/\">世界->各个国家的地图 Json（不包括世界地图）</a>（地图数据较新）</li>\n<li><a href=\"https://img.hcharts.cn/mapdata/\">全世界地图数据集</a>（只更新到了 2015 年的数据）</li>\n<li><a href=\"http://geojson.io/#map=2/20.0/0.0\">当你找到 json 的地图，放上来看看是否一致</a>（权威地图，地图数据新）</li>\n<li>如果不懂 geoJson 规范，可看<a href=\"https://www.oschina.net/translate/geojson-spec\">GeoJSON 格式规范说明</a></li>\n</ul>\n</li>\n<li>找到了地图 json，下钻实现</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 获取地图json注册地图</span>\n<span class=\"token comment\">// map为json所对应的名称（比如：世界地图为world,中国地图为China）</span>\n<span class=\"token function-variable function\">registerMap</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token parameter\">map</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 由于json是存在静态资源中的</span>\n  <span class=\"token keyword\">const</span> path_env <span class=\"token operator\">=</span>\n    process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"development\"</span>\n      <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/public/json/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>map<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.json</span><span class=\"token template-punctuation string\">`</span></span>\n      <span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/assets/public/json/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>map<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.json</span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">axios</span><span class=\"token punctuation\">(</span>path_env<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      echarts<span class=\"token punctuation\">.</span><span class=\"token function\">registerMap</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"world\"</span><span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">finally</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 使用的是echarts-for-react，this.echartsReact获取到的是该图表实例</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>echartsReact<span class=\"token punctuation\">.</span><span class=\"token function\">dispatchAction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        type<span class=\"token operator\">:</span> <span class=\"token string\">\"restore\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a name=\"OmSJq\"></a></p>\n<h2 id=\"词云\" style=\"position:relative;\"><a href=\"#%E8%AF%8D%E4%BA%91\" aria-label=\"词云 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>词云</h2>\n<blockquote>\n<p>我采用的库是<a href=\"https://github.com/mcc108/TagCloud#readme\">TagCloud</a>,同事推荐的一个小巧，可定制的库，挺好用的。</p>\n</blockquote>\n<p><a name=\"vtI9Q\"></a></p>\n<h2 id=\"自定义一个时钟\" style=\"position:relative;\"><a href=\"#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E6%97%B6%E9%92%9F\" aria-label=\"自定义一个时钟 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>自定义一个时钟</h2>\n<blockquote>\n<ol>\n<li>使用一个组件来显示时钟，保证时钟的渲染在该组件内进行，不影响其他组件</li>\n<li>字体样式采用免费可商用的<a href=\"https://www.uisdc.com/uisdc-first-free-font\">「优设标题黑」</a></li>\n</ol>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> PureComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> dayjs <span class=\"token keyword\">from</span> <span class=\"token string\">\"dayjs\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DataVisual</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">PureComponent</span> <span class=\"token punctuation\">{</span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    time<span class=\"token operator\">:</span> <span class=\"token function\">dayjs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"YYYY.MM.DD HH:mm:ss\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n\n  timer <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        time<span class=\"token operator\">:</span> <span class=\"token function\">dayjs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"YYYY.MM.DD HH:mm:ss\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timer<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> display<span class=\"token operator\">:</span> <span class=\"token string\">\"inline-block\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a name=\"2QaXU\"></a></p>\n<h2 id=\"使用font-face\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8font-face\" aria-label=\"使用font face permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用@font-face</h2>\n<blockquote>\n<p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/@font-face\">MDN</a></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@font-face</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-family</span><span class=\"token punctuation\">:</span> electronicNumber<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">src</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token string url\">\"./font/DS-DIGI-1.ttf\"</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">,</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token string url\">\"./font//DS-DIGIB-2.ttf\"</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token string url\">\"./font//DS-DIGII-3.ttf\"</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">,</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token string url\">\"./font/DS-DIGIT-4.ttf\"</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.myFontFace</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-family</span><span class=\"token punctuation\">:</span> electronicNumber<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a name=\"suEmG\"></a></p>\n<h2 id=\"使用media（设置响应式）\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8media%EF%BC%88%E8%AE%BE%E7%BD%AE%E5%93%8D%E5%BA%94%E5%BC%8F%EF%BC%89\" aria-label=\"使用media（设置响应式） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用@media（设置响应式）</h2>\n<blockquote>\n<p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/@media\">MDN</a></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@mixin</span> <span class=\"token function\">screenMedia</span><span class=\"token punctuation\">(</span>$fontSize<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span>\n  // 如果小于1440px，则font-size生效\n  // <span class=\"token property\">同理min-width</span><span class=\"token punctuation\">:</span>1440px，如果大于1440px，则font-size生效\n  <span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token keyword\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span> 1440px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> $fontSize<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.mymMedia</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token atrule\"><span class=\"token rule\">@include</span> <span class=\"token function\">screenMedia</span><span class=\"token punctuation\">(</span>20px<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"最后\" style=\"position:relative;\"><a href=\"#%E6%9C%80%E5%90%8E\" aria-label=\"最后 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>最后</h2>\n<p>参考：<a href=\"https://www.njleonzhang.com/2018/08/15/flexible-pc-full-screen.html\">大屏上的全屏页面的自适应适配方案</a></p>\n<blockquote>\n<p>文章针对前端可视化的大屏展示，根据需求来完善文章，欢迎各位大佬评论哦。<br/>\n如果有需要修改文章的内容，我会改进。<br/>\n附上一张性能图片，没做这方面的优化。<br/> > <a href=\"https://juejin.im/post/6844903552070975495\">使用 chrome performance 查看页面性能</a> <br> > <a href=\"https://web.dev/rail/#goals-and-guidelines\">著名的 RAIL model</a></p>\n</blockquote>"}],"postsPerPage":5}},"staticQueryHashes":["1116962356","2275848304","3097946992","3138592700","3462520645","444477021"]}